================================================================================
批量模型评估结果
================================================================================
评估开始时间: 2025年 07月 28日 星期一 12:58:06 CST
模型目录: /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model
模型数量: 9
================================================================================

模型: 2_h_006179_iters
评估时间: 2025年 07月 28日 星期一 12:58:06 CST
----------------------------------------
评估成功，用时: 173 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 293/4384 [00:00<00:01, 2923.99it/s] 13%|█▎        | 586/4384 [00:00<00:01, 2475.41it/s] 19%|█▉        | 838/4384 [00:00<00:03, 1084.62it/s] 24%|██▍       | 1064/4384 [00:00<00:02, 1325.38it/s] 29%|██▉       | 1282/4384 [00:00<00:02, 1518.97it/s] 34%|███▍      | 1511/4384 [00:00<00:01, 1707.06it/s] 40%|███▉      | 1740/4384 [00:01<00:01, 1856.56it/s] 45%|████▍     | 1966/4384 [00:01<00:01, 1965.20it/s] 50%|████▉     | 2185/4384 [00:01<00:01, 2020.52it/s] 55%|█████▍    | 2408/4384 [00:01<00:00, 2077.71it/s] 60%|██████    | 2640/4384 [00:01<00:00, 2145.49it/s] 65%|██████▌   | 2869/4384 [00:01<00:00, 2187.33it/s] 71%|███████   | 3105/4384 [00:01<00:00, 2234.62it/s] 76%|███████▌  | 3333/4384 [00:01<00:00, 2233.15it/s] 81%|████████  | 3560/4384 [00:01<00:00, 2240.10it/s] 86%|████████▋ | 3788/4384 [00:01<00:00, 2249.40it/s] 92%|█████████▏| 4018/4384 [00:02<00:00, 2263.19it/s] 97%|█████████▋| 4246/4384 [00:02<00:00, 2266.62it/s]100%|██████████| 4384/4384 [00:02<00:00, 1981.30it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▌         | 228/4384 [00:00<00:01, 2278.13it/s] 10%|█         | 459/4384 [00:00<00:01, 2292.22it/s] 16%|█▌        | 689/4384 [00:00<00:01, 2289.02it/s] 21%|██        | 918/4384 [00:00<00:01, 2260.77it/s] 26%|██▋       | 1151/4384 [00:00<00:01, 2282.56it/s] 31%|███▏      | 1380/4384 [00:00<00:01, 2278.37it/s] 37%|███▋      | 1611/4384 [00:00<00:01, 2286.18it/s] 42%|████▏     | 1841/4384 [00:00<00:01, 2289.16it/s] 47%|████▋     | 2074/4384 [00:00<00:01, 2300.64it/s] 53%|█████▎    | 2305/4384 [00:01<00:00, 2291.82it/s] 58%|█████▊    | 2540/4384 [00:01<00:00, 2309.06it/s] 63%|██████▎   | 2771/4384 [00:01<00:00, 2305.51it/s] 69%|██████▊   | 3007/4384 [00:01<00:00, 2321.51it/s] 74%|███████▍  | 3244/4384 [00:01<00:00, 2334.99it/s] 79%|███████▉  | 3478/4384 [00:01<00:00, 2331.73it/s] 85%|████████▍ | 3712/4384 [00:01<00:00, 2244.31it/s] 90%|████████▉ | 3941/4384 [00:01<00:00, 2257.10it/s] 95%|█████████▌| 4172/4384 [00:01<00:00, 2271.72it/s]100%|██████████| 4384/4384 [00:01<00:00, 2287.26it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/2_h_006179_iters.tar with 6179 iterations
Time: 2025-07-28 12:58:29.655792

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]31it [00:00, 304.25it/s]76it [00:00, 384.99it/s]117it [00:00, 394.33it/s]168it [00:00, 437.47it/s]213it [00:00, 439.38it/s]265it [00:00, 464.17it/s]317it [00:00, 480.48it/s]369it [00:00, 490.82it/s]419it [00:00, 439.39it/s]464it [00:01, 391.67it/s]508it [00:01, 403.60it/s]556it [00:01, 423.67it/s]607it [00:01, 445.52it/s]653it [00:01, 448.31it/s]700it [00:01, 451.61it/s]746it [00:01, 453.67it/s]792it [00:01, 454.66it/s]838it [00:02, 346.78it/s]877it [00:02, 303.38it/s]911it [00:02, 279.31it/s]942it [00:02, 262.19it/s]970it [00:02, 251.11it/s]997it [00:02, 239.60it/s]1022it [00:02, 234.74it/s]1046it [00:02, 231.18it/s]1070it [00:03, 230.19it/s]1097it [00:03, 238.65it/s]1122it [00:03, 231.70it/s]1146it [00:03, 221.60it/s]1169it [00:03, 218.23it/s]1191it [00:03, 216.70it/s]1213it [00:03, 216.22it/s]1236it [00:03, 217.48it/s]1259it [00:03, 219.85it/s]1282it [00:04, 221.30it/s]1305it [00:04, 217.88it/s]1327it [00:04, 215.41it/s]1349it [00:04, 211.05it/s]1371it [00:04, 205.36it/s]1392it [00:04, 203.26it/s]1414it [00:04, 206.21it/s]1437it [00:04, 210.69it/s]1466it [00:04, 231.58it/s]1492it [00:04, 239.77it/s]1519it [00:05, 247.09it/s]1546it [00:05, 251.14it/s]1573it [00:05, 254.38it/s]1599it [00:05, 255.74it/s]1625it [00:05, 242.36it/s]1650it [00:05, 236.44it/s]1674it [00:05, 226.18it/s]1697it [00:05, 225.85it/s]1720it [00:05, 224.80it/s]1747it [00:06, 236.15it/s]1771it [00:06, 232.58it/s]1795it [00:06, 229.48it/s]1818it [00:06, 227.94it/s]1841it [00:06, 226.17it/s]1864it [00:06, 224.87it/s]1887it [00:06, 223.42it/s]1910it [00:06, 223.56it/s]1933it [00:06, 223.94it/s]1956it [00:06, 224.30it/s]1979it [00:07, 218.87it/s]2006it [00:07, 230.99it/s]2030it [00:07, 229.83it/s]2054it [00:07, 228.99it/s]2077it [00:07, 228.17it/s]2100it [00:07, 227.30it/s]2123it [00:07, 226.91it/s]2146it [00:07, 224.16it/s]2169it [00:07, 221.12it/s]2192it [00:08, 219.91it/s]2215it [00:08, 222.20it/s]2238it [00:08, 223.86it/s]2261it [00:08, 225.06it/s]2284it [00:08, 223.52it/s]2307it [00:08, 223.51it/s]2331it [00:08, 225.75it/s]2354it [00:08, 226.62it/s]2377it [00:08, 227.17it/s]2400it [00:08, 226.15it/s]2423it [00:09, 222.23it/s]2446it [00:09, 219.21it/s]2468it [00:09, 217.56it/s]2490it [00:09, 216.36it/s]2513it [00:09, 219.40it/s]2535it [00:09, 218.10it/s]2558it [00:09, 220.24it/s]2583it [00:09, 228.01it/s]2615it [00:09, 255.15it/s]2649it [00:09, 278.77it/s]2677it [00:10, 275.62it/s]2705it [00:10, 273.02it/s]2733it [00:10, 272.44it/s]2761it [00:10, 273.62it/s]2789it [00:10, 261.80it/s]2816it [00:10, 242.05it/s]2841it [00:10, 231.14it/s]2865it [00:10, 223.51it/s]2888it [00:10, 216.18it/s]2910it [00:11, 211.49it/s]2932it [00:11, 208.63it/s]2953it [00:11, 208.77it/s]2976it [00:11, 214.11it/s]2999it [00:11, 217.97it/s]3022it [00:11, 218.87it/s]3049it [00:11, 232.46it/s]3078it [00:11, 247.62it/s]3109it [00:11, 265.16it/s]3144it [00:12, 288.51it/s]3173it [00:12, 287.06it/s]3202it [00:12, 270.20it/s]3230it [00:12, 255.33it/s]3256it [00:12, 235.72it/s]3286it [00:12, 251.37it/s]3313it [00:12, 254.62it/s]3339it [00:12, 247.39it/s]3364it [00:13, 164.95it/s]3410it [00:13, 226.14it/s]3458it [00:13, 283.94it/s]3506it [00:13, 331.52it/s]3553it [00:13, 366.65it/s]3599it [00:13, 390.90it/s]3645it [00:13, 409.25it/s]3692it [00:13, 424.51it/s]3740it [00:13, 439.90it/s]3789it [00:14, 452.48it/s]3837it [00:14, 459.44it/s]3884it [00:14, 460.03it/s]3931it [00:14, 456.65it/s]3979it [00:14, 460.68it/s]4027it [00:14, 465.92it/s]4076it [00:14, 471.38it/s]4125it [00:14, 475.31it/s]4174it [00:14, 479.01it/s]4223it [00:14, 479.84it/s]4272it [00:15, 473.84it/s]4320it [00:15, 470.29it/s]4368it [00:15, 466.71it/s]4415it [00:15, 462.76it/s]4462it [00:15, 458.67it/s]4508it [00:15, 458.59it/s]4554it [00:15, 458.40it/s]4600it [00:15, 457.44it/s]4646it [00:15, 457.90it/s]4648it [00:15, 290.66it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:04,  1.27it/s]  1%|          | 2/236 [00:01<02:17,  1.70it/s]  1%|▏         | 3/236 [00:01<02:02,  1.91it/s]  2%|▏         | 4/236 [00:02<01:54,  2.02it/s]  2%|▏         | 5/236 [00:02<01:50,  2.09it/s]  3%|▎         | 6/236 [00:03<01:47,  2.14it/s]  3%|▎         | 7/236 [00:03<01:45,  2.17it/s]  3%|▎         | 8/236 [00:03<01:44,  2.19it/s]  4%|▍         | 9/236 [00:04<01:43,  2.20it/s]  4%|▍         | 10/236 [00:04<01:42,  2.21it/s]  5%|▍         | 11/236 [00:05<01:41,  2.22it/s]  5%|▌         | 12/236 [00:05<01:40,  2.23it/s]  6%|▌         | 13/236 [00:06<01:40,  2.23it/s]  6%|▌         | 14/236 [00:06<01:37,  2.27it/s]  6%|▋         | 15/236 [00:07<01:37,  2.26it/s]  7%|▋         | 16/236 [00:07<01:38,  2.24it/s]  7%|▋         | 17/236 [00:07<01:38,  2.22it/s]  8%|▊         | 18/236 [00:08<01:38,  2.21it/s]  8%|▊         | 19/236 [00:08<01:38,  2.20it/s]  8%|▊         | 20/236 [00:09<01:38,  2.20it/s]  9%|▉         | 21/236 [00:09<01:38,  2.18it/s]  9%|▉         | 22/236 [00:10<01:38,  2.17it/s] 10%|▉         | 23/236 [00:10<01:38,  2.16it/s] 10%|█         | 24/236 [00:11<01:38,  2.16it/s] 11%|█         | 25/236 [00:11<01:37,  2.17it/s] 11%|█         | 26/236 [00:12<01:36,  2.18it/s] 11%|█▏        | 27/236 [00:12<01:35,  2.19it/s] 12%|█▏        | 28/236 [00:12<01:34,  2.20it/s] 12%|█▏        | 29/236 [00:13<01:33,  2.20it/s] 13%|█▎        | 30/236 [00:13<01:33,  2.21it/s] 13%|█▎        | 31/236 [00:14<01:32,  2.21it/s] 14%|█▎        | 32/236 [00:14<01:31,  2.22it/s] 14%|█▍        | 33/236 [00:15<01:31,  2.22it/s] 14%|█▍        | 34/236 [00:15<01:30,  2.22it/s] 15%|█▍        | 35/236 [00:16<01:30,  2.23it/s] 15%|█▌        | 36/236 [00:16<01:29,  2.23it/s] 16%|█▌        | 37/236 [00:17<01:29,  2.23it/s] 16%|█▌        | 38/236 [00:17<01:28,  2.23it/s] 17%|█▋        | 39/236 [00:17<01:28,  2.23it/s] 17%|█▋        | 40/236 [00:18<01:27,  2.23it/s] 17%|█▋        | 41/236 [00:18<01:27,  2.23it/s] 18%|█▊        | 42/236 [00:19<01:26,  2.23it/s] 18%|█▊        | 43/236 [00:19<01:26,  2.24it/s] 19%|█▊        | 44/236 [00:20<01:25,  2.23it/s] 19%|█▉        | 45/236 [00:20<01:25,  2.22it/s] 19%|█▉        | 46/236 [00:21<01:25,  2.22it/s] 20%|█▉        | 47/236 [00:21<01:25,  2.22it/s] 20%|██        | 48/236 [00:21<01:24,  2.22it/s] 21%|██        | 49/236 [00:22<01:24,  2.21it/s] 21%|██        | 50/236 [00:22<01:23,  2.21it/s] 22%|██▏       | 51/236 [00:23<01:23,  2.22it/s] 22%|██▏       | 52/236 [00:23<01:22,  2.23it/s] 22%|██▏       | 53/236 [00:24<01:22,  2.23it/s] 23%|██▎       | 54/236 [00:24<01:21,  2.23it/s] 23%|██▎       | 55/236 [00:25<01:21,  2.23it/s] 24%|██▎       | 56/236 [00:25<01:21,  2.22it/s] 24%|██▍       | 57/236 [00:26<01:21,  2.20it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.20it/s] 25%|██▌       | 59/236 [00:26<01:20,  2.20it/s] 25%|██▌       | 60/236 [00:27<01:19,  2.21it/s] 26%|██▌       | 61/236 [00:27<01:19,  2.21it/s] 26%|██▋       | 62/236 [00:28<01:18,  2.21it/s] 27%|██▋       | 63/236 [00:28<01:18,  2.21it/s] 27%|██▋       | 64/236 [00:29<01:18,  2.20it/s] 28%|██▊       | 65/236 [00:29<01:17,  2.21it/s] 28%|██▊       | 66/236 [00:30<01:16,  2.22it/s] 28%|██▊       | 67/236 [00:30<01:15,  2.22it/s] 29%|██▉       | 68/236 [00:30<01:15,  2.23it/s] 29%|██▉       | 69/236 [00:31<01:13,  2.29it/s] 30%|██▉       | 70/236 [00:31<01:13,  2.27it/s] 30%|███       | 71/236 [00:32<01:13,  2.26it/s] 31%|███       | 72/236 [00:32<01:12,  2.25it/s] 31%|███       | 73/236 [00:33<01:12,  2.25it/s] 31%|███▏      | 74/236 [00:33<01:12,  2.25it/s] 32%|███▏      | 75/236 [00:34<01:11,  2.24it/s] 32%|███▏      | 76/236 [00:34<01:11,  2.23it/s] 33%|███▎      | 77/236 [00:34<01:11,  2.23it/s] 33%|███▎      | 78/236 [00:35<01:10,  2.23it/s] 33%|███▎      | 79/236 [00:35<01:10,  2.23it/s] 34%|███▍      | 80/236 [00:36<01:09,  2.24it/s] 34%|███▍      | 81/236 [00:36<01:09,  2.24it/s] 35%|███▍      | 82/236 [00:37<01:08,  2.24it/s] 35%|███▌      | 83/236 [00:37<01:08,  2.24it/s] 36%|███▌      | 84/236 [00:38<01:07,  2.24it/s] 36%|███▌      | 85/236 [00:38<01:07,  2.24it/s] 36%|███▋      | 86/236 [00:39<01:06,  2.24it/s] 37%|███▋      | 87/236 [00:39<01:04,  2.29it/s] 37%|███▋      | 88/236 [00:39<01:04,  2.28it/s] 38%|███▊      | 89/236 [00:40<01:04,  2.27it/s] 38%|███▊      | 90/236 [00:40<01:04,  2.26it/s] 39%|███▊      | 91/236 [00:41<01:04,  2.26it/s] 39%|███▉      | 92/236 [00:41<01:03,  2.25it/s] 39%|███▉      | 93/236 [00:42<01:03,  2.25it/s] 40%|███▉      | 94/236 [00:42<01:03,  2.25it/s] 40%|████      | 95/236 [00:42<01:02,  2.25it/s] 41%|████      | 96/236 [00:43<01:02,  2.24it/s] 41%|████      | 97/236 [00:43<01:02,  2.23it/s] 42%|████▏     | 98/236 [00:44<01:02,  2.21it/s] 42%|████▏     | 99/236 [00:44<01:02,  2.20it/s] 42%|████▏     | 100/236 [00:45<01:01,  2.21it/s] 43%|████▎     | 101/236 [00:45<01:00,  2.22it/s] 43%|████▎     | 102/236 [00:46<01:00,  2.22it/s] 44%|████▎     | 103/236 [00:46<00:59,  2.23it/s] 44%|████▍     | 104/236 [00:47<00:59,  2.23it/s] 44%|████▍     | 105/236 [00:47<00:57,  2.28it/s] 45%|████▍     | 106/236 [00:47<00:56,  2.30it/s] 45%|████▌     | 107/236 [00:48<00:56,  2.28it/s] 46%|████▌     | 108/236 [00:48<00:56,  2.27it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.25it/s] 47%|████▋     | 110/236 [00:49<00:56,  2.25it/s] 47%|████▋     | 111/236 [00:50<00:55,  2.24it/s] 47%|████▋     | 112/236 [00:50<00:55,  2.24it/s] 48%|████▊     | 113/236 [00:51<00:54,  2.24it/s] 48%|████▊     | 114/236 [00:51<00:54,  2.24it/s] 49%|████▊     | 115/236 [00:51<00:54,  2.23it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.29it/s] 50%|████▉     | 117/236 [00:52<00:52,  2.27it/s] 50%|█████     | 118/236 [00:53<00:52,  2.26it/s] 50%|█████     | 119/236 [00:53<00:52,  2.24it/s] 51%|█████     | 120/236 [00:54<00:52,  2.23it/s] 51%|█████▏    | 121/236 [00:54<00:51,  2.23it/s] 52%|█████▏    | 122/236 [00:55<00:51,  2.23it/s] 52%|█████▏    | 123/236 [00:55<00:50,  2.24it/s] 53%|█████▎    | 124/236 [00:55<00:50,  2.24it/s] 53%|█████▎    | 125/236 [00:56<00:49,  2.24it/s] 53%|█████▎    | 126/236 [00:56<00:49,  2.24it/s] 54%|█████▍    | 127/236 [00:57<00:48,  2.23it/s] 54%|█████▍    | 128/236 [00:57<00:48,  2.23it/s] 55%|█████▍    | 129/236 [00:58<00:47,  2.23it/s] 55%|█████▌    | 130/236 [00:58<00:47,  2.23it/s] 56%|█████▌    | 131/236 [00:59<00:47,  2.23it/s] 56%|█████▌    | 132/236 [00:59<00:46,  2.24it/s] 56%|█████▋    | 133/236 [00:59<00:43,  2.38it/s] 57%|█████▋    | 134/236 [01:00<00:43,  2.33it/s] 57%|█████▋    | 135/236 [01:00<00:43,  2.30it/s] 58%|█████▊    | 136/236 [01:01<00:43,  2.28it/s] 58%|█████▊    | 137/236 [01:01<00:43,  2.27it/s] 58%|█████▊    | 138/236 [01:02<00:43,  2.26it/s] 59%|█████▉    | 139/236 [01:02<00:43,  2.25it/s] 59%|█████▉    | 140/236 [01:02<00:42,  2.25it/s] 60%|█████▉    | 141/236 [01:03<00:42,  2.25it/s] 60%|██████    | 142/236 [01:03<00:41,  2.25it/s] 61%|██████    | 143/236 [01:04<00:41,  2.24it/s] 61%|██████    | 144/236 [01:04<00:41,  2.23it/s] 61%|██████▏   | 145/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 146/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 147/236 [01:06<00:39,  2.24it/s] 63%|██████▎   | 148/236 [01:06<00:39,  2.24it/s] 63%|██████▎   | 149/236 [01:07<00:38,  2.24it/s] 64%|██████▎   | 150/236 [01:07<00:38,  2.25it/s] 64%|██████▍   | 151/236 [01:07<00:37,  2.25it/s] 64%|██████▍   | 152/236 [01:08<00:34,  2.40it/s] 65%|██████▍   | 153/236 [01:08<00:35,  2.35it/s] 65%|██████▌   | 154/236 [01:09<00:35,  2.32it/s] 66%|██████▌   | 155/236 [01:09<00:35,  2.29it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.28it/s] 67%|██████▋   | 157/236 [01:10<00:34,  2.27it/s] 67%|██████▋   | 158/236 [01:10<00:34,  2.26it/s] 67%|██████▋   | 159/236 [01:11<00:34,  2.25it/s] 68%|██████▊   | 160/236 [01:11<00:33,  2.25it/s] 68%|██████▊   | 161/236 [01:12<00:33,  2.25it/s] 69%|██████▊   | 162/236 [01:12<00:32,  2.24it/s] 69%|██████▉   | 163/236 [01:13<00:32,  2.24it/s] 69%|██████▉   | 164/236 [01:13<00:32,  2.24it/s] 70%|██████▉   | 165/236 [01:14<00:31,  2.24it/s] 70%|███████   | 166/236 [01:14<00:31,  2.24it/s] 71%|███████   | 167/236 [01:14<00:30,  2.24it/s] 71%|███████   | 168/236 [01:15<00:30,  2.24it/s] 72%|███████▏  | 169/236 [01:15<00:29,  2.24it/s] 72%|███████▏  | 170/236 [01:16<00:29,  2.23it/s] 72%|███████▏  | 171/236 [01:16<00:28,  2.24it/s] 73%|███████▎  | 172/236 [01:17<00:28,  2.25it/s] 73%|███████▎  | 173/236 [01:17<00:27,  2.25it/s] 74%|███████▎  | 174/236 [01:18<00:27,  2.25it/s] 74%|███████▍  | 175/236 [01:18<00:27,  2.25it/s] 75%|███████▍  | 176/236 [01:18<00:26,  2.25it/s] 75%|███████▌  | 177/236 [01:19<00:26,  2.25it/s] 75%|███████▌  | 178/236 [01:19<00:25,  2.25it/s] 76%|███████▌  | 179/236 [01:20<00:25,  2.25it/s] 76%|███████▋  | 180/236 [01:20<00:24,  2.24it/s] 77%|███████▋  | 181/236 [01:21<00:24,  2.24it/s] 77%|███████▋  | 182/236 [01:21<00:24,  2.24it/s] 78%|███████▊  | 183/236 [01:22<00:23,  2.24it/s] 78%|███████▊  | 184/236 [01:22<00:23,  2.24it/s] 78%|███████▊  | 185/236 [01:22<00:22,  2.24it/s] 79%|███████▉  | 186/236 [01:23<00:22,  2.25it/s] 79%|███████▉  | 187/236 [01:23<00:21,  2.25it/s] 80%|███████▉  | 188/236 [01:24<00:21,  2.25it/s] 80%|████████  | 189/236 [01:24<00:20,  2.25it/s] 81%|████████  | 190/236 [01:25<00:20,  2.25it/s] 81%|████████  | 191/236 [01:25<00:20,  2.24it/s] 81%|████████▏ | 192/236 [01:26<00:19,  2.24it/s] 82%|████████▏ | 193/236 [01:26<00:19,  2.23it/s] 82%|████████▏ | 194/236 [01:26<00:18,  2.24it/s] 83%|████████▎ | 195/236 [01:27<00:18,  2.24it/s] 83%|████████▎ | 196/236 [01:27<00:17,  2.24it/s] 83%|████████▎ | 197/236 [01:28<00:17,  2.24it/s] 84%|████████▍ | 198/236 [01:28<00:16,  2.24it/s] 84%|████████▍ | 199/236 [01:29<00:16,  2.24it/s] 85%|████████▍ | 200/236 [01:29<00:16,  2.23it/s] 85%|████████▌ | 201/236 [01:30<00:15,  2.29it/s] 86%|████████▌ | 202/236 [01:30<00:14,  2.28it/s] 86%|████████▌ | 203/236 [01:30<00:14,  2.26it/s] 86%|████████▋ | 204/236 [01:31<00:14,  2.25it/s] 87%|████████▋ | 205/236 [01:31<00:13,  2.25it/s] 87%|████████▋ | 206/236 [01:32<00:13,  2.24it/s] 88%|████████▊ | 207/236 [01:32<00:12,  2.24it/s] 88%|████████▊ | 208/236 [01:33<00:12,  2.24it/s] 89%|████████▊ | 209/236 [01:33<00:12,  2.23it/s] 89%|████████▉ | 210/236 [01:33<00:10,  2.41it/s] 89%|████████▉ | 211/236 [01:34<00:10,  2.35it/s] 90%|████████▉ | 212/236 [01:34<00:09,  2.51it/s] 90%|█████████ | 213/236 [01:35<00:09,  2.42it/s] 91%|█████████ | 214/236 [01:35<00:09,  2.36it/s] 91%|█████████ | 215/236 [01:36<00:09,  2.32it/s] 92%|█████████▏| 216/236 [01:36<00:08,  2.29it/s] 92%|█████████▏| 217/236 [01:37<00:08,  2.27it/s] 92%|█████████▏| 218/236 [01:37<00:07,  2.26it/s] 93%|█████████▎| 219/236 [01:37<00:07,  2.25it/s] 93%|█████████▎| 220/236 [01:38<00:07,  2.24it/s] 94%|█████████▎| 221/236 [01:38<00:06,  2.23it/s] 94%|█████████▍| 222/236 [01:39<00:06,  2.23it/s] 94%|█████████▍| 223/236 [01:39<00:05,  2.23it/s] 95%|█████████▍| 224/236 [01:40<00:05,  2.23it/s] 95%|█████████▌| 225/236 [01:40<00:04,  2.23it/s] 96%|█████████▌| 226/236 [01:41<00:04,  2.23it/s] 96%|█████████▌| 227/236 [01:41<00:04,  2.22it/s] 97%|█████████▋| 228/236 [01:41<00:03,  2.21it/s] 97%|█████████▋| 229/236 [01:42<00:03,  2.22it/s] 97%|█████████▋| 230/236 [01:42<00:02,  2.22it/s] 98%|█████████▊| 231/236 [01:43<00:02,  2.22it/s] 98%|█████████▊| 232/236 [01:43<00:01,  2.22it/s] 99%|█████████▊| 233/236 [01:44<00:01,  2.22it/s] 99%|█████████▉| 234/236 [01:44<00:00,  2.22it/s]100%|█████████▉| 235/236 [01:45<00:00,  2.22it/s]100%|██████████| 236/236 [01:45<00:00,  2.25it/s]100%|██████████| 236/236 [01:45<00:00,  2.24it/s]The average generation time of a batch motion (bs=32) is 0.441329 seconds

0it [00:00, ?it/s]34it [00:00, 336.53it/s]78it [00:00, 392.96it/s]121it [00:00, 405.37it/s]164it [00:00, 414.78it/s]209it [00:00, 425.27it/s]254it [00:00, 433.58it/s]298it [00:00, 432.70it/s]342it [00:00, 422.97it/s]385it [00:00, 424.38it/s]428it [00:01, 422.30it/s]474it [00:01, 431.39it/s]518it [00:01, 425.21it/s]564it [00:01, 435.42it/s]609it [00:01, 437.87it/s]655it [00:01, 441.55it/s]700it [00:01, 444.01it/s]745it [00:01, 443.84it/s]790it [00:01, 438.29it/s]836it [00:01, 442.46it/s]881it [00:02, 436.71it/s]927it [00:02, 440.93it/s]972it [00:02, 437.44it/s]1016it [00:02, 422.98it/s]1059it [00:02, 397.06it/s]1102it [00:02, 406.18it/s]1148it [00:02, 420.72it/s]1191it [00:02, 412.84it/s]1237it [00:02, 425.11it/s]1282it [00:03, 430.65it/s]1327it [00:03, 433.58it/s]1371it [00:03, 430.36it/s]1416it [00:03, 434.68it/s]1460it [00:03, 431.64it/s]1506it [00:03, 439.82it/s]1551it [00:03, 439.68it/s]1596it [00:03, 436.94it/s]1640it [00:03, 435.48it/s]1684it [00:03, 384.75it/s]1724it [00:04, 349.69it/s]1761it [00:04, 310.69it/s]1794it [00:04, 290.20it/s]1825it [00:04, 278.86it/s]1854it [00:04, 266.55it/s]1882it [00:04, 251.33it/s]1908it [00:04, 253.18it/s]1935it [00:04, 255.86it/s]1961it [00:05, 255.05it/s]1989it [00:05, 259.38it/s]2016it [00:05, 194.68it/s]2039it [00:05, 202.69it/s]2070it [00:05, 228.14it/s]2097it [00:05, 238.93it/s]2123it [00:05, 242.78it/s]2153it [00:05, 258.33it/s]2182it [00:06, 266.21it/s]2212it [00:06, 274.40it/s]2241it [00:06, 277.03it/s]2271it [00:06, 281.60it/s]2301it [00:06, 279.00it/s]2330it [00:06, 281.81it/s]2359it [00:06, 271.92it/s]2387it [00:06, 261.91it/s]2414it [00:06, 261.15it/s]2441it [00:06, 255.28it/s]2470it [00:07, 263.62it/s]2497it [00:07, 262.00it/s]2529it [00:07, 275.76it/s]2557it [00:07, 271.43it/s]2588it [00:07, 280.74it/s]2619it [00:07, 288.40it/s]2648it [00:07, 265.54it/s]2683it [00:07, 287.28it/s]2715it [00:07, 294.59it/s]2749it [00:08, 306.30it/s]2785it [00:08, 320.11it/s]2823it [00:08, 337.45it/s]2867it [00:08, 366.22it/s]2914it [00:08, 396.67it/s]2955it [00:08, 399.45it/s]2997it [00:08, 404.84it/s]3039it [00:08, 407.82it/s]3086it [00:08, 424.52it/s]3129it [00:08, 421.08it/s]3172it [00:09, 416.95it/s]3214it [00:09, 411.68it/s]3261it [00:09, 425.93it/s]3306it [00:09, 432.54it/s]3351it [00:09, 437.19it/s]3397it [00:09, 441.35it/s]3442it [00:09, 424.69it/s]3485it [00:09, 422.48it/s]3528it [00:09, 423.41it/s]3571it [00:09, 422.30it/s]3614it [00:10, 419.03it/s]3656it [00:10, 415.39it/s]3698it [00:10, 404.79it/s]3739it [00:10, 238.23it/s]3784it [00:10, 278.60it/s]3830it [00:10, 316.92it/s]3875it [00:10, 346.46it/s]3920it [00:11, 371.49it/s]3962it [00:11, 383.05it/s]4004it [00:11, 382.94it/s]4045it [00:11, 389.53it/s]4086it [00:11, 392.72it/s]4127it [00:11, 393.39it/s]4168it [00:11, 389.77it/s]4208it [00:11, 391.40it/s]4248it [00:11, 388.42it/s]4288it [00:12, 376.90it/s]4330it [00:12, 389.13it/s]4373it [00:12, 400.02it/s]4416it [00:12, 407.63it/s]4457it [00:12, 407.27it/s]4500it [00:12, 413.81it/s]4542it [00:12, 415.29it/s]4585it [00:12, 416.72it/s]4630it [00:12, 424.55it/s]4648it [00:13, 356.23it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 3.9808
---> [text2motion] R_precision: (top 1): 0.3636 (top 2): 0.5608 (top 3): 0.6782 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 3.2310
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.0679
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 0.9836
!!! DONE !!!
================================================================================

模型: 3_h_012390_iters
评估时间: 2025年 07月 28日 星期一 13:01:00 CST
----------------------------------------
评估成功，用时: 185 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  8%|▊         | 345/4384 [00:00<00:01, 3442.59it/s] 16%|█▌        | 690/4384 [00:00<00:02, 1649.09it/s] 21%|██▏       | 933/4384 [00:00<00:01, 1872.72it/s] 27%|██▋       | 1163/4384 [00:00<00:01, 1993.98it/s] 32%|███▏      | 1391/4384 [00:00<00:01, 2040.33it/s] 37%|███▋      | 1614/4384 [00:00<00:01, 2075.87it/s] 42%|████▏     | 1840/4384 [00:00<00:01, 2129.39it/s] 47%|████▋     | 2070/4384 [00:00<00:01, 2177.32it/s] 52%|█████▏    | 2298/4384 [00:01<00:00, 2206.00it/s] 58%|█████▊    | 2531/4384 [00:01<00:00, 2240.32it/s] 63%|██████▎   | 2759/4384 [00:01<00:00, 2196.96it/s] 68%|██████▊   | 2982/4384 [00:01<00:00, 2206.55it/s] 73%|███████▎  | 3209/4384 [00:01<00:00, 2223.14it/s] 78%|███████▊  | 3434/4384 [00:01<00:00, 2230.30it/s] 83%|████████▎ | 3658/4384 [00:01<00:00, 2218.22it/s] 89%|████████▊ | 3881/4384 [00:01<00:00, 2220.03it/s] 94%|█████████▎| 4104/4384 [00:01<00:00, 2209.82it/s] 99%|█████████▊| 4326/4384 [00:02<00:00, 2206.38it/s]100%|██████████| 4384/4384 [00:02<00:00, 2150.69it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▌         | 221/4384 [00:00<00:01, 2208.05it/s] 10%|█         | 443/4384 [00:00<00:01, 2211.36it/s] 15%|█▌        | 665/4384 [00:00<00:01, 2204.15it/s] 20%|██        | 891/4384 [00:00<00:01, 2225.58it/s] 25%|██▌       | 1116/4384 [00:00<00:01, 2233.73it/s] 31%|███       | 1340/4384 [00:00<00:01, 2215.36it/s] 36%|███▌      | 1564/4384 [00:00<00:01, 2222.18it/s] 41%|████      | 1789/4384 [00:00<00:01, 2230.43it/s] 46%|████▌     | 2013/4384 [00:00<00:01, 2213.32it/s] 51%|█████     | 2236/4384 [00:01<00:00, 2216.43it/s] 56%|█████▌    | 2459/4384 [00:01<00:00, 2219.10it/s] 61%|██████    | 2684/4384 [00:01<00:00, 2228.37it/s] 66%|██████▋   | 2913/4384 [00:01<00:00, 2244.39it/s] 72%|███████▏  | 3138/4384 [00:01<00:00, 2232.82it/s] 77%|███████▋  | 3362/4384 [00:01<00:00, 2226.55it/s] 82%|████████▏ | 3585/4384 [00:01<00:00, 2208.37it/s] 87%|████████▋ | 3806/4384 [00:01<00:00, 2204.50it/s] 92%|█████████▏| 4027/4384 [00:01<00:00, 2204.37it/s] 97%|█████████▋| 4250/4384 [00:01<00:00, 2211.44it/s]100%|██████████| 4384/4384 [00:01<00:00, 2217.68it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/3_h_012390_iters.tar with 12390 iterations
Time: 2025-07-28 13:01:17.928572

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]19it [00:00, 184.79it/s]41it [00:00, 204.90it/s]73it [00:00, 255.27it/s]99it [00:00, 246.08it/s]130it [00:00, 265.18it/s]164it [00:00, 289.73it/s]194it [00:00, 277.93it/s]222it [00:00, 270.54it/s]250it [00:00, 249.11it/s]276it [00:01, 237.86it/s]301it [00:01, 230.53it/s]325it [00:01, 225.24it/s]348it [00:01, 222.13it/s]371it [00:01, 218.54it/s]393it [00:01, 204.93it/s]414it [00:01, 204.72it/s]435it [00:01, 203.50it/s]457it [00:01, 206.35it/s]479it [00:02, 208.58it/s]500it [00:02, 208.29it/s]521it [00:02, 207.04it/s]543it [00:02, 209.35it/s]565it [00:02, 210.26it/s]587it [00:02, 209.18it/s]608it [00:02, 207.36it/s]629it [00:02, 207.38it/s]651it [00:02, 209.39it/s]676it [00:03, 219.74it/s]701it [00:03, 225.71it/s]724it [00:03, 223.96it/s]747it [00:03, 218.68it/s]769it [00:03, 208.04it/s]790it [00:03, 203.02it/s]811it [00:03, 191.49it/s]832it [00:03, 190.86it/s]854it [00:03, 196.93it/s]876it [00:04, 201.71it/s]898it [00:04, 204.61it/s]920it [00:04, 206.86it/s]941it [00:04, 200.14it/s]963it [00:04, 203.66it/s]985it [00:04, 206.02it/s]1006it [00:04, 205.06it/s]1028it [00:04, 208.00it/s]1050it [00:04, 210.73it/s]1072it [00:04, 212.93it/s]1094it [00:05, 214.34it/s]1116it [00:05, 209.47it/s]1138it [00:05, 210.83it/s]1160it [00:05, 212.69it/s]1182it [00:05, 213.57it/s]1204it [00:05, 214.79it/s]1227it [00:05, 216.76it/s]1249it [00:05, 215.69it/s]1271it [00:05, 214.49it/s]1293it [00:05, 216.04it/s]1315it [00:06, 216.48it/s]1337it [00:06, 214.21it/s]1359it [00:06, 212.77it/s]1381it [00:06, 214.55it/s]1403it [00:06, 216.13it/s]1425it [00:06, 211.92it/s]1448it [00:06, 214.87it/s]1470it [00:06, 214.67it/s]1494it [00:06, 219.55it/s]1516it [00:07, 218.71it/s]1538it [00:07, 212.75it/s]1560it [00:07, 210.61it/s]1583it [00:07, 213.62it/s]1605it [00:07, 212.68it/s]1627it [00:07, 204.66it/s]1648it [00:07, 205.72it/s]1669it [00:07, 201.25it/s]1692it [00:07, 207.47it/s]1715it [00:07, 211.72it/s]1737it [00:08, 211.70it/s]1759it [00:08, 210.62it/s]1782it [00:08, 213.66it/s]1804it [00:08, 214.25it/s]1827it [00:08, 217.00it/s]1849it [00:08, 216.55it/s]1872it [00:08, 218.96it/s]1894it [00:08, 213.42it/s]1916it [00:08, 213.65it/s]1938it [00:09, 212.50it/s]1960it [00:09, 211.98it/s]1982it [00:09, 213.38it/s]2004it [00:09, 214.22it/s]2026it [00:09, 211.22it/s]2048it [00:09, 209.41it/s]2071it [00:09, 212.58it/s]2093it [00:09, 209.96it/s]2115it [00:09, 211.43it/s]2137it [00:09, 212.50it/s]2159it [00:10, 210.22it/s]2181it [00:10, 204.34it/s]2203it [00:10, 206.81it/s]2225it [00:10, 209.14it/s]2246it [00:10, 206.04it/s]2267it [00:10, 205.95it/s]2289it [00:10, 209.10it/s]2311it [00:10, 210.69it/s]2333it [00:10, 211.26it/s]2355it [00:10, 212.74it/s]2377it [00:11, 213.56it/s]2402it [00:11, 221.96it/s]2428it [00:11, 233.11it/s]2453it [00:11, 237.26it/s]2480it [00:11, 246.24it/s]2507it [00:11, 252.21it/s]2534it [00:11, 254.82it/s]2562it [00:11, 260.18it/s]2593it [00:11, 274.81it/s]2624it [00:12, 284.87it/s]2653it [00:12, 277.49it/s]2681it [00:12, 254.48it/s]2707it [00:12, 243.20it/s]2732it [00:12, 236.18it/s]2756it [00:12, 230.30it/s]2780it [00:12, 226.50it/s]2803it [00:12, 223.88it/s]2826it [00:12, 220.82it/s]2849it [00:13, 219.47it/s]2871it [00:13, 214.85it/s]2894it [00:13, 216.68it/s]2916it [00:13, 217.48it/s]2938it [00:13, 217.42it/s]2960it [00:13, 217.32it/s]2982it [00:13, 217.34it/s]3004it [00:13, 216.93it/s]3026it [00:13, 216.82it/s]3048it [00:13, 217.25it/s]3070it [00:14, 214.61it/s]3092it [00:14, 215.12it/s]3114it [00:14, 215.71it/s]3136it [00:14, 216.41it/s]3158it [00:14, 216.30it/s]3180it [00:14, 216.09it/s]3202it [00:14, 216.34it/s]3224it [00:14, 216.15it/s]3246it [00:14, 213.63it/s]3268it [00:14, 204.32it/s]3290it [00:15, 207.63it/s]3312it [00:15, 209.89it/s]3334it [00:15, 201.33it/s]3356it [00:15, 206.15it/s]3377it [00:15, 128.46it/s]3424it [00:15, 196.93it/s]3470it [00:15, 255.54it/s]3519it [00:16, 311.90it/s]3569it [00:16, 358.70it/s]3619it [00:16, 394.43it/s]3668it [00:16, 420.64it/s]3715it [00:16, 432.24it/s]3764it [00:16, 446.59it/s]3812it [00:16, 455.38it/s]3861it [00:16, 463.10it/s]3909it [00:16, 464.19it/s]3956it [00:16, 464.63it/s]4003it [00:17, 461.34it/s]4050it [00:17, 454.93it/s]4096it [00:17, 454.10it/s]4142it [00:17, 453.27it/s]4188it [00:17, 450.94it/s]4234it [00:17, 396.33it/s]4275it [00:17, 324.71it/s]4311it [00:17, 284.75it/s]4342it [00:18, 265.58it/s]4371it [00:18, 250.64it/s]4398it [00:18, 240.99it/s]4423it [00:18, 234.71it/s]4447it [00:18, 229.42it/s]4471it [00:18, 226.48it/s]4494it [00:18, 216.30it/s]4516it [00:18, 216.73it/s]4538it [00:19, 216.65it/s]4560it [00:19, 216.84it/s]4582it [00:19, 214.13it/s]4604it [00:19, 212.47it/s]4626it [00:19, 214.31it/s]4648it [00:19, 235.97it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:13,  1.22it/s]  1%|          | 2/236 [00:01<02:23,  1.63it/s]  1%|▏         | 3/236 [00:01<02:06,  1.85it/s]  2%|▏         | 4/236 [00:02<01:57,  1.98it/s]  2%|▏         | 5/236 [00:02<01:52,  2.05it/s]  3%|▎         | 6/236 [00:03<01:48,  2.11it/s]  3%|▎         | 7/236 [00:03<01:47,  2.13it/s]  3%|▎         | 8/236 [00:04<01:45,  2.16it/s]  4%|▍         | 9/236 [00:04<01:44,  2.18it/s]  4%|▍         | 10/236 [00:04<01:43,  2.17it/s]  5%|▍         | 11/236 [00:05<01:42,  2.19it/s]  5%|▌         | 12/236 [00:05<01:41,  2.21it/s]  6%|▌         | 13/236 [00:06<01:39,  2.23it/s]  6%|▌         | 14/236 [00:06<01:37,  2.29it/s]  6%|▋         | 15/236 [00:07<01:37,  2.27it/s]  7%|▋         | 16/236 [00:07<01:37,  2.27it/s]  7%|▋         | 17/236 [00:08<01:37,  2.26it/s]  8%|▊         | 18/236 [00:08<01:36,  2.25it/s]  8%|▊         | 19/236 [00:08<01:36,  2.25it/s]  8%|▊         | 20/236 [00:09<01:36,  2.25it/s]  9%|▉         | 21/236 [00:09<01:35,  2.24it/s]  9%|▉         | 22/236 [00:10<01:36,  2.22it/s] 10%|▉         | 23/236 [00:10<01:35,  2.23it/s] 10%|█         | 24/236 [00:11<01:34,  2.23it/s] 11%|█         | 25/236 [00:11<01:34,  2.24it/s] 11%|█         | 26/236 [00:12<01:34,  2.23it/s] 11%|█▏        | 27/236 [00:12<01:33,  2.22it/s] 12%|█▏        | 28/236 [00:12<01:33,  2.23it/s] 12%|█▏        | 29/236 [00:13<01:32,  2.23it/s] 13%|█▎        | 30/236 [00:13<01:32,  2.24it/s] 13%|█▎        | 31/236 [00:14<01:31,  2.23it/s] 14%|█▎        | 32/236 [00:14<01:31,  2.24it/s] 14%|█▍        | 33/236 [00:15<01:30,  2.23it/s] 14%|█▍        | 34/236 [00:15<01:30,  2.24it/s] 15%|█▍        | 35/236 [00:16<01:30,  2.22it/s] 15%|█▌        | 36/236 [00:16<01:30,  2.22it/s] 16%|█▌        | 37/236 [00:16<01:29,  2.22it/s] 16%|█▌        | 38/236 [00:17<01:29,  2.22it/s] 17%|█▋        | 39/236 [00:17<01:28,  2.23it/s] 17%|█▋        | 40/236 [00:18<01:27,  2.23it/s] 17%|█▋        | 41/236 [00:18<01:27,  2.23it/s] 18%|█▊        | 42/236 [00:19<01:26,  2.23it/s] 18%|█▊        | 43/236 [00:19<01:26,  2.24it/s] 19%|█▊        | 44/236 [00:20<01:25,  2.24it/s] 19%|█▉        | 45/236 [00:20<01:25,  2.24it/s] 19%|█▉        | 46/236 [00:20<01:24,  2.24it/s] 20%|█▉        | 47/236 [00:21<01:24,  2.23it/s] 20%|██        | 48/236 [00:21<01:24,  2.24it/s] 21%|██        | 49/236 [00:22<01:23,  2.24it/s] 21%|██        | 50/236 [00:22<01:23,  2.24it/s] 22%|██▏       | 51/236 [00:23<01:22,  2.23it/s] 22%|██▏       | 52/236 [00:23<01:22,  2.24it/s] 22%|██▏       | 53/236 [00:24<01:21,  2.23it/s] 23%|██▎       | 54/236 [00:24<01:21,  2.23it/s] 23%|██▎       | 55/236 [00:25<01:21,  2.23it/s] 24%|██▎       | 56/236 [00:25<01:20,  2.23it/s] 24%|██▍       | 57/236 [00:25<01:20,  2.23it/s] 25%|██▍       | 58/236 [00:26<01:19,  2.23it/s] 25%|██▌       | 59/236 [00:26<01:19,  2.23it/s] 25%|██▌       | 60/236 [00:27<01:18,  2.24it/s] 26%|██▌       | 61/236 [00:27<01:18,  2.24it/s] 26%|██▋       | 62/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 63/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 64/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 65/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 66/236 [00:29<01:15,  2.24it/s] 28%|██▊       | 67/236 [00:30<01:15,  2.24it/s] 29%|██▉       | 68/236 [00:30<01:15,  2.24it/s] 29%|██▉       | 69/236 [00:31<01:12,  2.29it/s] 30%|██▉       | 70/236 [00:31<01:13,  2.27it/s] 30%|███       | 71/236 [00:32<01:12,  2.26it/s] 31%|███       | 72/236 [00:32<01:12,  2.25it/s] 31%|███       | 73/236 [00:33<01:12,  2.24it/s] 31%|███▏      | 74/236 [00:33<01:12,  2.23it/s] 32%|███▏      | 75/236 [00:33<01:12,  2.23it/s] 32%|███▏      | 76/236 [00:34<01:11,  2.24it/s] 33%|███▎      | 77/236 [00:34<01:11,  2.24it/s] 33%|███▎      | 78/236 [00:35<01:10,  2.24it/s] 33%|███▎      | 79/236 [00:35<01:10,  2.24it/s] 34%|███▍      | 80/236 [00:36<01:09,  2.24it/s] 34%|███▍      | 81/236 [00:36<01:09,  2.24it/s] 35%|███▍      | 82/236 [00:37<01:08,  2.24it/s] 35%|███▌      | 83/236 [00:37<01:08,  2.24it/s] 36%|███▌      | 84/236 [00:37<01:07,  2.24it/s] 36%|███▌      | 85/236 [00:38<01:07,  2.24it/s] 36%|███▋      | 86/236 [00:38<01:06,  2.24it/s] 37%|███▋      | 87/236 [00:39<01:04,  2.29it/s] 37%|███▋      | 88/236 [00:39<01:04,  2.28it/s] 38%|███▊      | 89/236 [00:40<01:04,  2.27it/s] 38%|███▊      | 90/236 [00:40<01:04,  2.26it/s] 39%|███▊      | 91/236 [00:41<01:04,  2.26it/s] 39%|███▉      | 92/236 [00:41<01:03,  2.25it/s] 39%|███▉      | 93/236 [00:41<01:03,  2.25it/s] 40%|███▉      | 94/236 [00:42<01:03,  2.25it/s] 40%|████      | 95/236 [00:42<01:02,  2.25it/s] 41%|████      | 96/236 [00:43<01:02,  2.24it/s] 41%|████      | 97/236 [00:43<01:02,  2.24it/s] 42%|████▏     | 98/236 [00:44<01:01,  2.24it/s] 42%|████▏     | 99/236 [00:44<01:01,  2.24it/s] 42%|████▏     | 100/236 [00:45<01:00,  2.25it/s] 43%|████▎     | 101/236 [00:45<00:59,  2.25it/s] 43%|████▎     | 102/236 [00:45<00:59,  2.26it/s] 44%|████▎     | 103/236 [00:46<00:58,  2.26it/s] 44%|████▍     | 104/236 [00:46<00:58,  2.26it/s] 44%|████▍     | 105/236 [00:47<00:56,  2.32it/s] 45%|████▍     | 106/236 [00:47<00:55,  2.33it/s] 45%|████▌     | 107/236 [00:48<00:56,  2.30it/s] 46%|████▌     | 108/236 [00:48<00:55,  2.29it/s] 46%|████▌     | 109/236 [00:48<00:55,  2.28it/s] 47%|████▋     | 110/236 [00:49<00:55,  2.25it/s] 47%|████▋     | 111/236 [00:49<00:55,  2.24it/s] 47%|████▋     | 112/236 [00:50<00:55,  2.24it/s] 48%|████▊     | 113/236 [00:50<00:55,  2.24it/s] 48%|████▊     | 114/236 [00:51<00:54,  2.24it/s] 49%|████▊     | 115/236 [00:51<00:54,  2.23it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.28it/s] 50%|████▉     | 117/236 [00:52<00:52,  2.26it/s] 50%|█████     | 118/236 [00:53<00:52,  2.25it/s] 50%|█████     | 119/236 [00:53<00:52,  2.24it/s] 51%|█████     | 120/236 [00:53<00:52,  2.22it/s] 51%|█████▏    | 121/236 [00:54<00:51,  2.22it/s] 52%|█████▏    | 122/236 [00:54<00:51,  2.21it/s] 52%|█████▏    | 123/236 [00:55<00:51,  2.20it/s] 53%|█████▎    | 124/236 [00:55<00:50,  2.20it/s] 53%|█████▎    | 125/236 [00:56<00:50,  2.19it/s] 53%|█████▎    | 126/236 [00:56<00:50,  2.18it/s] 54%|█████▍    | 127/236 [00:57<00:50,  2.18it/s] 54%|█████▍    | 128/236 [00:57<00:49,  2.18it/s] 55%|█████▍    | 129/236 [00:58<00:48,  2.19it/s] 55%|█████▌    | 130/236 [00:58<00:48,  2.20it/s] 56%|█████▌    | 131/236 [00:58<00:47,  2.21it/s] 56%|█████▌    | 132/236 [00:59<00:46,  2.23it/s] 56%|█████▋    | 133/236 [00:59<00:43,  2.38it/s] 57%|█████▋    | 134/236 [01:00<00:43,  2.34it/s] 57%|█████▋    | 135/236 [01:00<00:43,  2.31it/s] 58%|█████▊    | 136/236 [01:01<00:43,  2.30it/s] 58%|█████▊    | 137/236 [01:01<00:43,  2.29it/s] 58%|█████▊    | 138/236 [01:01<00:42,  2.28it/s] 59%|█████▉    | 139/236 [01:02<00:42,  2.27it/s] 59%|█████▉    | 140/236 [01:02<00:42,  2.27it/s] 60%|█████▉    | 141/236 [01:03<00:41,  2.27it/s] 60%|██████    | 142/236 [01:03<00:41,  2.27it/s] 61%|██████    | 143/236 [01:04<00:41,  2.26it/s] 61%|██████    | 144/236 [01:04<00:40,  2.26it/s] 61%|██████▏   | 145/236 [01:05<00:40,  2.26it/s] 62%|██████▏   | 146/236 [01:05<00:39,  2.26it/s] 62%|██████▏   | 147/236 [01:05<00:39,  2.26it/s] 63%|██████▎   | 148/236 [01:06<00:39,  2.25it/s] 63%|██████▎   | 149/236 [01:06<00:38,  2.25it/s] 64%|██████▎   | 150/236 [01:07<00:38,  2.25it/s] 64%|██████▍   | 151/236 [01:07<00:37,  2.26it/s] 64%|██████▍   | 152/236 [01:08<00:34,  2.42it/s] 65%|██████▍   | 153/236 [01:08<00:35,  2.37it/s] 65%|██████▌   | 154/236 [01:08<00:35,  2.32it/s] 66%|██████▌   | 155/236 [01:09<00:35,  2.30it/s] 66%|██████▌   | 156/236 [01:09<00:35,  2.29it/s] 67%|██████▋   | 157/236 [01:10<00:34,  2.28it/s] 67%|██████▋   | 158/236 [01:10<00:34,  2.27it/s] 67%|██████▋   | 159/236 [01:11<00:33,  2.27it/s] 68%|██████▊   | 160/236 [01:11<00:33,  2.26it/s] 68%|██████▊   | 161/236 [01:12<00:33,  2.26it/s] 69%|██████▊   | 162/236 [01:12<00:32,  2.25it/s] 69%|██████▉   | 163/236 [01:12<00:32,  2.25it/s] 69%|██████▉   | 164/236 [01:13<00:31,  2.25it/s] 70%|██████▉   | 165/236 [01:13<00:31,  2.25it/s] 70%|███████   | 166/236 [01:14<00:31,  2.25it/s] 71%|███████   | 167/236 [01:14<00:30,  2.25it/s] 71%|███████   | 168/236 [01:15<00:30,  2.26it/s] 72%|███████▏  | 169/236 [01:15<00:29,  2.25it/s] 72%|███████▏  | 170/236 [01:16<00:29,  2.25it/s] 72%|███████▏  | 171/236 [01:16<00:29,  2.24it/s] 73%|███████▎  | 172/236 [01:16<00:28,  2.22it/s] 73%|███████▎  | 173/236 [01:17<00:28,  2.21it/s] 74%|███████▎  | 174/236 [01:17<00:28,  2.21it/s] 74%|███████▍  | 175/236 [01:18<00:27,  2.20it/s] 75%|███████▍  | 176/236 [01:18<00:27,  2.21it/s] 75%|███████▌  | 177/236 [01:19<00:26,  2.22it/s] 75%|███████▌  | 178/236 [01:19<00:26,  2.22it/s] 76%|███████▌  | 179/236 [01:20<00:25,  2.23it/s] 76%|███████▋  | 180/236 [01:20<00:25,  2.24it/s] 77%|███████▋  | 181/236 [01:21<00:24,  2.24it/s] 77%|███████▋  | 182/236 [01:21<00:24,  2.25it/s] 78%|███████▊  | 183/236 [01:21<00:23,  2.25it/s] 78%|███████▊  | 184/236 [01:22<00:23,  2.25it/s] 78%|███████▊  | 185/236 [01:22<00:22,  2.25it/s] 79%|███████▉  | 186/236 [01:23<00:22,  2.25it/s] 79%|███████▉  | 187/236 [01:23<00:21,  2.25it/s] 80%|███████▉  | 188/236 [01:24<00:21,  2.24it/s] 80%|████████  | 189/236 [01:24<00:21,  2.18it/s] 81%|████████  | 190/236 [01:25<00:21,  2.19it/s] 81%|████████  | 191/236 [01:25<00:20,  2.20it/s] 81%|████████▏ | 192/236 [01:25<00:20,  2.20it/s] 82%|████████▏ | 193/236 [01:26<00:19,  2.20it/s] 82%|████████▏ | 194/236 [01:26<00:19,  2.20it/s] 83%|████████▎ | 195/236 [01:27<00:18,  2.20it/s] 83%|████████▎ | 196/236 [01:27<00:18,  2.21it/s] 83%|████████▎ | 197/236 [01:28<00:17,  2.21it/s] 84%|████████▍ | 198/236 [01:28<00:17,  2.21it/s] 84%|████████▍ | 199/236 [01:29<00:16,  2.21it/s] 85%|████████▍ | 200/236 [01:29<00:16,  2.21it/s] 85%|████████▌ | 201/236 [01:30<00:15,  2.26it/s] 86%|████████▌ | 202/236 [01:30<00:15,  2.25it/s] 86%|████████▌ | 203/236 [01:30<00:14,  2.24it/s] 86%|████████▋ | 204/236 [01:31<00:14,  2.23it/s] 87%|████████▋ | 205/236 [01:31<00:13,  2.22it/s] 87%|████████▋ | 206/236 [01:32<00:13,  2.22it/s] 88%|████████▊ | 207/236 [01:32<00:13,  2.21it/s] 88%|████████▊ | 208/236 [01:33<00:12,  2.22it/s] 89%|████████▊ | 209/236 [01:33<00:12,  2.22it/s] 89%|████████▉ | 210/236 [01:33<00:10,  2.39it/s] 89%|████████▉ | 211/236 [01:34<00:10,  2.31it/s] 90%|████████▉ | 212/236 [01:34<00:09,  2.47it/s] 90%|█████████ | 213/236 [01:35<00:09,  2.36it/s] 91%|█████████ | 214/236 [01:35<00:09,  2.31it/s] 91%|█████████ | 215/236 [01:36<00:09,  2.28it/s] 92%|█████████▏| 216/236 [01:36<00:08,  2.26it/s] 92%|█████████▏| 217/236 [01:37<00:08,  2.24it/s] 92%|█████████▏| 218/236 [01:37<00:08,  2.23it/s] 93%|█████████▎| 219/236 [01:37<00:07,  2.23it/s] 93%|█████████▎| 220/236 [01:38<00:07,  2.22it/s] 94%|█████████▎| 221/236 [01:38<00:06,  2.22it/s] 94%|█████████▍| 222/236 [01:39<00:06,  2.22it/s] 94%|█████████▍| 223/236 [01:39<00:05,  2.22it/s] 95%|█████████▍| 224/236 [01:40<00:05,  2.22it/s] 95%|█████████▌| 225/236 [01:40<00:04,  2.21it/s] 96%|█████████▌| 226/236 [01:41<00:04,  2.22it/s] 96%|█████████▌| 227/236 [01:41<00:04,  2.22it/s] 97%|█████████▋| 228/236 [01:42<00:03,  2.22it/s] 97%|█████████▋| 229/236 [01:42<00:03,  2.22it/s] 97%|█████████▋| 230/236 [01:42<00:02,  2.22it/s] 98%|█████████▊| 231/236 [01:43<00:02,  2.21it/s] 98%|█████████▊| 232/236 [01:43<00:01,  2.22it/s] 99%|█████████▊| 233/236 [01:44<00:01,  2.22it/s] 99%|█████████▉| 234/236 [01:44<00:00,  2.22it/s]100%|█████████▉| 235/236 [01:45<00:00,  2.23it/s]100%|██████████| 236/236 [01:45<00:00,  2.26it/s]100%|██████████| 236/236 [01:45<00:00,  2.23it/s]The average generation time of a batch motion (bs=32) is 0.441237 seconds

0it [00:00, ?it/s]13it [00:00, 129.27it/s]34it [00:00, 174.86it/s]55it [00:00, 189.34it/s]77it [00:00, 200.45it/s]99it [00:00, 207.21it/s]120it [00:00, 206.34it/s]141it [00:00, 207.51it/s]162it [00:00, 202.54it/s]184it [00:00, 205.58it/s]206it [00:01, 207.90it/s]228it [00:01, 210.89it/s]250it [00:01, 212.97it/s]272it [00:01, 211.55it/s]294it [00:01, 210.84it/s]316it [00:01, 206.61it/s]338it [00:01, 209.94it/s]360it [00:01, 209.22it/s]382it [00:01, 211.94it/s]404it [00:02, 186.81it/s]424it [00:02, 179.73it/s]444it [00:02, 182.97it/s]464it [00:02, 187.08it/s]483it [00:02, 175.21it/s]501it [00:02, 176.04it/s]519it [00:02, 174.86it/s]538it [00:02, 177.19it/s]557it [00:02, 179.40it/s]576it [00:02, 181.46it/s]595it [00:03, 183.92it/s]615it [00:03, 188.49it/s]635it [00:03, 189.81it/s]655it [00:03, 190.42it/s]675it [00:03, 180.27it/s]695it [00:03, 183.93it/s]715it [00:03, 186.50it/s]734it [00:03, 177.58it/s]754it [00:03, 181.35it/s]774it [00:04, 185.31it/s]795it [00:04, 190.77it/s]817it [00:04, 198.66it/s]840it [00:04, 205.30it/s]861it [00:04, 205.11it/s]883it [00:04, 207.33it/s]906it [00:04, 212.26it/s]928it [00:04, 214.11it/s]950it [00:04, 212.73it/s]972it [00:04, 213.00it/s]994it [00:05, 213.96it/s]1016it [00:05, 211.98it/s]1038it [00:05, 211.80it/s]1060it [00:05, 213.25it/s]1082it [00:05, 214.33it/s]1104it [00:05, 215.48it/s]1126it [00:05, 213.92it/s]1148it [00:05, 206.01it/s]1169it [00:05, 202.21it/s]1190it [00:06, 198.81it/s]1211it [00:06, 200.09it/s]1232it [00:06, 197.39it/s]1252it [00:06, 192.64it/s]1272it [00:06, 190.32it/s]1292it [00:06, 189.79it/s]1311it [00:06, 189.71it/s]1330it [00:06, 189.30it/s]1349it [00:06, 186.22it/s]1368it [00:06, 185.29it/s]1387it [00:07, 183.39it/s]1406it [00:07, 182.39it/s]1425it [00:07, 182.22it/s]1444it [00:07, 178.72it/s]1462it [00:07, 178.18it/s]1480it [00:07, 169.11it/s]1497it [00:07, 163.55it/s]1515it [00:07, 165.88it/s]1534it [00:07, 170.37it/s]1553it [00:08, 174.97it/s]1573it [00:08, 181.41it/s]1592it [00:08, 178.09it/s]1611it [00:08, 181.16it/s]1633it [00:08, 192.38it/s]1655it [00:08, 199.39it/s]1678it [00:08, 205.39it/s]1700it [00:08, 208.75it/s]1722it [00:08, 208.82it/s]1743it [00:08, 208.88it/s]1765it [00:09, 209.62it/s]1787it [00:09, 211.17it/s]1809it [00:09, 207.79it/s]1830it [00:09, 205.68it/s]1851it [00:09, 206.58it/s]1873it [00:09, 209.22it/s]1894it [00:09, 202.03it/s]1915it [00:09, 197.61it/s]1935it [00:09, 191.17it/s]1955it [00:10, 181.77it/s]1974it [00:10, 177.32it/s]1993it [00:10, 178.63it/s]2011it [00:10, 123.24it/s]2031it [00:10, 139.00it/s]2050it [00:10, 150.76it/s]2068it [00:10, 157.39it/s]2086it [00:10, 163.28it/s]2105it [00:11, 169.31it/s]2123it [00:11, 170.15it/s]2142it [00:11, 175.19it/s]2161it [00:11, 178.37it/s]2180it [00:11, 180.59it/s]2200it [00:11, 183.84it/s]2219it [00:11, 184.02it/s]2238it [00:11, 185.42it/s]2257it [00:11, 185.95it/s]2276it [00:11, 185.61it/s]2295it [00:12, 186.01it/s]2314it [00:12, 184.27it/s]2333it [00:12, 185.37it/s]2352it [00:12, 180.35it/s]2371it [00:12, 182.10it/s]2390it [00:12, 179.29it/s]2408it [00:12, 176.27it/s]2426it [00:12, 175.09it/s]2445it [00:12, 177.62it/s]2463it [00:13, 177.19it/s]2482it [00:13, 180.22it/s]2501it [00:13, 176.75it/s]2520it [00:13, 179.76it/s]2539it [00:13, 180.71it/s]2558it [00:13, 178.65it/s]2577it [00:13, 181.49it/s]2596it [00:13, 182.85it/s]2615it [00:13, 183.21it/s]2634it [00:13, 180.68it/s]2654it [00:14, 185.27it/s]2673it [00:14, 182.97it/s]2692it [00:14, 184.51it/s]2711it [00:14, 182.30it/s]2730it [00:14, 184.31it/s]2749it [00:14, 184.93it/s]2768it [00:14, 186.18it/s]2787it [00:14, 184.37it/s]2806it [00:14, 175.44it/s]2825it [00:15, 178.40it/s]2843it [00:15, 173.23it/s]2862it [00:15, 177.03it/s]2881it [00:15, 178.52it/s]2900it [00:15, 181.47it/s]2919it [00:15, 183.48it/s]2938it [00:15, 181.87it/s]2957it [00:15, 179.12it/s]2975it [00:15, 179.25it/s]2993it [00:15, 177.48it/s]3011it [00:16, 174.59it/s]3029it [00:16, 175.34it/s]3047it [00:16, 174.71it/s]3066it [00:16, 178.18it/s]3085it [00:16, 180.30it/s]3104it [00:16, 182.23it/s]3123it [00:16, 180.73it/s]3142it [00:16, 174.97it/s]3162it [00:16, 182.03it/s]3181it [00:16, 182.21it/s]3200it [00:17, 173.58it/s]3222it [00:17, 185.21it/s]3243it [00:17, 192.25it/s]3263it [00:17, 190.88it/s]3283it [00:17, 187.48it/s]3304it [00:17, 192.15it/s]3324it [00:17, 193.09it/s]3344it [00:17, 192.45it/s]3364it [00:17, 190.51it/s]3384it [00:18, 191.78it/s]3404it [00:18, 192.68it/s]3424it [00:18, 191.14it/s]3444it [00:18, 191.43it/s]3464it [00:18, 193.51it/s]3484it [00:18, 189.11it/s]3503it [00:18, 189.30it/s]3523it [00:18, 190.06it/s]3543it [00:18, 190.51it/s]3563it [00:18, 190.36it/s]3583it [00:19, 189.00it/s]3603it [00:19, 190.52it/s]3623it [00:19, 191.66it/s]3643it [00:19, 194.00it/s]3663it [00:19, 192.84it/s]3683it [00:19, 190.87it/s]3704it [00:19, 195.65it/s]3724it [00:20, 105.78it/s]3745it [00:20, 124.30it/s]3765it [00:20, 139.37it/s]3785it [00:20, 152.16it/s]3805it [00:20, 162.53it/s]3825it [00:20, 171.16it/s]3845it [00:20, 178.24it/s]3865it [00:20, 182.73it/s]3885it [00:20, 185.65it/s]3906it [00:21, 191.79it/s]3926it [00:21, 190.66it/s]3946it [00:21, 190.25it/s]3966it [00:21, 191.72it/s]3986it [00:21, 190.67it/s]4006it [00:21, 189.80it/s]4026it [00:21, 190.68it/s]4046it [00:21, 185.38it/s]4065it [00:21, 186.66it/s]4085it [00:21, 187.75it/s]4104it [00:22, 185.71it/s]4123it [00:22, 183.46it/s]4148it [00:22, 199.55it/s]4174it [00:22, 214.46it/s]4196it [00:22, 213.47it/s]4218it [00:22, 211.27it/s]4240it [00:22, 209.76it/s]4261it [00:22, 202.40it/s]4282it [00:22, 202.03it/s]4303it [00:23, 200.04it/s]4325it [00:23, 203.34it/s]4346it [00:23, 201.11it/s]4367it [00:23, 197.78it/s]4387it [00:23, 198.32it/s]4407it [00:23, 194.62it/s]4427it [00:23, 187.12it/s]4447it [00:23, 188.52it/s]4467it [00:23, 191.59it/s]4487it [00:24, 190.02it/s]4507it [00:24, 186.33it/s]4527it [00:24, 187.34it/s]4547it [00:24, 189.04it/s]4567it [00:24, 189.20it/s]4586it [00:24, 187.18it/s]4606it [00:24, 189.60it/s]4626it [00:24, 190.14it/s]4646it [00:24, 187.58it/s]4648it [00:25, 183.55it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 3.2043
---> [text2motion] R_precision: (top 1): 0.4774 (top 2): 0.6765 (top 3): 0.7797 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 1.3482
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.4964
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.3932
!!! DONE !!!
================================================================================

模型: 4_h_018630_iters
评估时间: 2025年 07月 28日 星期一 13:04:07 CST
----------------------------------------
评估成功，用时: 176 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 323/4384 [00:00<00:01, 3222.93it/s] 15%|█▍        | 646/4384 [00:00<00:02, 1673.94it/s] 20%|█▉        | 869/4384 [00:00<00:01, 1840.88it/s] 25%|██▍       | 1093/4384 [00:00<00:01, 1960.49it/s] 30%|██▉       | 1311/4384 [00:00<00:01, 2009.43it/s] 35%|███▍      | 1529/4384 [00:00<00:01, 2059.72it/s] 40%|███▉      | 1746/4384 [00:00<00:01, 2084.74it/s] 45%|████▍     | 1964/4384 [00:00<00:01, 2113.01it/s] 50%|████▉     | 2181/4384 [00:01<00:01, 2073.93it/s] 55%|█████▍    | 2393/4384 [00:01<00:00, 2085.91it/s] 59%|█████▉    | 2607/4384 [00:01<00:00, 2099.18it/s] 64%|██████▍   | 2819/4384 [00:01<00:00, 2103.10it/s] 69%|██████▉   | 3041/4384 [00:01<00:00, 2137.43it/s] 75%|███████▍  | 3271/4384 [00:01<00:00, 2182.76it/s] 80%|███████▉  | 3495/4384 [00:01<00:00, 2198.09it/s] 85%|████████▍ | 3716/4384 [00:01<00:00, 2189.23it/s] 90%|████████▉ | 3936/4384 [00:01<00:00, 2178.21it/s] 95%|█████████▍| 4155/4384 [00:01<00:00, 2176.17it/s]100%|█████████▉| 4377/4384 [00:02<00:00, 2186.21it/s]100%|██████████| 4384/4384 [00:02<00:00, 2105.26it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  6%|▌         | 242/4384 [00:00<00:01, 2413.49it/s] 11%|█         | 484/4384 [00:00<00:01, 2362.96it/s] 17%|█▋        | 727/4384 [00:00<00:01, 2392.04it/s] 22%|██▏       | 973/4384 [00:00<00:01, 2415.28it/s] 28%|██▊       | 1215/4384 [00:00<00:01, 2399.60it/s] 33%|███▎      | 1456/4384 [00:00<00:01, 2371.44it/s] 39%|███▊      | 1695/4384 [00:00<00:01, 2375.22it/s] 44%|████▍     | 1933/4384 [00:00<00:01, 2350.76it/s] 49%|████▉     | 2169/4384 [00:00<00:00, 2328.50it/s] 55%|█████▍    | 2406/4384 [00:01<00:00, 2340.18it/s] 60%|██████    | 2642/4384 [00:01<00:00, 2343.46it/s] 66%|██████▌   | 2877/4384 [00:01<00:00, 2343.97it/s] 71%|███████   | 3113/4384 [00:01<00:00, 2348.33it/s] 76%|███████▋  | 3348/4384 [00:01<00:00, 2346.26it/s] 82%|████████▏ | 3584/4384 [00:01<00:00, 2347.43it/s] 87%|████████▋ | 3819/4384 [00:01<00:00, 2347.70it/s] 93%|█████████▎| 4056/4384 [00:01<00:00, 2353.28it/s] 98%|█████████▊| 4294/4384 [00:01<00:00, 2359.02it/s]100%|██████████| 4384/4384 [00:01<00:00, 2359.59it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/4_h_018630_iters.tar with 18630 iterations
Time: 2025-07-28 13:04:24.979416

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]25it [00:00, 246.04it/s]50it [00:00, 248.18it/s]75it [00:00, 239.77it/s]100it [00:00, 233.20it/s]130it [00:00, 254.69it/s]161it [00:00, 271.90it/s]189it [00:00, 260.49it/s]216it [00:00, 262.50it/s]247it [00:00, 274.57it/s]277it [00:01, 279.30it/s]308it [00:01, 286.53it/s]337it [00:01, 266.93it/s]364it [00:01, 244.16it/s]389it [00:01, 243.48it/s]416it [00:01, 247.23it/s]446it [00:01, 261.57it/s]473it [00:01, 260.35it/s]502it [00:01, 268.48it/s]533it [00:02, 279.10it/s]571it [00:02, 307.19it/s]605it [00:02, 313.81it/s]637it [00:02, 315.07it/s]669it [00:02, 315.03it/s]701it [00:02, 313.90it/s]733it [00:02, 300.68it/s]764it [00:02, 301.31it/s]797it [00:02, 309.35it/s]829it [00:02, 283.17it/s]858it [00:03, 264.69it/s]887it [00:03, 270.82it/s]917it [00:03, 278.50it/s]949it [00:03, 289.22it/s]979it [00:03, 278.22it/s]1008it [00:03, 270.59it/s]1036it [00:03, 262.06it/s]1065it [00:03, 267.77it/s]1092it [00:03, 267.23it/s]1119it [00:04, 264.13it/s]1148it [00:04, 270.61it/s]1179it [00:04, 279.89it/s]1211it [00:04, 290.53it/s]1241it [00:04, 290.07it/s]1272it [00:04, 294.24it/s]1302it [00:04, 263.86it/s]1329it [00:04, 245.64it/s]1355it [00:04, 230.14it/s]1379it [00:05, 223.91it/s]1402it [00:05, 221.64it/s]1425it [00:05, 218.25it/s]1447it [00:05, 213.53it/s]1471it [00:05, 219.88it/s]1494it [00:05, 221.35it/s]1518it [00:05, 226.57it/s]1544it [00:05, 234.88it/s]1569it [00:05, 237.55it/s]1593it [00:06, 229.66it/s]1617it [00:06, 206.75it/s]1640it [00:06, 212.93it/s]1662it [00:06, 214.00it/s]1684it [00:06, 210.53it/s]1707it [00:06, 214.43it/s]1734it [00:06, 230.03it/s]1774it [00:06, 278.60it/s]1817it [00:06, 321.79it/s]1859it [00:07, 348.65it/s]1903it [00:07, 373.27it/s]1943it [00:07, 378.06it/s]1981it [00:07, 339.90it/s]2016it [00:07, 326.63it/s]2050it [00:07, 317.76it/s]2083it [00:07, 307.11it/s]2115it [00:07, 306.37it/s]2146it [00:07, 306.10it/s]2177it [00:08, 302.95it/s]2208it [00:08, 279.52it/s]2237it [00:08, 265.75it/s]2264it [00:08, 251.03it/s]2290it [00:08, 242.60it/s]2315it [00:08, 236.06it/s]2339it [00:08, 232.89it/s]2363it [00:08, 226.32it/s]2386it [00:08, 220.84it/s]2409it [00:09, 213.62it/s]2431it [00:09, 208.87it/s]2452it [00:09, 208.58it/s]2473it [00:09, 205.22it/s]2497it [00:09, 214.41it/s]2522it [00:09, 222.69it/s]2545it [00:09, 218.06it/s]2567it [00:09, 208.94it/s]2588it [00:09, 205.06it/s]2623it [00:10, 244.14it/s]2651it [00:10, 253.01it/s]2684it [00:10, 274.24it/s]2712it [00:10, 269.15it/s]2740it [00:10, 252.09it/s]2766it [00:10, 236.29it/s]2790it [00:10, 229.76it/s]2814it [00:10, 218.71it/s]2837it [00:10, 220.29it/s]2860it [00:11, 218.27it/s]2882it [00:11, 216.01it/s]2904it [00:11, 209.83it/s]2927it [00:11, 213.93it/s]2950it [00:11, 217.43it/s]2972it [00:11, 210.76it/s]2994it [00:11, 211.46it/s]3016it [00:11, 211.69it/s]3038it [00:11, 210.36it/s]3062it [00:12, 215.68it/s]3084it [00:12, 214.16it/s]3106it [00:12, 211.82it/s]3129it [00:12, 215.12it/s]3151it [00:12, 208.83it/s]3172it [00:12, 206.10it/s]3193it [00:12, 201.88it/s]3214it [00:12, 200.54it/s]3235it [00:12, 199.06it/s]3255it [00:12, 187.14it/s]3274it [00:13, 186.86it/s]3293it [00:13, 187.74it/s]3313it [00:13, 191.01it/s]3333it [00:13, 181.41it/s]3353it [00:13, 186.02it/s]3372it [00:13, 105.59it/s]3395it [00:13, 128.39it/s]3415it [00:14, 143.24it/s]3435it [00:14, 155.15it/s]3455it [00:14, 165.70it/s]3474it [00:14, 171.89it/s]3494it [00:14, 179.28it/s]3514it [00:14, 182.43it/s]3534it [00:14, 187.04it/s]3554it [00:14, 189.41it/s]3574it [00:14, 192.34it/s]3594it [00:14, 192.07it/s]3614it [00:15, 194.15it/s]3634it [00:15, 193.22it/s]3654it [00:15, 194.99it/s]3674it [00:15, 194.72it/s]3694it [00:15, 194.45it/s]3714it [00:15, 195.69it/s]3735it [00:15, 197.13it/s]3755it [00:15, 195.09it/s]3775it [00:15, 196.48it/s]3796it [00:16, 198.39it/s]3816it [00:16, 198.25it/s]3837it [00:16, 200.13it/s]3858it [00:16, 200.45it/s]3879it [00:16, 198.03it/s]3900it [00:16, 196.19it/s]3921it [00:16, 197.87it/s]3941it [00:16, 194.15it/s]3961it [00:16, 195.39it/s]3981it [00:16, 194.93it/s]4001it [00:17, 185.59it/s]4022it [00:17, 189.92it/s]4042it [00:17, 192.20it/s]4062it [00:17, 192.25it/s]4082it [00:17, 188.97it/s]4102it [00:17, 189.55it/s]4121it [00:17, 189.18it/s]4141it [00:17, 190.52it/s]4161it [00:17, 189.79it/s]4181it [00:18, 190.64it/s]4201it [00:18, 191.38it/s]4221it [00:18, 190.57it/s]4241it [00:18, 191.93it/s]4261it [00:18, 193.50it/s]4281it [00:18, 193.76it/s]4301it [00:18, 187.13it/s]4321it [00:18, 190.11it/s]4341it [00:18, 192.73it/s]4362it [00:18, 196.33it/s]4383it [00:19, 198.63it/s]4403it [00:19, 198.08it/s]4423it [00:19, 197.90it/s]4443it [00:19, 197.90it/s]4463it [00:19, 189.60it/s]4484it [00:19, 194.98it/s]4504it [00:19, 194.92it/s]4525it [00:19, 197.41it/s]4545it [00:19, 194.50it/s]4565it [00:19, 196.01it/s]4587it [00:20, 200.36it/s]4608it [00:20, 203.13it/s]4630it [00:20, 205.50it/s]4648it [00:20, 225.63it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:06,  1.26it/s]  1%|          | 2/236 [00:01<02:21,  1.65it/s]  1%|▏         | 3/236 [00:01<02:05,  1.86it/s]  2%|▏         | 4/236 [00:02<01:57,  1.97it/s]  2%|▏         | 5/236 [00:02<01:53,  2.03it/s]  3%|▎         | 6/236 [00:03<01:51,  2.07it/s]  3%|▎         | 7/236 [00:03<01:50,  2.08it/s]  3%|▎         | 8/236 [00:04<01:48,  2.10it/s]  4%|▍         | 9/236 [00:04<01:47,  2.12it/s]  4%|▍         | 10/236 [00:04<01:45,  2.13it/s]  5%|▍         | 11/236 [00:05<01:44,  2.14it/s]  5%|▌         | 12/236 [00:05<01:43,  2.16it/s]  6%|▌         | 13/236 [00:06<01:42,  2.17it/s]  6%|▌         | 14/236 [00:06<01:39,  2.22it/s]  6%|▋         | 15/236 [00:07<01:40,  2.21it/s]  7%|▋         | 16/236 [00:07<01:39,  2.21it/s]  7%|▋         | 17/236 [00:08<01:39,  2.20it/s]  8%|▊         | 18/236 [00:08<01:39,  2.19it/s]  8%|▊         | 19/236 [00:09<01:38,  2.20it/s]  8%|▊         | 20/236 [00:09<01:38,  2.18it/s]  9%|▉         | 21/236 [00:09<01:38,  2.18it/s]  9%|▉         | 22/236 [00:10<01:37,  2.19it/s] 10%|▉         | 23/236 [00:10<01:36,  2.20it/s] 10%|█         | 24/236 [00:11<01:36,  2.21it/s] 11%|█         | 25/236 [00:11<01:35,  2.21it/s] 11%|█         | 26/236 [00:12<01:34,  2.22it/s] 11%|█▏        | 27/236 [00:12<01:34,  2.21it/s] 12%|█▏        | 28/236 [00:13<01:33,  2.22it/s] 12%|█▏        | 29/236 [00:13<01:33,  2.23it/s] 13%|█▎        | 30/236 [00:14<01:33,  2.20it/s] 13%|█▎        | 31/236 [00:14<01:33,  2.19it/s] 14%|█▎        | 32/236 [00:14<01:32,  2.19it/s] 14%|█▍        | 33/236 [00:15<01:32,  2.20it/s] 14%|█▍        | 34/236 [00:15<01:31,  2.21it/s] 15%|█▍        | 35/236 [00:16<01:30,  2.21it/s] 15%|█▌        | 36/236 [00:16<01:30,  2.22it/s] 16%|█▌        | 37/236 [00:17<01:29,  2.22it/s] 16%|█▌        | 38/236 [00:17<01:29,  2.22it/s] 17%|█▋        | 39/236 [00:18<01:28,  2.22it/s] 17%|█▋        | 40/236 [00:18<01:28,  2.22it/s] 17%|█▋        | 41/236 [00:19<01:27,  2.22it/s] 18%|█▊        | 42/236 [00:19<01:27,  2.22it/s] 18%|█▊        | 43/236 [00:19<01:26,  2.22it/s] 19%|█▊        | 44/236 [00:20<01:26,  2.22it/s] 19%|█▉        | 45/236 [00:20<01:25,  2.23it/s] 19%|█▉        | 46/236 [00:21<01:25,  2.23it/s] 20%|█▉        | 47/236 [00:21<01:24,  2.23it/s] 20%|██        | 48/236 [00:22<01:24,  2.23it/s] 21%|██        | 49/236 [00:22<01:23,  2.24it/s] 21%|██        | 50/236 [00:23<01:23,  2.24it/s] 22%|██▏       | 51/236 [00:23<01:22,  2.24it/s] 22%|██▏       | 52/236 [00:23<01:22,  2.24it/s] 22%|██▏       | 53/236 [00:24<01:21,  2.24it/s] 23%|██▎       | 54/236 [00:24<01:21,  2.24it/s] 23%|██▎       | 55/236 [00:25<01:20,  2.24it/s] 24%|██▎       | 56/236 [00:25<01:20,  2.24it/s] 24%|██▍       | 57/236 [00:26<01:20,  2.24it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.22it/s] 25%|██▌       | 59/236 [00:27<01:20,  2.21it/s] 25%|██▌       | 60/236 [00:27<01:19,  2.23it/s] 26%|██▌       | 61/236 [00:27<01:18,  2.23it/s] 26%|██▋       | 62/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 63/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 64/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 65/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 66/236 [00:30<01:15,  2.24it/s] 28%|██▊       | 67/236 [00:30<01:15,  2.24it/s] 29%|██▉       | 68/236 [00:31<01:15,  2.24it/s] 29%|██▉       | 69/236 [00:31<01:12,  2.29it/s] 30%|██▉       | 70/236 [00:31<01:13,  2.27it/s] 30%|███       | 71/236 [00:32<01:12,  2.26it/s] 31%|███       | 72/236 [00:32<01:12,  2.26it/s] 31%|███       | 73/236 [00:33<01:12,  2.25it/s] 31%|███▏      | 74/236 [00:33<01:12,  2.24it/s] 32%|███▏      | 75/236 [00:34<01:11,  2.24it/s] 32%|███▏      | 76/236 [00:34<01:11,  2.24it/s] 33%|███▎      | 77/236 [00:35<01:10,  2.24it/s] 33%|███▎      | 78/236 [00:35<01:10,  2.24it/s] 33%|███▎      | 79/236 [00:35<01:10,  2.24it/s] 34%|███▍      | 80/236 [00:36<01:09,  2.24it/s] 34%|███▍      | 81/236 [00:36<01:09,  2.24it/s] 35%|███▍      | 82/236 [00:37<01:08,  2.24it/s] 35%|███▌      | 83/236 [00:37<01:08,  2.24it/s] 36%|███▌      | 84/236 [00:38<01:07,  2.24it/s] 36%|███▌      | 85/236 [00:38<01:07,  2.24it/s] 36%|███▋      | 86/236 [00:39<01:06,  2.24it/s] 37%|███▋      | 87/236 [00:39<01:05,  2.27it/s] 37%|███▋      | 88/236 [00:39<01:05,  2.25it/s] 38%|███▊      | 89/236 [00:40<01:06,  2.22it/s] 38%|███▊      | 90/236 [00:40<01:05,  2.22it/s] 39%|███▊      | 91/236 [00:41<01:05,  2.21it/s] 39%|███▉      | 92/236 [00:41<01:05,  2.21it/s] 39%|███▉      | 93/236 [00:42<01:04,  2.21it/s] 40%|███▉      | 94/236 [00:42<01:04,  2.22it/s] 40%|████      | 95/236 [00:43<01:03,  2.20it/s] 41%|████      | 96/236 [00:43<01:03,  2.20it/s] 41%|████      | 97/236 [00:44<01:03,  2.20it/s] 42%|████▏     | 98/236 [00:44<01:02,  2.21it/s] 42%|████▏     | 99/236 [00:44<01:02,  2.21it/s] 42%|████▏     | 100/236 [00:45<01:01,  2.21it/s] 43%|████▎     | 101/236 [00:45<01:01,  2.21it/s] 43%|████▎     | 102/236 [00:46<01:00,  2.21it/s] 44%|████▎     | 103/236 [00:46<01:00,  2.21it/s] 44%|████▍     | 104/236 [00:47<01:00,  2.19it/s] 44%|████▍     | 105/236 [00:47<00:58,  2.25it/s] 45%|████▍     | 106/236 [00:48<00:57,  2.25it/s] 45%|████▌     | 107/236 [00:48<00:57,  2.23it/s] 46%|████▌     | 108/236 [00:49<00:57,  2.22it/s] 46%|████▌     | 109/236 [00:49<00:57,  2.22it/s] 47%|████▋     | 110/236 [00:49<00:56,  2.23it/s] 47%|████▋     | 111/236 [00:50<00:56,  2.23it/s] 47%|████▋     | 112/236 [00:50<00:55,  2.23it/s] 48%|████▊     | 113/236 [00:51<00:55,  2.24it/s] 48%|████▊     | 114/236 [00:51<00:54,  2.24it/s] 49%|████▊     | 115/236 [00:52<00:54,  2.23it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.29it/s] 50%|████▉     | 117/236 [00:53<00:52,  2.27it/s] 50%|█████     | 118/236 [00:53<00:52,  2.26it/s] 50%|█████     | 119/236 [00:53<00:52,  2.25it/s] 51%|█████     | 120/236 [00:54<00:51,  2.25it/s] 51%|█████▏    | 121/236 [00:54<00:51,  2.24it/s] 52%|█████▏    | 122/236 [00:55<00:50,  2.24it/s] 52%|█████▏    | 123/236 [00:55<00:50,  2.24it/s] 53%|█████▎    | 124/236 [00:56<00:49,  2.24it/s] 53%|█████▎    | 125/236 [00:56<00:49,  2.24it/s] 53%|█████▎    | 126/236 [00:57<00:49,  2.24it/s] 54%|█████▍    | 127/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 128/236 [00:57<00:48,  2.22it/s] 55%|█████▍    | 129/236 [00:58<00:48,  2.21it/s] 55%|█████▌    | 130/236 [00:58<00:47,  2.21it/s] 56%|█████▌    | 131/236 [00:59<00:47,  2.22it/s] 56%|█████▌    | 132/236 [00:59<00:46,  2.22it/s] 56%|█████▋    | 133/236 [01:00<00:43,  2.37it/s] 57%|█████▋    | 134/236 [01:00<00:43,  2.33it/s] 57%|█████▋    | 135/236 [01:01<00:43,  2.30it/s] 58%|█████▊    | 136/236 [01:01<00:43,  2.28it/s] 58%|█████▊    | 137/236 [01:01<00:43,  2.27it/s] 58%|█████▊    | 138/236 [01:02<00:43,  2.26it/s] 59%|█████▉    | 139/236 [01:02<00:43,  2.25it/s] 59%|█████▉    | 140/236 [01:03<00:42,  2.25it/s] 60%|█████▉    | 141/236 [01:03<00:42,  2.24it/s] 60%|██████    | 142/236 [01:04<00:41,  2.24it/s] 61%|██████    | 143/236 [01:04<00:41,  2.24it/s] 61%|██████    | 144/236 [01:05<00:41,  2.24it/s] 61%|██████▏   | 145/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 146/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 147/236 [01:06<00:40,  2.22it/s] 63%|██████▎   | 148/236 [01:06<00:39,  2.22it/s] 63%|██████▎   | 149/236 [01:07<00:39,  2.23it/s] 64%|██████▎   | 150/236 [01:07<00:38,  2.22it/s] 64%|██████▍   | 151/236 [01:08<00:38,  2.22it/s] 64%|██████▍   | 152/236 [01:08<00:35,  2.38it/s] 65%|██████▍   | 153/236 [01:09<00:35,  2.32it/s] 65%|██████▌   | 154/236 [01:09<00:36,  2.27it/s] 66%|██████▌   | 155/236 [01:09<00:36,  2.24it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.22it/s] 67%|██████▋   | 157/236 [01:10<00:35,  2.22it/s] 67%|██████▋   | 158/236 [01:11<00:35,  2.20it/s] 67%|██████▋   | 159/236 [01:11<00:35,  2.18it/s] 68%|██████▊   | 160/236 [01:12<00:34,  2.19it/s] 68%|██████▊   | 161/236 [01:12<00:34,  2.20it/s] 69%|██████▊   | 162/236 [01:13<00:34,  2.18it/s] 69%|██████▉   | 163/236 [01:13<00:33,  2.16it/s] 69%|██████▉   | 164/236 [01:14<00:33,  2.17it/s] 70%|██████▉   | 165/236 [01:14<00:32,  2.17it/s] 70%|███████   | 166/236 [01:14<00:32,  2.18it/s] 71%|███████   | 167/236 [01:15<00:31,  2.18it/s] 71%|███████   | 168/236 [01:15<00:31,  2.18it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.19it/s] 72%|███████▏  | 170/236 [01:16<00:30,  2.20it/s] 72%|███████▏  | 171/236 [01:17<00:29,  2.20it/s] 73%|███████▎  | 172/236 [01:17<00:29,  2.20it/s] 73%|███████▎  | 173/236 [01:18<00:28,  2.20it/s] 74%|███████▎  | 174/236 [01:18<00:28,  2.19it/s] 74%|███████▍  | 175/236 [01:19<00:27,  2.18it/s] 75%|███████▍  | 176/236 [01:19<00:27,  2.16it/s] 75%|███████▌  | 177/236 [01:20<00:27,  2.17it/s] 75%|███████▌  | 178/236 [01:20<00:26,  2.16it/s] 76%|███████▌  | 179/236 [01:20<00:26,  2.17it/s] 76%|███████▋  | 180/236 [01:21<00:25,  2.19it/s] 77%|███████▋  | 181/236 [01:21<00:25,  2.20it/s] 77%|███████▋  | 182/236 [01:22<00:25,  2.14it/s] 78%|███████▊  | 183/236 [01:22<00:25,  2.10it/s] 78%|███████▊  | 184/236 [01:23<00:24,  2.13it/s] 78%|███████▊  | 185/236 [01:23<00:23,  2.15it/s] 79%|███████▉  | 186/236 [01:24<00:23,  2.17it/s] 79%|███████▉  | 187/236 [01:24<00:22,  2.18it/s] 80%|███████▉  | 188/236 [01:25<00:21,  2.20it/s] 80%|████████  | 189/236 [01:25<00:21,  2.21it/s] 81%|████████  | 190/236 [01:26<00:20,  2.19it/s] 81%|████████  | 191/236 [01:26<00:20,  2.18it/s] 81%|████████▏ | 192/236 [01:26<00:20,  2.18it/s] 82%|████████▏ | 193/236 [01:27<00:19,  2.18it/s] 82%|████████▏ | 194/236 [01:27<00:19,  2.19it/s] 83%|████████▎ | 195/236 [01:28<00:18,  2.19it/s] 83%|████████▎ | 196/236 [01:28<00:18,  2.19it/s] 83%|████████▎ | 197/236 [01:29<00:17,  2.19it/s] 84%|████████▍ | 198/236 [01:29<00:17,  2.18it/s] 84%|████████▍ | 199/236 [01:30<00:16,  2.19it/s] 85%|████████▍ | 200/236 [01:30<00:16,  2.20it/s] 85%|████████▌ | 201/236 [01:30<00:15,  2.26it/s] 86%|████████▌ | 202/236 [01:31<00:15,  2.25it/s] 86%|████████▌ | 203/236 [01:31<00:14,  2.24it/s] 86%|████████▋ | 204/236 [01:32<00:14,  2.22it/s] 87%|████████▋ | 205/236 [01:32<00:14,  2.20it/s] 87%|████████▋ | 206/236 [01:33<00:13,  2.20it/s] 88%|████████▊ | 207/236 [01:33<00:13,  2.20it/s] 88%|████████▊ | 208/236 [01:34<00:12,  2.20it/s] 89%|████████▊ | 209/236 [01:34<00:12,  2.19it/s] 89%|████████▉ | 210/236 [01:34<00:11,  2.34it/s] 89%|████████▉ | 211/236 [01:35<00:10,  2.28it/s] 90%|████████▉ | 212/236 [01:35<00:09,  2.41it/s] 90%|█████████ | 213/236 [01:36<00:09,  2.32it/s] 91%|█████████ | 214/236 [01:36<00:09,  2.27it/s] 91%|█████████ | 215/236 [01:37<00:09,  2.24it/s] 92%|█████████▏| 216/236 [01:37<00:08,  2.22it/s] 92%|█████████▏| 217/236 [01:38<00:08,  2.21it/s] 92%|█████████▏| 218/236 [01:38<00:08,  2.20it/s] 93%|█████████▎| 219/236 [01:39<00:07,  2.19it/s] 93%|█████████▎| 220/236 [01:39<00:07,  2.18it/s] 94%|█████████▎| 221/236 [01:39<00:06,  2.19it/s] 94%|█████████▍| 222/236 [01:40<00:06,  2.21it/s] 94%|█████████▍| 223/236 [01:40<00:05,  2.21it/s] 95%|█████████▍| 224/236 [01:41<00:05,  2.22it/s] 95%|█████████▌| 225/236 [01:41<00:04,  2.21it/s] 96%|█████████▌| 226/236 [01:42<00:04,  2.15it/s] 96%|█████████▌| 227/236 [01:42<00:04,  2.15it/s] 97%|█████████▋| 228/236 [01:43<00:03,  2.17it/s] 97%|█████████▋| 229/236 [01:43<00:03,  2.19it/s] 97%|█████████▋| 230/236 [01:44<00:02,  2.20it/s] 98%|█████████▊| 231/236 [01:44<00:02,  2.19it/s] 98%|█████████▊| 232/236 [01:44<00:01,  2.19it/s] 99%|█████████▊| 233/236 [01:45<00:01,  2.20it/s] 99%|█████████▉| 234/236 [01:45<00:00,  2.21it/s]100%|█████████▉| 235/236 [01:46<00:00,  2.22it/s]100%|██████████| 236/236 [01:46<00:00,  2.24it/s]100%|██████████| 236/236 [01:46<00:00,  2.21it/s]The average generation time of a batch motion (bs=32) is 0.446219 seconds

0it [00:00, ?it/s]13it [00:00, 126.30it/s]43it [00:00, 220.09it/s]76it [00:00, 268.82it/s]108it [00:00, 285.38it/s]137it [00:00, 284.58it/s]168it [00:00, 290.60it/s]201it [00:00, 300.77it/s]236it [00:00, 313.94it/s]269it [00:00, 316.71it/s]301it [00:01, 310.00it/s]333it [00:01, 308.31it/s]364it [00:01, 302.75it/s]395it [00:01, 298.09it/s]425it [00:01, 292.63it/s]457it [00:01, 300.02it/s]493it [00:01, 316.17it/s]534it [00:01, 342.16it/s]577it [00:01, 367.15it/s]615it [00:01, 370.71it/s]653it [00:02, 366.18it/s]691it [00:02, 368.67it/s]728it [00:02, 359.29it/s]765it [00:02, 352.62it/s]804it [00:02, 361.76it/s]843it [00:02, 369.58it/s]882it [00:02, 372.64it/s]920it [00:02, 367.42it/s]957it [00:02, 341.81it/s]992it [00:03, 341.36it/s]1027it [00:03, 336.74it/s]1061it [00:03, 329.47it/s]1095it [00:03, 329.35it/s]1129it [00:03, 304.54it/s]1160it [00:03, 280.33it/s]1189it [00:03, 253.09it/s]1215it [00:03, 243.69it/s]1240it [00:04, 231.24it/s]1264it [00:04, 231.19it/s]1288it [00:04, 231.72it/s]1312it [00:04, 226.00it/s]1335it [00:04, 224.49it/s]1358it [00:04, 222.58it/s]1383it [00:04, 230.16it/s]1415it [00:04, 255.03it/s]1443it [00:04, 260.84it/s]1473it [00:04, 271.21it/s]1504it [00:05, 282.32it/s]1535it [00:05, 289.83it/s]1567it [00:05, 298.18it/s]1602it [00:05, 312.16it/s]1640it [00:05, 331.72it/s]1677it [00:05, 342.17it/s]1715it [00:05, 351.03it/s]1752it [00:05, 354.16it/s]1788it [00:05, 348.00it/s]1823it [00:05, 343.60it/s]1858it [00:06, 342.78it/s]1893it [00:06, 333.92it/s]1927it [00:06, 310.56it/s]1959it [00:06, 308.43it/s]1993it [00:06, 314.31it/s]2025it [00:06, 230.63it/s]2052it [00:06, 236.02it/s]2078it [00:06, 239.16it/s]2107it [00:07, 250.86it/s]2148it [00:07, 292.00it/s]2191it [00:07, 328.57it/s]2234it [00:07, 355.54it/s]2275it [00:07, 368.74it/s]2317it [00:07, 380.89it/s]2356it [00:07, 382.90it/s]2395it [00:07, 376.00it/s]2436it [00:07, 385.60it/s]2479it [00:07, 396.87it/s]2519it [00:08, 383.88it/s]2558it [00:08, 382.35it/s]2600it [00:08, 391.58it/s]2640it [00:08, 385.89it/s]2680it [00:08, 388.83it/s]2720it [00:08, 390.93it/s]2762it [00:08, 397.43it/s]2802it [00:08, 396.16it/s]2842it [00:08, 382.09it/s]2882it [00:09, 385.00it/s]2923it [00:09, 391.14it/s]2963it [00:09, 386.63it/s]3002it [00:09, 374.17it/s]3040it [00:09, 368.68it/s]3083it [00:09, 384.90it/s]3125it [00:09, 392.33it/s]3165it [00:09, 372.24it/s]3203it [00:09, 361.78it/s]3240it [00:09, 361.69it/s]3279it [00:10, 368.03it/s]3316it [00:10, 368.14it/s]3353it [00:10, 364.31it/s]3390it [00:10, 364.26it/s]3427it [00:10, 362.62it/s]3465it [00:10, 364.92it/s]3506it [00:10, 376.92it/s]3547it [00:10, 385.71it/s]3586it [00:10, 370.87it/s]3624it [00:11, 326.32it/s]3663it [00:11, 338.66it/s]3699it [00:11, 343.53it/s]3734it [00:11, 165.70it/s]3761it [00:11, 179.68it/s]3788it [00:11, 194.99it/s]3823it [00:12, 226.44it/s]3863it [00:12, 265.18it/s]3902it [00:12, 294.28it/s]3939it [00:12, 312.92it/s]3979it [00:12, 333.32it/s]4016it [00:12, 341.80it/s]4055it [00:12, 355.35it/s]4093it [00:12, 360.45it/s]4131it [00:12, 360.45it/s]4168it [00:12, 358.84it/s]4208it [00:13, 366.94it/s]4246it [00:13, 366.39it/s]4283it [00:13, 363.92it/s]4320it [00:13, 363.45it/s]4359it [00:13, 368.96it/s]4399it [00:13, 375.35it/s]4437it [00:13, 376.24it/s]4477it [00:13, 381.54it/s]4517it [00:13, 386.80it/s]4558it [00:14, 391.50it/s]4599it [00:14, 395.78it/s]4640it [00:14, 398.83it/s]4648it [00:14, 320.32it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.8701
---> [text2motion] R_precision: (top 1): 0.5256 (top 2): 0.7297 (top 3): 0.8224 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.4112
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.7069
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.5025
!!! DONE !!!
================================================================================

模型: 5_h_024787_iters
评估时间: 2025年 07月 28日 星期一 13:07:04 CST
----------------------------------------
评估成功，用时: 182 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 286/4384 [00:00<00:01, 2853.28it/s] 13%|█▎        | 572/4384 [00:00<00:01, 2459.17it/s] 19%|█▉        | 822/4384 [00:00<00:02, 1278.62it/s] 23%|██▎       | 1018/4384 [00:00<00:02, 1438.57it/s] 27%|██▋       | 1203/4384 [00:00<00:02, 1540.73it/s] 32%|███▏      | 1392/4384 [00:00<00:01, 1632.06it/s] 36%|███▌      | 1581/4384 [00:00<00:01, 1702.47it/s] 41%|████      | 1776/4384 [00:01<00:01, 1770.59it/s] 45%|████▍     | 1965/4384 [00:01<00:01, 1801.50it/s] 49%|████▉     | 2154/4384 [00:01<00:01, 1809.84it/s] 54%|█████▎    | 2346/4384 [00:01<00:01, 1841.87it/s] 58%|█████▊    | 2536/4384 [00:01<00:00, 1856.79it/s] 62%|██████▏   | 2725/4384 [00:01<00:00, 1864.49it/s] 66%|██████▋   | 2914/4384 [00:01<00:00, 1868.15it/s] 71%|███████   | 3103/4384 [00:01<00:00, 1833.90it/s] 75%|███████▌  | 3300/4384 [00:01<00:00, 1873.32it/s] 80%|███████▉  | 3489/4384 [00:01<00:00, 1870.27it/s] 84%|████████▍ | 3677/4384 [00:02<00:00, 1871.58it/s] 88%|████████▊ | 3872/4384 [00:02<00:00, 1892.87it/s] 93%|█████████▎| 4062/4384 [00:02<00:00, 1888.17it/s] 97%|█████████▋| 4253/4384 [00:02<00:00, 1892.10it/s]100%|██████████| 4384/4384 [00:02<00:00, 1797.15it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▌         | 230/4384 [00:00<00:01, 2298.74it/s] 10%|█         | 460/4384 [00:00<00:01, 2076.71it/s] 15%|█▌        | 670/4384 [00:00<00:01, 2003.75it/s] 20%|█▉        | 872/4384 [00:00<00:01, 1978.58it/s] 24%|██▍       | 1072/4384 [00:00<00:01, 1985.43it/s] 29%|██▉       | 1271/4384 [00:00<00:01, 1930.80it/s] 33%|███▎      | 1465/4384 [00:00<00:01, 1905.65it/s] 38%|███▊      | 1661/4384 [00:00<00:01, 1919.12it/s] 42%|████▏     | 1854/4384 [00:00<00:01, 1904.48it/s] 47%|████▋     | 2045/4384 [00:01<00:01, 1898.56it/s] 51%|█████     | 2235/4384 [00:01<00:01, 1882.00it/s] 55%|█████▌    | 2430/4384 [00:01<00:01, 1899.52it/s] 60%|█████▉    | 2623/4384 [00:01<00:00, 1907.87it/s] 64%|██████▍   | 2814/4384 [00:01<00:00, 1871.58it/s] 69%|██████▊   | 3005/4384 [00:01<00:00, 1882.61it/s] 73%|███████▎  | 3203/4384 [00:01<00:00, 1909.34it/s] 77%|███████▋  | 3395/4384 [00:01<00:00, 1893.80it/s] 82%|████████▏ | 3585/4384 [00:01<00:00, 1890.35it/s] 86%|████████▌ | 3775/4384 [00:02<00:00, 1667.41it/s] 91%|█████████ | 3968/4384 [00:02<00:00, 1737.02it/s] 95%|█████████▍| 4157/4384 [00:02<00:00, 1777.88it/s] 99%|█████████▉| 4343/4384 [00:02<00:00, 1800.81it/s]100%|██████████| 4384/4384 [00:02<00:00, 1878.68it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/5_h_024787_iters.tar with 24787 iterations
Time: 2025-07-28 13:07:32.131243

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]30it [00:00, 299.73it/s]78it [00:00, 404.56it/s]119it [00:00, 391.27it/s]167it [00:00, 422.04it/s]210it [00:00, 406.48it/s]258it [00:00, 428.20it/s]306it [00:00, 443.76it/s]354it [00:00, 453.93it/s]400it [00:00, 428.91it/s]447it [00:01, 438.52it/s]492it [00:01, 437.12it/s]541it [00:01, 450.73it/s]590it [00:01, 460.09it/s]638it [00:01, 463.86it/s]685it [00:01, 463.81it/s]733it [00:01, 466.41it/s]781it [00:01, 447.37it/s]826it [00:01, 354.21it/s]865it [00:02, 306.56it/s]899it [00:02, 284.90it/s]930it [00:02, 264.04it/s]958it [00:02, 250.66it/s]984it [00:02, 240.03it/s]1009it [00:02, 234.45it/s]1033it [00:02, 230.51it/s]1057it [00:03, 225.85it/s]1080it [00:03, 222.77it/s]1103it [00:03, 220.38it/s]1126it [00:03, 218.89it/s]1148it [00:03, 218.82it/s]1170it [00:03, 218.36it/s]1192it [00:03, 218.08it/s]1214it [00:03, 217.43it/s]1236it [00:03, 214.90it/s]1258it [00:03, 214.78it/s]1280it [00:04, 213.06it/s]1302it [00:04, 214.09it/s]1324it [00:04, 213.26it/s]1346it [00:04, 214.09it/s]1368it [00:04, 213.74it/s]1390it [00:04, 212.48it/s]1412it [00:04, 213.55it/s]1434it [00:04, 213.77it/s]1456it [00:04, 213.69it/s]1478it [00:04, 213.90it/s]1500it [00:05, 213.47it/s]1522it [00:05, 212.94it/s]1544it [00:05, 213.65it/s]1566it [00:05, 214.39it/s]1588it [00:05, 207.80it/s]1609it [00:05, 206.66it/s]1630it [00:05, 199.04it/s]1650it [00:05, 192.78it/s]1670it [00:05, 194.72it/s]1693it [00:06, 203.05it/s]1716it [00:06, 209.27it/s]1739it [00:06, 213.45it/s]1762it [00:06, 216.32it/s]1784it [00:06, 216.75it/s]1806it [00:06, 216.66it/s]1828it [00:06, 216.97it/s]1850it [00:06, 217.19it/s]1873it [00:06, 218.44it/s]1895it [00:06, 218.74it/s]1918it [00:07, 219.27it/s]1940it [00:07, 219.37it/s]1963it [00:07, 219.70it/s]1985it [00:07, 219.55it/s]2007it [00:07, 219.48it/s]2029it [00:07, 219.12it/s]2051it [00:07, 219.22it/s]2074it [00:07, 219.76it/s]2097it [00:07, 220.88it/s]2120it [00:07, 220.49it/s]2143it [00:08, 220.51it/s]2166it [00:08, 221.70it/s]2189it [00:08, 221.39it/s]2212it [00:08, 219.46it/s]2234it [00:08, 218.11it/s]2256it [00:08, 214.93it/s]2278it [00:08, 215.68it/s]2300it [00:08, 216.07it/s]2322it [00:08, 216.38it/s]2344it [00:09, 207.49it/s]2367it [00:09, 211.53it/s]2393it [00:09, 224.76it/s]2437it [00:09, 286.71it/s]2485it [00:09, 342.14it/s]2529it [00:09, 369.84it/s]2567it [00:09, 371.69it/s]2606it [00:09, 374.26it/s]2645it [00:09, 377.37it/s]2684it [00:09, 380.69it/s]2723it [00:10, 371.62it/s]2761it [00:10, 371.18it/s]2800it [00:10, 374.53it/s]2838it [00:10, 375.02it/s]2876it [00:10, 316.77it/s]2910it [00:10, 272.25it/s]2940it [00:10, 249.89it/s]2967it [00:10, 239.68it/s]2992it [00:11, 232.37it/s]3016it [00:11, 227.54it/s]3040it [00:11, 224.68it/s]3063it [00:11, 221.85it/s]3086it [00:11, 222.53it/s]3112it [00:11, 231.18it/s]3138it [00:11, 238.01it/s]3186it [00:11, 306.72it/s]3232it [00:11, 349.65it/s]3268it [00:12, 341.93it/s]3303it [00:12, 316.45it/s]3343it [00:12, 338.64it/s]3378it [00:12, 213.59it/s]3422it [00:12, 258.65it/s]3469it [00:12, 304.33it/s]3513it [00:12, 335.48it/s]3559it [00:12, 366.50it/s]3604it [00:13, 388.49it/s]3649it [00:13, 403.09it/s]3694it [00:13, 416.11it/s]3739it [00:13, 424.44it/s]3785it [00:13, 432.20it/s]3830it [00:13, 435.95it/s]3875it [00:13, 435.09it/s]3920it [00:13, 438.94it/s]3965it [00:13, 439.07it/s]4010it [00:14, 439.99it/s]4055it [00:14, 438.70it/s]4100it [00:14, 441.37it/s]4145it [00:14, 438.35it/s]4189it [00:14, 435.75it/s]4233it [00:14, 432.87it/s]4277it [00:14, 426.92it/s]4320it [00:14, 426.48it/s]4363it [00:14, 422.82it/s]4406it [00:14, 420.06it/s]4449it [00:15, 418.88it/s]4492it [00:15, 420.19it/s]4535it [00:15, 422.58it/s]4582it [00:15, 436.42it/s]4628it [00:15, 442.81it/s]4648it [00:15, 297.20it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:00,  1.30it/s]  1%|          | 2/236 [00:01<02:16,  1.72it/s]  1%|▏         | 3/236 [00:01<02:01,  1.91it/s]  2%|▏         | 4/236 [00:02<01:54,  2.02it/s]  2%|▏         | 5/236 [00:02<01:51,  2.08it/s]  3%|▎         | 6/236 [00:03<01:48,  2.12it/s]  3%|▎         | 7/236 [00:03<01:46,  2.15it/s]  3%|▎         | 8/236 [00:03<01:45,  2.17it/s]  4%|▍         | 9/236 [00:04<01:44,  2.18it/s]  4%|▍         | 10/236 [00:04<01:43,  2.19it/s]  5%|▍         | 11/236 [00:05<01:42,  2.19it/s]  5%|▌         | 12/236 [00:05<01:41,  2.20it/s]  6%|▌         | 13/236 [00:06<01:40,  2.22it/s]  6%|▌         | 14/236 [00:06<01:38,  2.26it/s]  6%|▋         | 15/236 [00:07<01:38,  2.24it/s]  7%|▋         | 16/236 [00:07<01:38,  2.23it/s]  7%|▋         | 17/236 [00:07<01:38,  2.22it/s]  8%|▊         | 18/236 [00:08<01:38,  2.21it/s]  8%|▊         | 19/236 [00:08<01:38,  2.21it/s]  8%|▊         | 20/236 [00:09<01:38,  2.20it/s]  9%|▉         | 21/236 [00:09<01:38,  2.19it/s]  9%|▉         | 22/236 [00:10<01:37,  2.19it/s] 10%|▉         | 23/236 [00:10<01:38,  2.16it/s] 10%|█         | 24/236 [00:11<01:37,  2.17it/s] 11%|█         | 25/236 [00:11<01:36,  2.18it/s] 11%|█         | 26/236 [00:12<01:35,  2.19it/s] 11%|█▏        | 27/236 [00:12<01:35,  2.20it/s] 12%|█▏        | 28/236 [00:13<01:34,  2.20it/s] 12%|█▏        | 29/236 [00:13<01:34,  2.20it/s] 13%|█▎        | 30/236 [00:13<01:33,  2.20it/s] 13%|█▎        | 31/236 [00:14<01:33,  2.20it/s] 14%|█▎        | 32/236 [00:14<01:32,  2.20it/s] 14%|█▍        | 33/236 [00:15<01:32,  2.20it/s] 14%|█▍        | 34/236 [00:15<01:31,  2.20it/s] 15%|█▍        | 35/236 [00:16<01:31,  2.20it/s] 15%|█▌        | 36/236 [00:16<01:30,  2.20it/s] 16%|█▌        | 37/236 [00:17<01:30,  2.20it/s] 16%|█▌        | 38/236 [00:17<01:29,  2.20it/s] 17%|█▋        | 39/236 [00:18<01:29,  2.20it/s] 17%|█▋        | 40/236 [00:18<01:29,  2.20it/s] 17%|█▋        | 41/236 [00:18<01:28,  2.20it/s] 18%|█▊        | 42/236 [00:19<01:28,  2.20it/s] 18%|█▊        | 43/236 [00:19<01:27,  2.20it/s] 19%|█▊        | 44/236 [00:20<01:27,  2.20it/s] 19%|█▉        | 45/236 [00:20<01:26,  2.20it/s] 19%|█▉        | 46/236 [00:21<01:26,  2.20it/s] 20%|█▉        | 47/236 [00:21<01:25,  2.20it/s] 20%|██        | 48/236 [00:22<01:25,  2.20it/s] 21%|██        | 49/236 [00:22<01:24,  2.20it/s] 21%|██        | 50/236 [00:23<01:24,  2.21it/s] 22%|██▏       | 51/236 [00:23<01:23,  2.21it/s] 22%|██▏       | 52/236 [00:23<01:23,  2.21it/s] 22%|██▏       | 53/236 [00:24<01:22,  2.21it/s] 23%|██▎       | 54/236 [00:24<01:22,  2.21it/s] 23%|██▎       | 55/236 [00:25<01:22,  2.19it/s] 24%|██▎       | 56/236 [00:25<01:22,  2.19it/s] 24%|██▍       | 57/236 [00:26<01:21,  2.20it/s] 25%|██▍       | 58/236 [00:26<01:21,  2.20it/s] 25%|██▌       | 59/236 [00:27<01:20,  2.20it/s] 25%|██▌       | 60/236 [00:27<01:19,  2.20it/s] 26%|██▌       | 61/236 [00:28<01:19,  2.20it/s] 26%|██▋       | 62/236 [00:28<01:18,  2.21it/s] 27%|██▋       | 63/236 [00:28<01:18,  2.21it/s] 27%|██▋       | 64/236 [00:29<01:17,  2.21it/s] 28%|██▊       | 65/236 [00:29<01:17,  2.20it/s] 28%|██▊       | 66/236 [00:30<01:17,  2.20it/s] 28%|██▊       | 67/236 [00:30<01:16,  2.20it/s] 29%|██▉       | 68/236 [00:31<01:16,  2.20it/s] 29%|██▉       | 69/236 [00:31<01:14,  2.25it/s] 30%|██▉       | 70/236 [00:32<01:14,  2.24it/s] 30%|███       | 71/236 [00:32<01:14,  2.23it/s] 31%|███       | 72/236 [00:32<01:13,  2.22it/s] 31%|███       | 73/236 [00:33<01:13,  2.22it/s] 31%|███▏      | 74/236 [00:33<01:13,  2.21it/s] 32%|███▏      | 75/236 [00:34<01:12,  2.21it/s] 32%|███▏      | 76/236 [00:34<01:12,  2.21it/s] 33%|███▎      | 77/236 [00:35<01:11,  2.21it/s] 33%|███▎      | 78/236 [00:35<01:11,  2.21it/s] 33%|███▎      | 79/236 [00:36<01:11,  2.21it/s] 34%|███▍      | 80/236 [00:36<01:10,  2.21it/s] 34%|███▍      | 81/236 [00:37<01:10,  2.21it/s] 35%|███▍      | 82/236 [00:37<01:11,  2.17it/s] 35%|███▌      | 83/236 [00:37<01:10,  2.18it/s] 36%|███▌      | 84/236 [00:38<01:09,  2.19it/s] 36%|███▌      | 85/236 [00:38<01:08,  2.19it/s] 36%|███▋      | 86/236 [00:39<01:08,  2.20it/s] 37%|███▋      | 87/236 [00:39<01:06,  2.25it/s] 37%|███▋      | 88/236 [00:40<01:06,  2.24it/s] 38%|███▊      | 89/236 [00:40<01:05,  2.23it/s] 38%|███▊      | 90/236 [00:41<01:05,  2.22it/s] 39%|███▊      | 91/236 [00:41<01:05,  2.22it/s] 39%|███▉      | 92/236 [00:42<01:05,  2.21it/s] 39%|███▉      | 93/236 [00:42<01:04,  2.21it/s] 40%|███▉      | 94/236 [00:42<01:04,  2.21it/s] 40%|████      | 95/236 [00:43<01:03,  2.21it/s] 41%|████      | 96/236 [00:43<01:03,  2.21it/s] 41%|████      | 97/236 [00:44<01:03,  2.20it/s] 42%|████▏     | 98/236 [00:44<01:02,  2.21it/s] 42%|████▏     | 99/236 [00:45<01:02,  2.21it/s] 42%|████▏     | 100/236 [00:45<01:01,  2.21it/s] 43%|████▎     | 101/236 [00:46<01:01,  2.21it/s] 43%|████▎     | 102/236 [00:46<01:00,  2.20it/s] 44%|████▎     | 103/236 [00:47<01:00,  2.21it/s] 44%|████▍     | 104/236 [00:47<00:59,  2.20it/s] 44%|████▍     | 105/236 [00:47<00:58,  2.26it/s] 45%|████▍     | 106/236 [00:48<00:57,  2.27it/s] 45%|████▌     | 107/236 [00:48<00:57,  2.25it/s] 46%|████▌     | 108/236 [00:49<00:57,  2.24it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.23it/s] 47%|████▋     | 110/236 [00:50<00:56,  2.22it/s] 47%|████▋     | 111/236 [00:50<00:56,  2.22it/s] 47%|████▋     | 112/236 [00:51<00:55,  2.21it/s] 48%|████▊     | 113/236 [00:51<00:55,  2.21it/s] 48%|████▊     | 114/236 [00:51<00:55,  2.21it/s] 49%|████▊     | 115/236 [00:52<00:55,  2.19it/s] 49%|████▉     | 116/236 [00:52<00:53,  2.24it/s] 50%|████▉     | 117/236 [00:53<00:53,  2.23it/s] 50%|█████     | 118/236 [00:53<00:53,  2.22it/s] 50%|█████     | 119/236 [00:54<00:52,  2.21it/s] 51%|█████     | 120/236 [00:54<00:52,  2.21it/s] 51%|█████▏    | 121/236 [00:55<00:52,  2.21it/s] 52%|█████▏    | 122/236 [00:55<00:51,  2.21it/s] 52%|█████▏    | 123/236 [00:56<00:51,  2.21it/s] 53%|█████▎    | 124/236 [00:56<00:50,  2.21it/s] 53%|█████▎    | 125/236 [00:56<00:50,  2.21it/s] 53%|█████▎    | 126/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 127/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 128/236 [00:58<00:48,  2.21it/s] 55%|█████▍    | 129/236 [00:58<00:48,  2.21it/s] 55%|█████▌    | 130/236 [00:59<00:48,  2.21it/s] 56%|█████▌    | 131/236 [00:59<00:47,  2.21it/s] 56%|█████▌    | 132/236 [01:00<00:47,  2.21it/s] 56%|█████▋    | 133/236 [01:00<00:43,  2.35it/s] 57%|█████▋    | 134/236 [01:00<00:44,  2.30it/s] 57%|█████▋    | 135/236 [01:01<00:44,  2.27it/s] 58%|█████▊    | 136/236 [01:01<00:44,  2.25it/s] 58%|█████▊    | 137/236 [01:02<00:44,  2.24it/s] 58%|█████▊    | 138/236 [01:02<00:43,  2.23it/s] 59%|█████▉    | 139/236 [01:03<00:43,  2.22it/s] 59%|█████▉    | 140/236 [01:03<00:43,  2.22it/s] 60%|█████▉    | 141/236 [01:04<00:42,  2.21it/s] 60%|██████    | 142/236 [01:04<00:42,  2.21it/s] 61%|██████    | 143/236 [01:04<00:42,  2.21it/s] 61%|██████    | 144/236 [01:05<00:41,  2.21it/s] 61%|██████▏   | 145/236 [01:05<00:41,  2.21it/s] 62%|██████▏   | 146/236 [01:06<00:40,  2.21it/s] 62%|██████▏   | 147/236 [01:06<00:40,  2.21it/s] 63%|██████▎   | 148/236 [01:07<00:39,  2.21it/s] 63%|██████▎   | 149/236 [01:07<00:39,  2.21it/s] 64%|██████▎   | 150/236 [01:08<00:38,  2.21it/s] 64%|██████▍   | 151/236 [01:08<00:38,  2.21it/s] 64%|██████▍   | 152/236 [01:08<00:35,  2.36it/s] 65%|██████▍   | 153/236 [01:09<00:35,  2.31it/s] 65%|██████▌   | 154/236 [01:09<00:36,  2.28it/s] 66%|██████▌   | 155/236 [01:10<00:35,  2.26it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.24it/s] 67%|██████▋   | 157/236 [01:11<00:35,  2.23it/s] 67%|██████▋   | 158/236 [01:11<00:35,  2.22it/s] 67%|██████▋   | 159/236 [01:12<00:34,  2.22it/s] 68%|██████▊   | 160/236 [01:12<00:34,  2.21it/s] 68%|██████▊   | 161/236 [01:13<00:33,  2.21it/s] 69%|██████▊   | 162/236 [01:13<00:33,  2.21it/s] 69%|██████▉   | 163/236 [01:13<00:33,  2.21it/s] 69%|██████▉   | 164/236 [01:14<00:32,  2.20it/s] 70%|██████▉   | 165/236 [01:14<00:32,  2.20it/s] 70%|███████   | 166/236 [01:15<00:31,  2.20it/s] 71%|███████   | 167/236 [01:15<00:31,  2.20it/s] 71%|███████   | 168/236 [01:16<00:30,  2.20it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.20it/s] 72%|███████▏  | 170/236 [01:17<00:29,  2.20it/s] 72%|███████▏  | 171/236 [01:17<00:29,  2.20it/s] 73%|███████▎  | 172/236 [01:18<00:29,  2.20it/s] 73%|███████▎  | 173/236 [01:18<00:28,  2.20it/s] 74%|███████▎  | 174/236 [01:18<00:28,  2.20it/s] 74%|███████▍  | 175/236 [01:19<00:27,  2.20it/s] 75%|███████▍  | 176/236 [01:19<00:27,  2.20it/s] 75%|███████▌  | 177/236 [01:20<00:26,  2.20it/s] 75%|███████▌  | 178/236 [01:20<00:26,  2.20it/s] 76%|███████▌  | 179/236 [01:21<00:25,  2.21it/s] 76%|███████▋  | 180/236 [01:21<00:25,  2.21it/s] 77%|███████▋  | 181/236 [01:22<00:24,  2.21it/s] 77%|███████▋  | 182/236 [01:22<00:24,  2.20it/s] 78%|███████▊  | 183/236 [01:23<00:24,  2.20it/s] 78%|███████▊  | 184/236 [01:23<00:23,  2.20it/s] 78%|███████▊  | 185/236 [01:23<00:23,  2.20it/s] 79%|███████▉  | 186/236 [01:24<00:22,  2.20it/s] 79%|███████▉  | 187/236 [01:24<00:22,  2.20it/s] 80%|███████▉  | 188/236 [01:25<00:21,  2.20it/s] 80%|████████  | 189/236 [01:25<00:21,  2.20it/s] 81%|████████  | 190/236 [01:26<00:20,  2.20it/s] 81%|████████  | 191/236 [01:26<00:20,  2.21it/s] 81%|████████▏ | 192/236 [01:27<00:19,  2.21it/s] 82%|████████▏ | 193/236 [01:27<00:19,  2.21it/s] 82%|████████▏ | 194/236 [01:28<00:19,  2.21it/s] 83%|████████▎ | 195/236 [01:28<00:18,  2.21it/s] 83%|████████▎ | 196/236 [01:28<00:18,  2.21it/s] 83%|████████▎ | 197/236 [01:29<00:17,  2.21it/s] 84%|████████▍ | 198/236 [01:29<00:17,  2.21it/s] 84%|████████▍ | 199/236 [01:30<00:16,  2.21it/s] 85%|████████▍ | 200/236 [01:30<00:16,  2.20it/s] 85%|████████▌ | 201/236 [01:31<00:15,  2.26it/s] 86%|████████▌ | 202/236 [01:31<00:15,  2.25it/s] 86%|████████▌ | 203/236 [01:32<00:14,  2.23it/s] 86%|████████▋ | 204/236 [01:32<00:14,  2.23it/s] 87%|████████▋ | 205/236 [01:32<00:13,  2.22it/s] 87%|████████▋ | 206/236 [01:33<00:13,  2.21it/s] 88%|████████▊ | 207/236 [01:33<00:13,  2.18it/s] 88%|████████▊ | 208/236 [01:34<00:12,  2.19it/s] 89%|████████▊ | 209/236 [01:34<00:12,  2.19it/s] 89%|████████▉ | 210/236 [01:35<00:10,  2.37it/s] 89%|████████▉ | 211/236 [01:35<00:10,  2.32it/s] 90%|████████▉ | 212/236 [01:35<00:09,  2.47it/s] 90%|█████████ | 213/236 [01:36<00:09,  2.39it/s] 91%|█████████ | 214/236 [01:36<00:09,  2.33it/s] 91%|█████████ | 215/236 [01:37<00:09,  2.29it/s] 92%|█████████▏| 216/236 [01:37<00:08,  2.27it/s] 92%|█████████▏| 217/236 [01:38<00:08,  2.26it/s] 92%|█████████▏| 218/236 [01:38<00:08,  2.25it/s] 93%|█████████▎| 219/236 [01:39<00:07,  2.24it/s] 93%|█████████▎| 220/236 [01:39<00:07,  2.23it/s] 94%|█████████▎| 221/236 [01:39<00:06,  2.22it/s] 94%|█████████▍| 222/236 [01:40<00:06,  2.22it/s] 94%|█████████▍| 223/236 [01:40<00:05,  2.22it/s] 95%|█████████▍| 224/236 [01:41<00:05,  2.22it/s] 95%|█████████▌| 225/236 [01:41<00:04,  2.22it/s] 96%|█████████▌| 226/236 [01:42<00:04,  2.22it/s] 96%|█████████▌| 227/236 [01:42<00:04,  2.22it/s] 97%|█████████▋| 228/236 [01:43<00:03,  2.22it/s] 97%|█████████▋| 229/236 [01:43<00:03,  2.22it/s] 97%|█████████▋| 230/236 [01:44<00:02,  2.22it/s] 98%|█████████▊| 231/236 [01:44<00:02,  2.22it/s] 98%|█████████▊| 232/236 [01:44<00:01,  2.22it/s] 99%|█████████▊| 233/236 [01:45<00:01,  2.22it/s] 99%|█████████▉| 234/236 [01:45<00:00,  2.22it/s]100%|█████████▉| 235/236 [01:46<00:00,  2.22it/s]100%|██████████| 236/236 [01:46<00:00,  2.24it/s]100%|██████████| 236/236 [01:46<00:00,  2.21it/s]The average generation time of a batch motion (bs=32) is 0.446335 seconds

0it [00:00, ?it/s]30it [00:00, 293.95it/s]65it [00:00, 321.83it/s]100it [00:00, 332.51it/s]136it [00:00, 342.14it/s]172it [00:00, 346.52it/s]207it [00:00, 345.14it/s]246it [00:00, 359.60it/s]285it [00:00, 368.41it/s]322it [00:00, 367.51it/s]362it [00:01, 377.34it/s]401it [00:01, 380.26it/s]440it [00:01, 379.99it/s]479it [00:01, 379.58it/s]518it [00:01, 374.00it/s]558it [00:01, 381.13it/s]599it [00:01, 388.00it/s]639it [00:01, 390.48it/s]681it [00:01, 397.92it/s]723it [00:01, 403.19it/s]765it [00:02, 407.69it/s]806it [00:02, 386.20it/s]845it [00:02, 366.49it/s]882it [00:02, 355.88it/s]918it [00:02, 351.76it/s]954it [00:02, 342.22it/s]989it [00:02, 337.87it/s]1023it [00:02, 331.37it/s]1057it [00:02, 330.29it/s]1091it [00:03, 295.50it/s]1122it [00:03, 275.85it/s]1151it [00:03, 247.43it/s]1177it [00:03, 233.32it/s]1214it [00:03, 266.35it/s]1249it [00:03, 287.02it/s]1285it [00:03, 306.50it/s]1321it [00:03, 319.22it/s]1356it [00:03, 327.51it/s]1390it [00:04, 321.20it/s]1426it [00:04, 332.05it/s]1460it [00:04, 334.06it/s]1494it [00:04, 335.78it/s]1528it [00:04, 319.16it/s]1561it [00:04, 304.25it/s]1592it [00:04, 292.84it/s]1622it [00:04, 280.11it/s]1652it [00:04, 284.71it/s]1687it [00:05, 302.88it/s]1718it [00:05, 304.15it/s]1749it [00:05, 295.85it/s]1785it [00:05, 313.18it/s]1818it [00:05, 317.94it/s]1856it [00:05, 333.85it/s]1893it [00:05, 344.36it/s]1928it [00:05, 344.04it/s]1963it [00:05, 339.13it/s]1998it [00:05, 340.96it/s]2033it [00:06, 230.34it/s]2061it [00:06, 231.67it/s]2088it [00:06, 229.27it/s]2114it [00:06, 226.93it/s]2139it [00:06, 227.75it/s]2163it [00:06, 228.14it/s]2187it [00:06, 229.25it/s]2211it [00:07, 231.88it/s]2235it [00:07, 231.84it/s]2259it [00:07, 231.81it/s]2283it [00:07, 231.61it/s]2307it [00:07, 231.29it/s]2331it [00:07, 232.46it/s]2355it [00:07, 228.23it/s]2379it [00:07, 228.94it/s]2402it [00:07, 227.51it/s]2425it [00:07, 225.10it/s]2449it [00:08, 227.70it/s]2472it [00:08, 227.65it/s]2495it [00:08, 223.27it/s]2520it [00:08, 229.72it/s]2543it [00:08, 229.05it/s]2568it [00:08, 233.77it/s]2592it [00:08, 234.07it/s]2616it [00:08, 232.84it/s]2640it [00:08, 228.18it/s]2664it [00:09, 230.77it/s]2689it [00:09, 233.56it/s]2713it [00:09, 232.77it/s]2737it [00:09, 232.55it/s]2761it [00:09, 231.91it/s]2790it [00:09, 248.43it/s]2824it [00:09, 272.51it/s]2858it [00:09, 290.45it/s]2892it [00:09, 303.89it/s]2927it [00:09, 314.46it/s]2960it [00:10, 318.07it/s]2994it [00:10, 322.33it/s]3027it [00:10, 324.10it/s]3064it [00:10, 336.83it/s]3103it [00:10, 349.99it/s]3138it [00:10, 283.67it/s]3171it [00:10, 294.16it/s]3202it [00:10, 297.85it/s]3236it [00:10, 308.48it/s]3271it [00:11, 319.89it/s]3306it [00:11, 326.13it/s]3341it [00:11, 331.13it/s]3376it [00:11, 336.03it/s]3410it [00:11, 334.59it/s]3445it [00:11, 338.34it/s]3480it [00:11, 341.14it/s]3515it [00:11, 341.57it/s]3550it [00:11, 343.31it/s]3585it [00:11, 342.53it/s]3622it [00:12, 349.08it/s]3658it [00:12, 350.90it/s]3694it [00:12, 343.82it/s]3729it [00:12, 185.63it/s]3756it [00:12, 187.97it/s]3781it [00:12, 197.90it/s]3806it [00:12, 207.04it/s]3831it [00:13, 216.51it/s]3856it [00:13, 221.37it/s]3881it [00:13, 224.01it/s]3905it [00:13, 228.22it/s]3929it [00:13, 229.47it/s]3953it [00:13, 219.38it/s]3976it [00:13, 215.77it/s]3998it [00:13, 214.60it/s]4021it [00:13, 216.99it/s]4045it [00:14, 222.39it/s]4068it [00:14, 222.66it/s]4091it [00:14, 221.16it/s]4115it [00:14, 225.88it/s]4139it [00:14, 227.94it/s]4162it [00:14, 228.15it/s]4185it [00:14, 228.60it/s]4209it [00:14, 229.64it/s]4233it [00:14, 231.21it/s]4257it [00:14, 224.82it/s]4280it [00:15, 224.18it/s]4303it [00:15, 225.72it/s]4327it [00:15, 229.57it/s]4351it [00:15, 229.65it/s]4374it [00:15, 229.03it/s]4398it [00:15, 229.60it/s]4421it [00:15, 226.99it/s]4444it [00:15, 225.02it/s]4478it [00:15, 258.33it/s]4513it [00:16, 285.16it/s]4547it [00:16, 300.47it/s]4583it [00:16, 315.41it/s]4619it [00:16, 326.84it/s]4648it [00:16, 279.10it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.7827
---> [text2motion] R_precision: (top 1): 0.5453 (top 2): 0.7483 (top 3): 0.8338 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.1875
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.6898
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.5500
!!! DONE !!!
================================================================================

模型: 6_h_030953_iters
评估时间: 2025年 07月 28日 星期一 13:10:07 CST
----------------------------------------
评估成功，用时: 189 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  8%|▊         | 356/4384 [00:00<00:01, 3555.35it/s] 16%|█▌        | 712/4384 [00:00<00:02, 1500.40it/s] 22%|██▏       | 943/4384 [00:00<00:02, 1711.92it/s] 27%|██▋       | 1163/4384 [00:00<00:01, 1815.32it/s] 31%|███▏      | 1378/4384 [00:00<00:01, 1835.87it/s] 36%|███▋      | 1597/4384 [00:00<00:01, 1930.09it/s] 41%|████      | 1807/4384 [00:00<00:01, 1911.54it/s] 46%|████▋     | 2031/4384 [00:01<00:01, 2001.20it/s] 51%|█████     | 2246/4384 [00:01<00:01, 2039.89it/s] 56%|█████▌    | 2457/4384 [00:01<00:00, 2011.70it/s] 61%|██████    | 2672/4384 [00:01<00:00, 2051.43it/s] 66%|██████▌   | 2881/4384 [00:01<00:00, 2041.78it/s] 70%|███████   | 3088/4384 [00:01<00:00, 1977.58it/s] 75%|███████▌  | 3296/4384 [00:01<00:00, 2005.27it/s] 80%|████████  | 3512/4384 [00:01<00:00, 2049.32it/s] 85%|████████▌ | 3736/4384 [00:01<00:00, 2103.24it/s] 90%|█████████ | 3964/4384 [00:01<00:00, 2153.86it/s] 96%|█████████▌| 4189/4384 [00:02<00:00, 2179.59it/s]100%|██████████| 4384/4384 [00:02<00:00, 2007.88it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▌         | 226/4384 [00:00<00:01, 2252.36it/s] 10%|█         | 455/4384 [00:00<00:01, 2271.51it/s] 16%|█▌        | 683/4384 [00:00<00:01, 2207.81it/s] 21%|██        | 907/4384 [00:00<00:01, 2220.20it/s] 26%|██▌       | 1133/4384 [00:00<00:01, 2234.29it/s] 31%|███       | 1357/4384 [00:00<00:01, 2190.20it/s] 36%|███▌      | 1577/4384 [00:00<00:01, 2121.50it/s] 41%|████      | 1790/4384 [00:00<00:01, 2053.80it/s] 46%|████▌     | 1996/4384 [00:00<00:01, 2009.54it/s] 50%|█████     | 2198/4384 [00:01<00:01, 1965.17it/s] 55%|█████▍    | 2395/4384 [00:01<00:01, 1951.06it/s] 59%|█████▉    | 2591/4384 [00:01<00:00, 1946.29it/s] 64%|██████▎   | 2787/4384 [00:01<00:00, 1948.78it/s] 68%|██████▊   | 2984/4384 [00:01<00:00, 1954.60it/s] 73%|███████▎  | 3185/4384 [00:01<00:00, 1970.90it/s] 77%|███████▋  | 3383/4384 [00:01<00:00, 1966.07it/s] 82%|████████▏ | 3580/4384 [00:01<00:00, 1960.46it/s] 86%|████████▌ | 3779/4384 [00:01<00:00, 1966.11it/s] 91%|█████████ | 3976/4384 [00:01<00:00, 1966.91it/s] 95%|█████████▌| 4173/4384 [00:02<00:00, 1950.00it/s]100%|█████████▉| 4369/4384 [00:02<00:00, 1936.32it/s]100%|██████████| 4384/4384 [00:02<00:00, 2018.23it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/6_h_030953_iters.tar with 30953 iterations
Time: 2025-07-28 13:10:38.165722

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]30it [00:00, 268.72it/s]70it [00:00, 342.27it/s]105it [00:00, 328.17it/s]145it [00:00, 351.98it/s]183it [00:00, 356.02it/s]219it [00:00, 334.69it/s]253it [00:00, 295.36it/s]284it [00:00, 264.04it/s]312it [00:01, 246.07it/s]338it [00:01, 232.47it/s]362it [00:01, 224.09it/s]385it [00:01, 216.32it/s]407it [00:01, 205.25it/s]428it [00:01, 201.95it/s]449it [00:01, 200.67it/s]479it [00:01, 227.09it/s]511it [00:01, 251.32it/s]539it [00:02, 258.56it/s]566it [00:02, 260.14it/s]594it [00:02, 263.02it/s]621it [00:02, 264.42it/s]648it [00:02, 255.85it/s]675it [00:02, 257.89it/s]701it [00:02, 257.51it/s]727it [00:02, 256.14it/s]753it [00:02, 252.90it/s]780it [00:03, 256.16it/s]806it [00:03, 243.28it/s]831it [00:03, 236.81it/s]855it [00:03, 227.39it/s]878it [00:03, 221.35it/s]901it [00:03, 207.21it/s]923it [00:03, 209.03it/s]946it [00:03, 212.32it/s]972it [00:03, 223.75it/s]998it [00:04, 232.51it/s]1022it [00:04, 233.57it/s]1046it [00:04, 231.93it/s]1070it [00:04, 228.14it/s]1093it [00:04, 224.88it/s]1116it [00:04, 220.64it/s]1139it [00:04, 219.67it/s]1161it [00:04, 218.71it/s]1184it [00:04, 219.04it/s]1206it [00:04, 217.75it/s]1229it [00:05, 219.29it/s]1253it [00:05, 224.85it/s]1277it [00:05, 226.95it/s]1301it [00:05, 230.13it/s]1325it [00:05, 222.02it/s]1348it [00:05, 216.85it/s]1370it [00:05, 216.56it/s]1392it [00:05, 216.76it/s]1414it [00:05, 216.51it/s]1436it [00:06, 216.67it/s]1458it [00:06, 215.62it/s]1487it [00:06, 235.40it/s]1521it [00:06, 265.71it/s]1560it [00:06, 301.54it/s]1599it [00:06, 327.00it/s]1632it [00:06, 302.73it/s]1663it [00:06, 271.07it/s]1691it [00:06, 253.84it/s]1723it [00:07, 269.35it/s]1752it [00:07, 274.66it/s]1781it [00:07, 276.25it/s]1810it [00:07, 277.37it/s]1841it [00:07, 284.36it/s]1872it [00:07, 290.55it/s]1902it [00:07, 286.89it/s]1934it [00:07, 294.30it/s]1964it [00:07, 288.63it/s]1995it [00:07, 294.33it/s]2026it [00:08, 297.35it/s]2056it [00:08, 297.26it/s]2088it [00:08, 301.27it/s]2119it [00:08, 303.28it/s]2150it [00:08, 300.81it/s]2181it [00:08, 299.09it/s]2211it [00:08, 298.27it/s]2241it [00:08, 295.90it/s]2271it [00:08, 296.29it/s]2301it [00:08, 293.51it/s]2333it [00:09, 299.35it/s]2364it [00:09, 301.74it/s]2396it [00:09, 304.95it/s]2427it [00:09, 306.00it/s]2458it [00:09, 304.96it/s]2489it [00:09, 300.25it/s]2521it [00:09, 304.08it/s]2552it [00:09, 300.38it/s]2583it [00:09, 291.64it/s]2614it [00:10, 295.92it/s]2645it [00:10, 299.15it/s]2675it [00:10, 290.55it/s]2706it [00:10, 294.96it/s]2736it [00:10, 293.33it/s]2766it [00:10, 291.89it/s]2798it [00:10, 299.04it/s]2829it [00:10, 300.12it/s]2860it [00:10, 299.54it/s]2892it [00:10, 304.75it/s]2923it [00:11, 303.07it/s]2954it [00:11, 299.00it/s]2984it [00:11, 291.17it/s]3014it [00:11, 291.86it/s]3044it [00:11, 285.63it/s]3073it [00:11, 284.93it/s]3102it [00:11, 285.14it/s]3131it [00:11, 285.35it/s]3164it [00:11, 296.57it/s]3196it [00:11, 300.83it/s]3227it [00:12, 295.78it/s]3257it [00:12, 280.11it/s]3286it [00:12, 261.24it/s]3313it [00:12, 244.02it/s]3338it [00:12, 230.63it/s]3362it [00:12, 229.96it/s]3386it [00:13, 133.13it/s]3420it [00:13, 169.45it/s]3447it [00:13, 189.46it/s]3471it [00:13, 200.48it/s]3495it [00:13, 204.62it/s]3519it [00:13, 205.29it/s]3542it [00:13, 211.35it/s]3566it [00:13, 218.18it/s]3590it [00:13, 222.83it/s]3614it [00:14, 225.47it/s]3638it [00:14, 224.78it/s]3662it [00:14, 228.02it/s]3686it [00:14, 224.74it/s]3709it [00:14, 221.86it/s]3732it [00:14, 218.64it/s]3754it [00:14, 216.74it/s]3776it [00:14, 215.16it/s]3798it [00:14, 213.94it/s]3820it [00:14, 213.67it/s]3842it [00:15, 209.78it/s]3864it [00:15, 210.14it/s]3886it [00:15, 210.76it/s]3908it [00:15, 211.75it/s]3930it [00:15, 211.47it/s]3952it [00:15, 208.92it/s]3973it [00:15, 207.93it/s]3994it [00:15, 208.18it/s]4016it [00:15, 210.33it/s]4038it [00:16, 210.05it/s]4060it [00:16, 211.22it/s]4082it [00:16, 209.05it/s]4103it [00:16, 208.73it/s]4124it [00:16, 204.60it/s]4145it [00:16, 205.50it/s]4166it [00:16, 201.51it/s]4187it [00:16, 203.79it/s]4211it [00:16, 212.38it/s]4237it [00:16, 225.59it/s]4261it [00:17, 229.82it/s]4285it [00:17, 226.19it/s]4315it [00:17, 246.76it/s]4363it [00:17, 313.92it/s]4408it [00:17, 353.33it/s]4453it [00:17, 381.73it/s]4502it [00:17, 411.83it/s]4547it [00:17, 421.86it/s]4591it [00:17, 426.89it/s]4635it [00:17, 428.27it/s]4648it [00:18, 255.77it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:08,  1.24it/s]  1%|          | 2/236 [00:01<02:23,  1.63it/s]  1%|▏         | 3/236 [00:01<02:06,  1.85it/s]  2%|▏         | 4/236 [00:02<01:58,  1.96it/s]  2%|▏         | 5/236 [00:02<01:53,  2.04it/s]  3%|▎         | 6/236 [00:03<01:49,  2.09it/s]  3%|▎         | 7/236 [00:03<01:47,  2.12it/s]  3%|▎         | 8/236 [00:04<01:46,  2.14it/s]  4%|▍         | 9/236 [00:04<01:45,  2.15it/s]  4%|▍         | 10/236 [00:04<01:44,  2.15it/s]  5%|▍         | 11/236 [00:05<01:43,  2.17it/s]  5%|▌         | 12/236 [00:05<01:42,  2.18it/s]  6%|▌         | 13/236 [00:06<01:41,  2.20it/s]  6%|▌         | 14/236 [00:06<01:38,  2.25it/s]  6%|▋         | 15/236 [00:07<01:39,  2.23it/s]  7%|▋         | 16/236 [00:07<01:39,  2.20it/s]  7%|▋         | 17/236 [00:08<01:39,  2.19it/s]  8%|▊         | 18/236 [00:08<01:39,  2.19it/s]  8%|▊         | 19/236 [00:09<01:39,  2.19it/s]  8%|▊         | 20/236 [00:09<01:38,  2.19it/s]  9%|▉         | 21/236 [00:09<01:38,  2.18it/s]  9%|▉         | 22/236 [00:10<01:37,  2.19it/s] 10%|▉         | 23/236 [00:10<01:37,  2.19it/s] 10%|█         | 24/236 [00:11<01:37,  2.17it/s] 11%|█         | 25/236 [00:11<01:36,  2.18it/s] 11%|█         | 26/236 [00:12<01:36,  2.18it/s] 11%|█▏        | 27/236 [00:12<01:35,  2.19it/s] 12%|█▏        | 28/236 [00:13<01:34,  2.19it/s] 12%|█▏        | 29/236 [00:13<01:34,  2.20it/s] 13%|█▎        | 30/236 [00:14<01:33,  2.20it/s] 13%|█▎        | 31/236 [00:14<01:33,  2.20it/s] 14%|█▎        | 32/236 [00:14<01:32,  2.20it/s] 14%|█▍        | 33/236 [00:15<01:32,  2.20it/s] 14%|█▍        | 34/236 [00:15<01:31,  2.20it/s] 15%|█▍        | 35/236 [00:16<01:31,  2.20it/s] 15%|█▌        | 36/236 [00:16<01:30,  2.20it/s] 16%|█▌        | 37/236 [00:17<01:30,  2.20it/s] 16%|█▌        | 38/236 [00:17<01:30,  2.20it/s] 17%|█▋        | 39/236 [00:18<01:29,  2.19it/s] 17%|█▋        | 40/236 [00:18<01:29,  2.20it/s] 17%|█▋        | 41/236 [00:19<01:28,  2.19it/s] 18%|█▊        | 42/236 [00:19<01:28,  2.19it/s] 18%|█▊        | 43/236 [00:19<01:27,  2.20it/s] 19%|█▊        | 44/236 [00:20<01:27,  2.20it/s] 19%|█▉        | 45/236 [00:20<01:26,  2.20it/s] 19%|█▉        | 46/236 [00:21<01:26,  2.20it/s] 20%|█▉        | 47/236 [00:21<01:26,  2.20it/s] 20%|██        | 48/236 [00:22<01:25,  2.20it/s] 21%|██        | 49/236 [00:22<01:25,  2.19it/s] 21%|██        | 50/236 [00:23<01:24,  2.19it/s] 22%|██▏       | 51/236 [00:23<01:24,  2.19it/s] 22%|██▏       | 52/236 [00:24<01:24,  2.19it/s] 22%|██▏       | 53/236 [00:24<01:23,  2.19it/s] 23%|██▎       | 54/236 [00:24<01:22,  2.20it/s] 23%|██▎       | 55/236 [00:25<01:22,  2.20it/s] 24%|██▎       | 56/236 [00:25<01:21,  2.20it/s] 24%|██▍       | 57/236 [00:26<01:21,  2.20it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.20it/s] 25%|██▌       | 59/236 [00:27<01:20,  2.20it/s] 25%|██▌       | 60/236 [00:27<01:19,  2.20it/s] 26%|██▌       | 61/236 [00:28<01:19,  2.20it/s] 26%|██▋       | 62/236 [00:28<01:18,  2.20it/s] 27%|██▋       | 63/236 [00:29<01:18,  2.21it/s] 27%|██▋       | 64/236 [00:29<01:17,  2.21it/s] 28%|██▊       | 65/236 [00:29<01:17,  2.21it/s] 28%|██▊       | 66/236 [00:30<01:17,  2.21it/s] 28%|██▊       | 67/236 [00:30<01:16,  2.20it/s] 29%|██▉       | 68/236 [00:31<01:16,  2.20it/s] 29%|██▉       | 69/236 [00:31<01:14,  2.25it/s] 30%|██▉       | 70/236 [00:32<01:14,  2.23it/s] 30%|███       | 71/236 [00:32<01:14,  2.22it/s] 31%|███       | 72/236 [00:33<01:13,  2.22it/s] 31%|███       | 73/236 [00:33<01:13,  2.21it/s] 31%|███▏      | 74/236 [00:34<01:13,  2.21it/s] 32%|███▏      | 75/236 [00:34<01:13,  2.21it/s] 32%|███▏      | 76/236 [00:34<01:12,  2.20it/s] 33%|███▎      | 77/236 [00:35<01:12,  2.20it/s] 33%|███▎      | 78/236 [00:35<01:11,  2.20it/s] 33%|███▎      | 79/236 [00:36<01:11,  2.20it/s] 34%|███▍      | 80/236 [00:36<01:10,  2.20it/s] 34%|███▍      | 81/236 [00:37<01:10,  2.20it/s] 35%|███▍      | 82/236 [00:37<01:10,  2.19it/s] 35%|███▌      | 83/236 [00:38<01:09,  2.20it/s] 36%|███▌      | 84/236 [00:38<01:09,  2.20it/s] 36%|███▌      | 85/236 [00:39<01:08,  2.20it/s] 36%|███▋      | 86/236 [00:39<01:08,  2.20it/s] 37%|███▋      | 87/236 [00:39<01:06,  2.25it/s] 37%|███▋      | 88/236 [00:40<01:06,  2.23it/s] 38%|███▊      | 89/236 [00:40<01:06,  2.22it/s] 38%|███▊      | 90/236 [00:41<01:05,  2.22it/s] 39%|███▊      | 91/236 [00:41<01:05,  2.21it/s] 39%|███▉      | 92/236 [00:42<01:05,  2.21it/s] 39%|███▉      | 93/236 [00:42<01:04,  2.21it/s] 40%|███▉      | 94/236 [00:43<01:04,  2.21it/s] 40%|████      | 95/236 [00:43<01:03,  2.21it/s] 41%|████      | 96/236 [00:44<01:03,  2.20it/s] 41%|████      | 97/236 [00:44<01:03,  2.20it/s] 42%|████▏     | 98/236 [00:44<01:02,  2.20it/s] 42%|████▏     | 99/236 [00:45<01:02,  2.20it/s] 42%|████▏     | 100/236 [00:45<01:01,  2.20it/s] 43%|████▎     | 101/236 [00:46<01:01,  2.20it/s] 43%|████▎     | 102/236 [00:46<01:00,  2.20it/s] 44%|████▎     | 103/236 [00:47<01:00,  2.21it/s] 44%|████▍     | 104/236 [00:47<00:59,  2.21it/s] 44%|████▍     | 105/236 [00:48<00:57,  2.26it/s] 45%|████▍     | 106/236 [00:48<00:57,  2.27it/s] 45%|████▌     | 107/236 [00:48<00:57,  2.25it/s] 46%|████▌     | 108/236 [00:49<00:57,  2.24it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.23it/s] 47%|████▋     | 110/236 [00:50<00:56,  2.23it/s] 47%|████▋     | 111/236 [00:50<00:56,  2.22it/s] 47%|████▋     | 112/236 [00:51<00:56,  2.20it/s] 48%|████▊     | 113/236 [00:51<00:55,  2.20it/s] 48%|████▊     | 114/236 [00:52<00:55,  2.20it/s] 49%|████▊     | 115/236 [00:52<00:54,  2.21it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.27it/s] 50%|████▉     | 117/236 [00:53<00:52,  2.25it/s] 50%|█████     | 118/236 [00:53<00:52,  2.24it/s] 50%|█████     | 119/236 [00:54<00:52,  2.23it/s] 51%|█████     | 120/236 [00:54<00:52,  2.22it/s] 51%|█████▏    | 121/236 [00:55<00:51,  2.22it/s] 52%|█████▏    | 122/236 [00:55<00:51,  2.22it/s] 52%|█████▏    | 123/236 [00:56<00:50,  2.22it/s] 53%|█████▎    | 124/236 [00:56<00:50,  2.22it/s] 53%|█████▎    | 125/236 [00:57<00:50,  2.22it/s] 53%|█████▎    | 126/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 127/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 128/236 [00:58<00:48,  2.21it/s] 55%|█████▍    | 129/236 [00:58<00:48,  2.21it/s] 55%|█████▌    | 130/236 [00:59<00:48,  2.21it/s] 56%|█████▌    | 131/236 [00:59<00:47,  2.21it/s] 56%|█████▌    | 132/236 [01:00<00:47,  2.21it/s] 56%|█████▋    | 133/236 [01:00<00:43,  2.34it/s] 57%|█████▋    | 134/236 [01:01<00:44,  2.30it/s] 57%|█████▋    | 135/236 [01:01<00:44,  2.27it/s] 58%|█████▊    | 136/236 [01:01<00:44,  2.25it/s] 58%|█████▊    | 137/236 [01:02<00:44,  2.23it/s] 58%|█████▊    | 138/236 [01:02<00:44,  2.22it/s] 59%|█████▉    | 139/236 [01:03<00:43,  2.21it/s] 59%|█████▉    | 140/236 [01:03<00:43,  2.21it/s] 60%|█████▉    | 141/236 [01:04<00:43,  2.21it/s] 60%|██████    | 142/236 [01:04<00:42,  2.21it/s] 61%|██████    | 143/236 [01:05<00:42,  2.20it/s] 61%|██████    | 144/236 [01:05<00:41,  2.20it/s] 61%|██████▏   | 145/236 [01:06<00:41,  2.20it/s] 62%|██████▏   | 146/236 [01:06<00:40,  2.20it/s] 62%|██████▏   | 147/236 [01:06<00:40,  2.20it/s] 63%|██████▎   | 148/236 [01:07<00:40,  2.20it/s] 63%|██████▎   | 149/236 [01:07<00:39,  2.20it/s] 64%|██████▎   | 150/236 [01:08<00:39,  2.20it/s] 64%|██████▍   | 151/236 [01:08<00:38,  2.20it/s] 64%|██████▍   | 152/236 [01:09<00:35,  2.35it/s] 65%|██████▍   | 153/236 [01:09<00:36,  2.30it/s] 65%|██████▌   | 154/236 [01:10<00:36,  2.27it/s] 66%|██████▌   | 155/236 [01:10<00:36,  2.25it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.23it/s] 67%|██████▋   | 157/236 [01:11<00:35,  2.22it/s] 67%|██████▋   | 158/236 [01:11<00:35,  2.21it/s] 67%|██████▋   | 159/236 [01:12<00:34,  2.21it/s] 68%|██████▊   | 160/236 [01:12<00:34,  2.20it/s] 68%|██████▊   | 161/236 [01:13<00:34,  2.20it/s] 69%|██████▊   | 162/236 [01:13<00:33,  2.20it/s] 69%|██████▉   | 163/236 [01:14<00:33,  2.20it/s] 69%|██████▉   | 164/236 [01:14<00:32,  2.19it/s] 70%|██████▉   | 165/236 [01:15<00:32,  2.19it/s] 70%|███████   | 166/236 [01:15<00:32,  2.19it/s] 71%|███████   | 167/236 [01:15<00:31,  2.19it/s] 71%|███████   | 168/236 [01:16<00:31,  2.19it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.19it/s] 72%|███████▏  | 170/236 [01:17<00:30,  2.19it/s] 72%|███████▏  | 171/236 [01:17<00:29,  2.20it/s] 73%|███████▎  | 172/236 [01:18<00:29,  2.19it/s] 73%|███████▎  | 173/236 [01:18<00:28,  2.19it/s] 74%|███████▎  | 174/236 [01:19<00:28,  2.19it/s] 74%|███████▍  | 175/236 [01:19<00:27,  2.19it/s] 75%|███████▍  | 176/236 [01:20<00:27,  2.20it/s] 75%|███████▌  | 177/236 [01:20<00:26,  2.20it/s] 75%|███████▌  | 178/236 [01:20<00:26,  2.20it/s] 76%|███████▌  | 179/236 [01:21<00:25,  2.20it/s] 76%|███████▋  | 180/236 [01:21<00:25,  2.20it/s] 77%|███████▋  | 181/236 [01:22<00:24,  2.20it/s] 77%|███████▋  | 182/236 [01:22<00:24,  2.20it/s] 78%|███████▊  | 183/236 [01:23<00:24,  2.20it/s] 78%|███████▊  | 184/236 [01:23<00:23,  2.20it/s] 78%|███████▊  | 185/236 [01:24<00:23,  2.20it/s] 79%|███████▉  | 186/236 [01:24<00:22,  2.20it/s] 79%|███████▉  | 187/236 [01:25<00:22,  2.20it/s] 80%|███████▉  | 188/236 [01:25<00:21,  2.20it/s] 80%|████████  | 189/236 [01:25<00:21,  2.19it/s] 81%|████████  | 190/236 [01:26<00:20,  2.20it/s] 81%|████████  | 191/236 [01:26<00:20,  2.20it/s] 81%|████████▏ | 192/236 [01:27<00:20,  2.20it/s] 82%|████████▏ | 193/236 [01:27<00:19,  2.20it/s] 82%|████████▏ | 194/236 [01:28<00:19,  2.20it/s] 83%|████████▎ | 195/236 [01:28<00:18,  2.20it/s] 83%|████████▎ | 196/236 [01:29<00:18,  2.20it/s] 83%|████████▎ | 197/236 [01:29<00:17,  2.20it/s] 84%|████████▍ | 198/236 [01:30<00:17,  2.20it/s] 84%|████████▍ | 199/236 [01:30<00:16,  2.20it/s] 85%|████████▍ | 200/236 [01:30<00:16,  2.20it/s] 85%|████████▌ | 201/236 [01:31<00:15,  2.25it/s] 86%|████████▌ | 202/236 [01:31<00:15,  2.24it/s] 86%|████████▌ | 203/236 [01:32<00:14,  2.22it/s] 86%|████████▋ | 204/236 [01:32<00:14,  2.22it/s] 87%|████████▋ | 205/236 [01:33<00:14,  2.21it/s] 87%|████████▋ | 206/236 [01:33<00:13,  2.20it/s] 88%|████████▊ | 207/236 [01:34<00:13,  2.20it/s] 88%|████████▊ | 208/236 [01:34<00:12,  2.20it/s] 89%|████████▊ | 209/236 [01:35<00:12,  2.20it/s] 89%|████████▉ | 210/236 [01:35<00:10,  2.37it/s] 89%|████████▉ | 211/236 [01:35<00:10,  2.32it/s] 90%|████████▉ | 212/236 [01:36<00:09,  2.47it/s] 90%|█████████ | 213/236 [01:36<00:09,  2.38it/s] 91%|█████████ | 214/236 [01:37<00:09,  2.30it/s] 91%|█████████ | 215/236 [01:37<00:09,  2.26it/s] 92%|█████████▏| 216/236 [01:38<00:08,  2.25it/s] 92%|█████████▏| 217/236 [01:38<00:08,  2.23it/s] 92%|█████████▏| 218/236 [01:38<00:08,  2.21it/s] 93%|█████████▎| 219/236 [01:39<00:07,  2.21it/s] 93%|█████████▎| 220/236 [01:39<00:07,  2.21it/s] 94%|█████████▎| 221/236 [01:40<00:06,  2.21it/s] 94%|█████████▍| 222/236 [01:40<00:06,  2.21it/s] 94%|█████████▍| 223/236 [01:41<00:05,  2.21it/s] 95%|█████████▍| 224/236 [01:41<00:05,  2.21it/s] 95%|█████████▌| 225/236 [01:42<00:04,  2.21it/s] 96%|█████████▌| 226/236 [01:42<00:04,  2.21it/s] 96%|█████████▌| 227/236 [01:43<00:04,  2.21it/s] 97%|█████████▋| 228/236 [01:43<00:03,  2.21it/s] 97%|█████████▋| 229/236 [01:43<00:03,  2.21it/s] 97%|█████████▋| 230/236 [01:44<00:02,  2.21it/s] 98%|█████████▊| 231/236 [01:44<00:02,  2.21it/s] 98%|█████████▊| 232/236 [01:45<00:01,  2.21it/s] 99%|█████████▊| 233/236 [01:45<00:01,  2.21it/s] 99%|█████████▉| 234/236 [01:46<00:00,  2.21it/s]100%|█████████▉| 235/236 [01:46<00:00,  2.20it/s]100%|██████████| 236/236 [01:47<00:00,  2.22it/s]100%|██████████| 236/236 [01:47<00:00,  2.20it/s]The average generation time of a batch motion (bs=32) is 0.447587 seconds

0it [00:00, ?it/s]18it [00:00, 176.19it/s]47it [00:00, 240.31it/s]80it [00:00, 280.77it/s]109it [00:00, 281.24it/s]138it [00:00, 276.10it/s]169it [00:00, 286.24it/s]198it [00:00, 284.76it/s]227it [00:00, 285.62it/s]258it [00:00, 290.30it/s]288it [00:01, 290.35it/s]318it [00:01, 281.84it/s]347it [00:01, 282.72it/s]381it [00:01, 298.33it/s]411it [00:01, 288.56it/s]441it [00:01, 289.51it/s]471it [00:01, 288.36it/s]500it [00:01, 285.21it/s]529it [00:01, 285.81it/s]563it [00:01, 300.31it/s]598it [00:02, 312.41it/s]630it [00:02, 308.64it/s]661it [00:02, 305.07it/s]692it [00:02, 301.46it/s]723it [00:02, 300.92it/s]754it [00:02, 302.18it/s]785it [00:02, 288.34it/s]816it [00:02, 293.79it/s]846it [00:02, 290.91it/s]877it [00:03, 293.20it/s]908it [00:03, 297.60it/s]939it [00:03, 300.29it/s]970it [00:03, 300.82it/s]1001it [00:03, 276.71it/s]1032it [00:03, 284.03it/s]1067it [00:03, 298.29it/s]1098it [00:03, 289.24it/s]1135it [00:03, 310.80it/s]1169it [00:03, 316.76it/s]1201it [00:04, 314.56it/s]1234it [00:04, 318.48it/s]1266it [00:04, 316.77it/s]1298it [00:04, 312.91it/s]1330it [00:04, 312.03it/s]1362it [00:04, 307.09it/s]1395it [00:04, 311.91it/s]1429it [00:04, 318.64it/s]1466it [00:04, 333.17it/s]1501it [00:05, 337.01it/s]1535it [00:05, 337.59it/s]1573it [00:05, 349.59it/s]1608it [00:05, 335.36it/s]1643it [00:05, 337.71it/s]1678it [00:05, 339.24it/s]1713it [00:05, 342.30it/s]1748it [00:05, 340.33it/s]1783it [00:05, 330.18it/s]1817it [00:05, 326.26it/s]1853it [00:06, 334.28it/s]1889it [00:06, 338.54it/s]1923it [00:06, 336.99it/s]1957it [00:06, 335.06it/s]1991it [00:06, 312.42it/s]2023it [00:06, 218.99it/s]2049it [00:06, 220.59it/s]2074it [00:06, 213.32it/s]2098it [00:07, 207.02it/s]2120it [00:07, 201.54it/s]2143it [00:07, 207.81it/s]2166it [00:07, 211.86it/s]2189it [00:07, 214.87it/s]2211it [00:07, 211.19it/s]2233it [00:07, 207.11it/s]2254it [00:07, 205.05it/s]2275it [00:07, 203.62it/s]2296it [00:08, 199.85it/s]2317it [00:08, 196.67it/s]2337it [00:08, 194.54it/s]2357it [00:08, 194.79it/s]2378it [00:08, 196.71it/s]2398it [00:08, 195.37it/s]2418it [00:08, 195.08it/s]2439it [00:08, 196.41it/s]2459it [00:08, 196.45it/s]2479it [00:09, 193.58it/s]2499it [00:09, 191.93it/s]2523it [00:09, 203.00it/s]2545it [00:09, 206.49it/s]2568it [00:09, 212.33it/s]2590it [00:09, 209.48it/s]2611it [00:09, 205.05it/s]2632it [00:09, 195.29it/s]2652it [00:09, 195.14it/s]2673it [00:09, 198.30it/s]2696it [00:10, 205.69it/s]2717it [00:10, 201.53it/s]2743it [00:10, 217.73it/s]2769it [00:10, 228.68it/s]2792it [00:10, 219.59it/s]2815it [00:10, 211.62it/s]2841it [00:10, 223.52it/s]2873it [00:10, 249.67it/s]2907it [00:10, 273.90it/s]2939it [00:11, 286.94it/s]2968it [00:11, 273.41it/s]2996it [00:11, 272.12it/s]3026it [00:11, 278.54it/s]3059it [00:11, 293.06it/s]3092it [00:11, 302.87it/s]3123it [00:11, 290.08it/s]3153it [00:11, 262.39it/s]3180it [00:11, 248.67it/s]3206it [00:12, 233.23it/s]3230it [00:12, 224.83it/s]3253it [00:12, 223.84it/s]3276it [00:12, 222.78it/s]3299it [00:12, 220.25it/s]3322it [00:12, 216.35it/s]3344it [00:12, 216.29it/s]3368it [00:12, 222.29it/s]3391it [00:12, 218.75it/s]3413it [00:13, 210.63it/s]3435it [00:13, 213.00it/s]3459it [00:13, 219.72it/s]3483it [00:13, 224.70it/s]3507it [00:13, 227.51it/s]3531it [00:13, 228.43it/s]3555it [00:13, 229.72it/s]3579it [00:13, 230.55it/s]3603it [00:13, 230.58it/s]3627it [00:13, 230.70it/s]3651it [00:14, 230.41it/s]3675it [00:14, 227.45it/s]3698it [00:14, 226.54it/s]3721it [00:14, 125.34it/s]3743it [00:14, 142.27it/s]3777it [00:14, 183.47it/s]3808it [00:14, 212.19it/s]3842it [00:15, 243.26it/s]3881it [00:15, 280.07it/s]3919it [00:15, 305.83it/s]3958it [00:15, 327.93it/s]3997it [00:15, 345.44it/s]4038it [00:15, 362.01it/s]4078it [00:15, 372.72it/s]4117it [00:15, 374.42it/s]4156it [00:15, 378.23it/s]4198it [00:15, 388.64it/s]4241it [00:16, 393.05it/s]4281it [00:16, 394.02it/s]4321it [00:16, 395.57it/s]4362it [00:16, 397.51it/s]4404it [00:16, 401.62it/s]4445it [00:16, 396.18it/s]4485it [00:16, 396.67it/s]4525it [00:16, 394.84it/s]4565it [00:16, 381.85it/s]4606it [00:17, 387.69it/s]4645it [00:17, 385.58it/s]4648it [00:17, 267.27it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.7631
---> [text2motion] R_precision: (top 1): 0.5558 (top 2): 0.7485 (top 3): 0.8351 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.1300
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.6617
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.6054
!!! DONE !!!
================================================================================

模型: 7_h_037218_iters
评估时间: 2025年 07月 28日 星期一 13:13:17 CST
----------------------------------------
评估成功，用时: 184 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 305/4384 [00:00<00:01, 3037.45it/s] 14%|█▍        | 609/4384 [00:00<00:03, 1048.53it/s] 18%|█▊        | 795/4384 [00:00<00:02, 1230.28it/s] 23%|██▎       | 991/4384 [00:00<00:02, 1405.44it/s] 27%|██▋       | 1182/4384 [00:00<00:02, 1532.32it/s] 31%|███▏      | 1375/4384 [00:00<00:01, 1638.33it/s] 36%|███▌      | 1563/4384 [00:01<00:01, 1705.12it/s] 40%|████      | 1760/4384 [00:01<00:01, 1779.59it/s] 45%|████▍     | 1951/4384 [00:01<00:01, 1809.87it/s] 49%|████▉     | 2142/4384 [00:01<00:01, 1835.91it/s] 53%|█████▎    | 2339/4384 [00:01<00:01, 1874.34it/s] 58%|█████▊    | 2535/4384 [00:01<00:00, 1898.56it/s] 62%|██████▏   | 2729/4384 [00:01<00:00, 1900.58it/s] 67%|██████▋   | 2931/4384 [00:01<00:00, 1934.78it/s] 72%|███████▏  | 3165/4384 [00:01<00:00, 2053.16it/s] 77%|███████▋  | 3372/4384 [00:01<00:00, 2026.10it/s] 82%|████████▏ | 3576/4384 [00:02<00:00, 2004.24it/s] 86%|████████▌ | 3778/4384 [00:02<00:00, 1991.42it/s] 91%|█████████ | 3978/4384 [00:02<00:00, 1993.17it/s] 95%|█████████▌| 4178/4384 [00:02<00:00, 1979.12it/s]100%|█████████▉| 4377/4384 [00:02<00:00, 1969.36it/s]100%|██████████| 4384/4384 [00:02<00:00, 1788.32it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▍         | 208/4384 [00:00<00:02, 2070.77it/s]  9%|▉         | 416/4384 [00:00<00:01, 2049.59it/s] 14%|█▍        | 621/4384 [00:00<00:01, 2017.14it/s] 19%|█▉        | 825/4384 [00:00<00:01, 2025.83it/s] 24%|██▎       | 1032/4384 [00:00<00:01, 2039.14it/s] 28%|██▊       | 1236/4384 [00:00<00:01, 1970.18it/s] 33%|███▎      | 1436/4384 [00:00<00:01, 1979.34it/s] 37%|███▋      | 1637/4384 [00:00<00:01, 1987.52it/s] 42%|████▏     | 1840/4384 [00:00<00:01, 1997.42it/s] 47%|████▋     | 2041/4384 [00:01<00:01, 2000.24it/s] 51%|█████     | 2242/4384 [00:01<00:01, 1983.19it/s] 56%|█████▌    | 2446/4384 [00:01<00:00, 1999.11it/s] 60%|██████    | 2647/4384 [00:01<00:00, 1963.87it/s] 65%|██████▍   | 2844/4384 [00:01<00:00, 1939.07it/s] 69%|██████▉   | 3039/4384 [00:01<00:00, 1924.62it/s] 74%|███████▍  | 3238/4384 [00:01<00:00, 1942.94it/s] 78%|███████▊  | 3433/4384 [00:01<00:00, 1913.52it/s] 83%|████████▎ | 3625/4384 [00:01<00:00, 1911.17it/s] 87%|████████▋ | 3817/4384 [00:01<00:00, 1899.28it/s] 91%|█████████▏| 4010/4384 [00:02<00:00, 1907.08it/s] 96%|█████████▌| 4201/4384 [00:02<00:00, 1897.55it/s]100%|██████████| 4384/4384 [00:02<00:00, 1952.31it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/7_h_037218_iters.tar with 37218 iterations
Time: 2025-07-28 13:13:47.698079

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]25it [00:00, 242.53it/s]50it [00:00, 235.77it/s]78it [00:00, 254.24it/s]104it [00:00, 233.88it/s]132it [00:00, 246.76it/s]159it [00:00, 252.67it/s]185it [00:00, 242.75it/s]210it [00:00, 230.24it/s]234it [00:00, 221.08it/s]257it [00:01, 220.57it/s]286it [00:01, 237.95it/s]319it [00:01, 263.24it/s]353it [00:01, 284.26it/s]388it [00:01, 289.46it/s]419it [00:01, 292.89it/s]453it [00:01, 305.84it/s]484it [00:01, 295.68it/s]514it [00:01, 277.70it/s]543it [00:02, 264.20it/s]570it [00:02, 248.64it/s]596it [00:02, 234.88it/s]620it [00:02, 223.66it/s]643it [00:02, 220.52it/s]666it [00:02, 216.62it/s]688it [00:02, 213.22it/s]710it [00:02, 211.64it/s]732it [00:03, 209.23it/s]754it [00:03, 209.99it/s]777it [00:03, 215.06it/s]799it [00:03, 201.75it/s]820it [00:03, 201.59it/s]841it [00:03, 200.15it/s]863it [00:03, 204.98it/s]885it [00:03, 208.62it/s]906it [00:03, 206.66it/s]927it [00:03, 204.83it/s]950it [00:04, 209.56it/s]972it [00:04, 212.00it/s]995it [00:04, 214.77it/s]1018it [00:04, 217.20it/s]1040it [00:04, 217.11it/s]1062it [00:04, 212.31it/s]1084it [00:04, 213.74it/s]1106it [00:04, 215.51it/s]1129it [00:04, 218.88it/s]1151it [00:04, 216.76it/s]1173it [00:05, 213.23it/s]1195it [00:05, 212.30it/s]1217it [00:05, 207.65it/s]1238it [00:05, 208.16it/s]1259it [00:05, 206.23it/s]1283it [00:05, 215.95it/s]1306it [00:05, 219.54it/s]1330it [00:05, 224.49it/s]1353it [00:05, 220.49it/s]1376it [00:06, 220.62it/s]1399it [00:06, 211.65it/s]1421it [00:06, 203.58it/s]1444it [00:06, 209.23it/s]1466it [00:06, 211.35it/s]1488it [00:06, 208.89it/s]1511it [00:06, 212.30it/s]1533it [00:06, 210.78it/s]1555it [00:06, 211.60it/s]1578it [00:06, 214.35it/s]1601it [00:07, 216.09it/s]1623it [00:07, 203.96it/s]1644it [00:07, 203.70it/s]1665it [00:07, 196.40it/s]1686it [00:07, 199.87it/s]1708it [00:07, 204.19it/s]1730it [00:07, 207.99it/s]1751it [00:07, 206.97it/s]1773it [00:07, 210.14it/s]1795it [00:08, 212.04it/s]1817it [00:08, 209.98it/s]1839it [00:08, 209.34it/s]1860it [00:08, 203.42it/s]1882it [00:08, 207.80it/s]1904it [00:08, 207.55it/s]1925it [00:08, 206.74it/s]1946it [00:08, 207.04it/s]1967it [00:08, 194.24it/s]1988it [00:09, 196.97it/s]2010it [00:09, 203.18it/s]2032it [00:09, 207.77it/s]2054it [00:09, 210.72it/s]2076it [00:09, 210.90it/s]2098it [00:09, 212.79it/s]2120it [00:09, 213.64it/s]2142it [00:09, 211.97it/s]2164it [00:09, 212.48it/s]2186it [00:09, 211.40it/s]2208it [00:10, 210.27it/s]2230it [00:10, 211.08it/s]2252it [00:10, 211.84it/s]2274it [00:10, 211.15it/s]2296it [00:10, 211.69it/s]2318it [00:10, 210.15it/s]2340it [00:10, 204.28it/s]2363it [00:10, 210.30it/s]2393it [00:10, 234.98it/s]2427it [00:10, 262.66it/s]2454it [00:11, 246.55it/s]2479it [00:11, 245.60it/s]2514it [00:11, 274.18it/s]2551it [00:11, 299.32it/s]2596it [00:11, 342.92it/s]2645it [00:11, 384.41it/s]2693it [00:11, 410.34it/s]2735it [00:11, 405.49it/s]2776it [00:11, 405.38it/s]2817it [00:12, 397.92it/s]2857it [00:12, 394.99it/s]2899it [00:12, 401.27it/s]2943it [00:12, 410.45it/s]2991it [00:12, 428.98it/s]3034it [00:12, 426.96it/s]3079it [00:12, 431.35it/s]3126it [00:12, 440.64it/s]3171it [00:12, 442.38it/s]3217it [00:12, 447.28it/s]3262it [00:13, 412.99it/s]3304it [00:13, 411.56it/s]3346it [00:13, 399.01it/s]3387it [00:13, 222.77it/s]3424it [00:13, 249.03it/s]3457it [00:13, 242.71it/s]3487it [00:14, 236.05it/s]3515it [00:14, 221.56it/s]3549it [00:14, 246.51it/s]3583it [00:14, 267.09it/s]3626it [00:14, 308.13it/s]3671it [00:14, 344.05it/s]3715it [00:14, 369.78it/s]3755it [00:14, 377.34it/s]3794it [00:14, 366.65it/s]3832it [00:15, 352.71it/s]3872it [00:15, 364.07it/s]3912it [00:15, 372.21it/s]3952it [00:15, 379.96it/s]3991it [00:15, 382.26it/s]4035it [00:15, 398.29it/s]4079it [00:15, 407.94it/s]4122it [00:15, 413.72it/s]4166it [00:15, 419.99it/s]4209it [00:15, 422.87it/s]4254it [00:16, 430.32it/s]4298it [00:16, 417.72it/s]4343it [00:16, 426.84it/s]4386it [00:16, 422.94it/s]4430it [00:16, 427.84it/s]4473it [00:16, 423.38it/s]4516it [00:16, 367.61it/s]4555it [00:16, 306.53it/s]4589it [00:17, 275.73it/s]4619it [00:17, 258.19it/s]4647it [00:17, 247.37it/s]4648it [00:17, 265.43it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<02:57,  1.32it/s]  1%|          | 2/236 [00:01<02:14,  1.74it/s]  1%|▏         | 3/236 [00:01<02:01,  1.91it/s]  2%|▏         | 4/236 [00:02<01:55,  2.01it/s]  2%|▏         | 5/236 [00:02<01:52,  2.06it/s]  3%|▎         | 6/236 [00:03<01:49,  2.10it/s]  3%|▎         | 7/236 [00:03<01:47,  2.13it/s]  3%|▎         | 8/236 [00:03<01:45,  2.16it/s]  4%|▍         | 9/236 [00:04<01:44,  2.17it/s]  4%|▍         | 10/236 [00:04<01:44,  2.17it/s]  5%|▍         | 11/236 [00:05<01:44,  2.15it/s]  5%|▌         | 12/236 [00:05<01:43,  2.17it/s]  6%|▌         | 13/236 [00:06<01:41,  2.19it/s]  6%|▌         | 14/236 [00:06<01:39,  2.24it/s]  6%|▋         | 15/236 [00:07<01:38,  2.24it/s]  7%|▋         | 16/236 [00:07<01:39,  2.22it/s]  7%|▋         | 17/236 [00:08<01:38,  2.21it/s]  8%|▊         | 18/236 [00:08<01:39,  2.19it/s]  8%|▊         | 19/236 [00:08<01:38,  2.19it/s]  8%|▊         | 20/236 [00:09<01:38,  2.19it/s]  9%|▉         | 21/236 [00:09<01:38,  2.18it/s]  9%|▉         | 22/236 [00:10<01:38,  2.17it/s] 10%|▉         | 23/236 [00:10<01:38,  2.17it/s] 10%|█         | 24/236 [00:11<01:38,  2.16it/s] 11%|█         | 25/236 [00:11<01:37,  2.17it/s] 11%|█         | 26/236 [00:12<01:36,  2.17it/s] 11%|█▏        | 27/236 [00:12<01:36,  2.17it/s] 12%|█▏        | 28/236 [00:13<01:35,  2.17it/s] 12%|█▏        | 29/236 [00:13<01:35,  2.18it/s] 13%|█▎        | 30/236 [00:14<01:34,  2.18it/s] 13%|█▎        | 31/236 [00:14<01:33,  2.18it/s] 14%|█▎        | 32/236 [00:14<01:33,  2.18it/s] 14%|█▍        | 33/236 [00:15<01:33,  2.18it/s] 14%|█▍        | 34/236 [00:15<01:32,  2.18it/s] 15%|█▍        | 35/236 [00:16<01:32,  2.18it/s] 15%|█▌        | 36/236 [00:16<01:31,  2.18it/s] 16%|█▌        | 37/236 [00:17<01:30,  2.19it/s] 16%|█▌        | 38/236 [00:17<01:30,  2.19it/s] 17%|█▋        | 39/236 [00:18<01:30,  2.18it/s] 17%|█▋        | 40/236 [00:18<01:29,  2.18it/s] 17%|█▋        | 41/236 [00:19<01:29,  2.19it/s] 18%|█▊        | 42/236 [00:19<01:28,  2.18it/s] 18%|█▊        | 43/236 [00:19<01:28,  2.18it/s] 19%|█▊        | 44/236 [00:20<01:28,  2.16it/s] 19%|█▉        | 45/236 [00:20<01:28,  2.16it/s] 19%|█▉        | 46/236 [00:21<01:27,  2.17it/s] 20%|█▉        | 47/236 [00:21<01:27,  2.17it/s] 20%|██        | 48/236 [00:22<01:26,  2.18it/s] 21%|██        | 49/236 [00:22<01:25,  2.18it/s] 21%|██        | 50/236 [00:23<01:25,  2.18it/s] 22%|██▏       | 51/236 [00:23<01:24,  2.19it/s] 22%|██▏       | 52/236 [00:24<01:24,  2.19it/s] 22%|██▏       | 53/236 [00:24<01:23,  2.19it/s] 23%|██▎       | 54/236 [00:25<01:22,  2.20it/s] 23%|██▎       | 55/236 [00:25<01:22,  2.19it/s] 24%|██▎       | 56/236 [00:25<01:21,  2.20it/s] 24%|██▍       | 57/236 [00:26<01:21,  2.20it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.20it/s] 25%|██▌       | 59/236 [00:27<01:20,  2.20it/s] 25%|██▌       | 60/236 [00:27<01:19,  2.21it/s] 26%|██▌       | 61/236 [00:28<01:19,  2.21it/s] 26%|██▋       | 62/236 [00:28<01:18,  2.21it/s] 27%|██▋       | 63/236 [00:29<01:18,  2.21it/s] 27%|██▋       | 64/236 [00:29<01:18,  2.20it/s] 28%|██▊       | 65/236 [00:30<01:17,  2.20it/s] 28%|██▊       | 66/236 [00:30<01:17,  2.20it/s] 28%|██▊       | 67/236 [00:30<01:16,  2.20it/s] 29%|██▉       | 68/236 [00:31<01:16,  2.20it/s] 29%|██▉       | 69/236 [00:31<01:14,  2.25it/s] 30%|██▉       | 70/236 [00:32<01:14,  2.24it/s] 30%|███       | 71/236 [00:32<01:14,  2.23it/s] 31%|███       | 72/236 [00:33<01:13,  2.22it/s] 31%|███       | 73/236 [00:33<01:13,  2.22it/s] 31%|███▏      | 74/236 [00:34<01:14,  2.19it/s] 32%|███▏      | 75/236 [00:34<01:14,  2.16it/s] 32%|███▏      | 76/236 [00:35<01:14,  2.16it/s] 33%|███▎      | 77/236 [00:35<01:13,  2.16it/s] 33%|███▎      | 78/236 [00:35<01:12,  2.17it/s] 33%|███▎      | 79/236 [00:36<01:12,  2.17it/s] 34%|███▍      | 80/236 [00:36<01:11,  2.17it/s] 34%|███▍      | 81/236 [00:37<01:11,  2.18it/s] 35%|███▍      | 82/236 [00:37<01:10,  2.17it/s] 35%|███▌      | 83/236 [00:38<01:10,  2.18it/s] 36%|███▌      | 84/236 [00:38<01:09,  2.18it/s] 36%|███▌      | 85/236 [00:39<01:09,  2.17it/s] 36%|███▋      | 86/236 [00:39<01:09,  2.17it/s] 37%|███▋      | 87/236 [00:40<01:07,  2.22it/s] 37%|███▋      | 88/236 [00:40<01:07,  2.20it/s] 38%|███▊      | 89/236 [00:40<01:06,  2.20it/s] 38%|███▊      | 90/236 [00:41<01:07,  2.17it/s] 39%|███▊      | 91/236 [00:41<01:06,  2.17it/s] 39%|███▉      | 92/236 [00:42<01:06,  2.17it/s] 39%|███▉      | 93/236 [00:42<01:05,  2.17it/s] 40%|███▉      | 94/236 [00:43<01:05,  2.17it/s] 40%|████      | 95/236 [00:43<01:04,  2.18it/s] 41%|████      | 96/236 [00:44<01:04,  2.18it/s] 41%|████      | 97/236 [00:44<01:03,  2.17it/s] 42%|████▏     | 98/236 [00:45<01:03,  2.18it/s] 42%|████▏     | 99/236 [00:45<01:02,  2.19it/s] 42%|████▏     | 100/236 [00:46<01:02,  2.19it/s] 43%|████▎     | 101/236 [00:46<01:01,  2.18it/s] 43%|████▎     | 102/236 [00:46<01:01,  2.18it/s] 44%|████▎     | 103/236 [00:47<01:01,  2.18it/s] 44%|████▍     | 104/236 [00:47<01:00,  2.18it/s] 44%|████▍     | 105/236 [00:48<00:58,  2.24it/s] 45%|████▍     | 106/236 [00:48<00:57,  2.25it/s] 45%|████▌     | 107/236 [00:49<00:57,  2.23it/s] 46%|████▌     | 108/236 [00:49<00:57,  2.21it/s] 46%|████▌     | 109/236 [00:50<00:57,  2.21it/s] 47%|████▋     | 110/236 [00:50<00:57,  2.20it/s] 47%|████▋     | 111/236 [00:51<00:57,  2.19it/s] 47%|████▋     | 112/236 [00:51<00:56,  2.19it/s] 48%|████▊     | 113/236 [00:51<00:56,  2.19it/s] 48%|████▊     | 114/236 [00:52<00:55,  2.19it/s] 49%|████▊     | 115/236 [00:52<00:55,  2.19it/s] 49%|████▉     | 116/236 [00:53<00:53,  2.24it/s] 50%|████▉     | 117/236 [00:53<00:53,  2.22it/s] 50%|█████     | 118/236 [00:54<00:53,  2.21it/s] 50%|█████     | 119/236 [00:54<00:53,  2.20it/s] 51%|█████     | 120/236 [00:55<00:53,  2.19it/s] 51%|█████▏    | 121/236 [00:55<00:52,  2.18it/s] 52%|█████▏    | 122/236 [00:56<00:52,  2.18it/s] 52%|█████▏    | 123/236 [00:56<00:51,  2.18it/s] 53%|█████▎    | 124/236 [00:56<00:51,  2.18it/s] 53%|█████▎    | 125/236 [00:57<00:50,  2.18it/s] 53%|█████▎    | 126/236 [00:57<00:50,  2.18it/s] 54%|█████▍    | 127/236 [00:58<00:50,  2.18it/s] 54%|█████▍    | 128/236 [00:58<00:49,  2.18it/s] 55%|█████▍    | 129/236 [00:59<00:49,  2.18it/s] 55%|█████▌    | 130/236 [00:59<00:48,  2.16it/s] 56%|█████▌    | 131/236 [01:00<00:48,  2.17it/s] 56%|█████▌    | 132/236 [01:00<00:48,  2.16it/s] 56%|█████▋    | 133/236 [01:01<00:45,  2.29it/s] 57%|█████▋    | 134/236 [01:01<00:45,  2.25it/s] 57%|█████▋    | 135/236 [01:01<00:45,  2.23it/s] 58%|█████▊    | 136/236 [01:02<00:45,  2.21it/s] 58%|█████▊    | 137/236 [01:02<00:44,  2.20it/s] 58%|█████▊    | 138/236 [01:03<00:44,  2.20it/s] 59%|█████▉    | 139/236 [01:03<00:44,  2.19it/s] 59%|█████▉    | 140/236 [01:04<00:43,  2.19it/s] 60%|█████▉    | 141/236 [01:04<00:43,  2.19it/s] 60%|██████    | 142/236 [01:05<00:42,  2.19it/s] 61%|██████    | 143/236 [01:05<00:42,  2.19it/s] 61%|██████    | 144/236 [01:06<00:42,  2.19it/s] 61%|██████▏   | 145/236 [01:06<00:41,  2.18it/s] 62%|██████▏   | 146/236 [01:06<00:41,  2.18it/s] 62%|██████▏   | 147/236 [01:07<00:40,  2.18it/s] 63%|██████▎   | 148/236 [01:07<00:40,  2.18it/s] 63%|██████▎   | 149/236 [01:08<00:39,  2.18it/s] 64%|██████▎   | 150/236 [01:08<00:39,  2.18it/s] 64%|██████▍   | 151/236 [01:09<00:38,  2.18it/s] 64%|██████▍   | 152/236 [01:09<00:36,  2.33it/s] 65%|██████▍   | 153/236 [01:10<00:36,  2.28it/s] 65%|██████▌   | 154/236 [01:10<00:36,  2.25it/s] 66%|██████▌   | 155/236 [01:10<00:36,  2.23it/s] 66%|██████▌   | 156/236 [01:11<00:36,  2.21it/s] 67%|██████▋   | 157/236 [01:11<00:35,  2.20it/s] 67%|██████▋   | 158/236 [01:12<00:35,  2.19it/s] 67%|██████▋   | 159/236 [01:12<00:35,  2.19it/s] 68%|██████▊   | 160/236 [01:13<00:34,  2.18it/s] 68%|██████▊   | 161/236 [01:13<00:34,  2.18it/s] 69%|██████▊   | 162/236 [01:14<00:33,  2.18it/s] 69%|██████▉   | 163/236 [01:14<00:33,  2.17it/s] 69%|██████▉   | 164/236 [01:15<00:33,  2.17it/s] 70%|██████▉   | 165/236 [01:15<00:32,  2.17it/s] 70%|███████   | 166/236 [01:16<00:32,  2.16it/s] 71%|███████   | 167/236 [01:16<00:31,  2.16it/s] 71%|███████   | 168/236 [01:16<00:31,  2.16it/s] 72%|███████▏  | 169/236 [01:17<00:30,  2.17it/s] 72%|███████▏  | 170/236 [01:17<00:30,  2.17it/s] 72%|███████▏  | 171/236 [01:18<00:29,  2.17it/s] 73%|███████▎  | 172/236 [01:18<00:29,  2.17it/s] 73%|███████▎  | 173/236 [01:19<00:28,  2.17it/s] 74%|███████▎  | 174/236 [01:19<00:28,  2.17it/s] 74%|███████▍  | 175/236 [01:20<00:28,  2.17it/s] 75%|███████▍  | 176/236 [01:20<00:27,  2.18it/s] 75%|███████▌  | 177/236 [01:21<00:27,  2.16it/s] 75%|███████▌  | 178/236 [01:21<00:26,  2.15it/s] 76%|███████▌  | 179/236 [01:22<00:26,  2.16it/s] 76%|███████▋  | 180/236 [01:22<00:25,  2.16it/s] 77%|███████▋  | 181/236 [01:22<00:25,  2.16it/s] 77%|███████▋  | 182/236 [01:23<00:24,  2.16it/s] 78%|███████▊  | 183/236 [01:23<00:24,  2.16it/s] 78%|███████▊  | 184/236 [01:24<00:24,  2.16it/s] 78%|███████▊  | 185/236 [01:24<00:23,  2.16it/s] 79%|███████▉  | 186/236 [01:25<00:23,  2.17it/s] 79%|███████▉  | 187/236 [01:25<00:22,  2.17it/s] 80%|███████▉  | 188/236 [01:26<00:22,  2.18it/s] 80%|████████  | 189/236 [01:26<00:21,  2.18it/s] 81%|████████  | 190/236 [01:27<00:21,  2.19it/s] 81%|████████  | 191/236 [01:27<00:20,  2.20it/s] 81%|████████▏ | 192/236 [01:28<00:19,  2.20it/s] 82%|████████▏ | 193/236 [01:28<00:19,  2.20it/s] 82%|████████▏ | 194/236 [01:28<00:19,  2.20it/s] 83%|████████▎ | 195/236 [01:29<00:18,  2.20it/s] 83%|████████▎ | 196/236 [01:29<00:18,  2.19it/s] 83%|████████▎ | 197/236 [01:30<00:17,  2.19it/s] 84%|████████▍ | 198/236 [01:30<00:17,  2.18it/s] 84%|████████▍ | 199/236 [01:31<00:17,  2.17it/s] 85%|████████▍ | 200/236 [01:31<00:16,  2.18it/s] 85%|████████▌ | 201/236 [01:32<00:15,  2.24it/s] 86%|████████▌ | 202/236 [01:32<00:15,  2.23it/s] 86%|████████▌ | 203/236 [01:33<00:14,  2.21it/s] 86%|████████▋ | 204/236 [01:33<00:14,  2.21it/s] 87%|████████▋ | 205/236 [01:33<00:14,  2.20it/s] 87%|████████▋ | 206/236 [01:34<00:13,  2.20it/s] 88%|████████▊ | 207/236 [01:34<00:13,  2.19it/s] 88%|████████▊ | 208/236 [01:35<00:12,  2.19it/s] 89%|████████▊ | 209/236 [01:35<00:12,  2.19it/s] 89%|████████▉ | 210/236 [01:36<00:11,  2.36it/s] 89%|████████▉ | 211/236 [01:36<00:10,  2.31it/s] 90%|████████▉ | 212/236 [01:36<00:09,  2.45it/s] 90%|█████████ | 213/236 [01:37<00:09,  2.37it/s] 91%|█████████ | 214/236 [01:37<00:09,  2.31it/s] 91%|█████████ | 215/236 [01:38<00:09,  2.27it/s] 92%|█████████▏| 216/236 [01:38<00:08,  2.25it/s] 92%|█████████▏| 217/236 [01:39<00:08,  2.23it/s] 92%|█████████▏| 218/236 [01:39<00:08,  2.22it/s] 93%|█████████▎| 219/236 [01:40<00:07,  2.21it/s] 93%|█████████▎| 220/236 [01:40<00:07,  2.20it/s] 94%|█████████▎| 221/236 [01:41<00:06,  2.19it/s] 94%|█████████▍| 222/236 [01:41<00:06,  2.19it/s] 94%|█████████▍| 223/236 [01:41<00:05,  2.19it/s] 95%|█████████▍| 224/236 [01:42<00:05,  2.19it/s] 95%|█████████▌| 225/236 [01:42<00:05,  2.18it/s] 96%|█████████▌| 226/236 [01:43<00:04,  2.19it/s] 96%|█████████▌| 227/236 [01:43<00:04,  2.19it/s] 97%|█████████▋| 228/236 [01:44<00:03,  2.19it/s] 97%|█████████▋| 229/236 [01:44<00:03,  2.19it/s] 97%|█████████▋| 230/236 [01:45<00:02,  2.19it/s] 98%|█████████▊| 231/236 [01:45<00:02,  2.18it/s] 98%|█████████▊| 232/236 [01:46<00:01,  2.19it/s] 99%|█████████▊| 233/236 [01:46<00:01,  2.19it/s] 99%|█████████▉| 234/236 [01:46<00:00,  2.17it/s]100%|█████████▉| 235/236 [01:47<00:00,  2.17it/s]100%|██████████| 236/236 [01:47<00:00,  2.18it/s]100%|██████████| 236/236 [01:47<00:00,  2.19it/s]The average generation time of a batch motion (bs=32) is 0.451438 seconds

0it [00:00, ?it/s]29it [00:00, 285.75it/s]65it [00:00, 328.70it/s]105it [00:00, 360.50it/s]142it [00:00, 360.10it/s]183it [00:00, 374.62it/s]223it [00:00, 382.83it/s]266it [00:00, 397.74it/s]306it [00:00, 392.37it/s]348it [00:00, 399.39it/s]390it [00:01, 403.77it/s]431it [00:01, 401.99it/s]472it [00:01, 399.95it/s]514it [00:01, 405.25it/s]555it [00:01, 404.24it/s]599it [00:01, 412.13it/s]643it [00:01, 418.73it/s]685it [00:01, 409.90it/s]729it [00:01, 418.10it/s]773it [00:01, 422.32it/s]816it [00:02, 418.04it/s]858it [00:02, 412.59it/s]901it [00:02, 415.05it/s]943it [00:02, 414.99it/s]986it [00:02, 416.89it/s]1028it [00:02, 405.20it/s]1070it [00:02, 409.09it/s]1115it [00:02, 418.65it/s]1159it [00:02, 424.25it/s]1202it [00:02, 412.42it/s]1244it [00:03, 413.06it/s]1289it [00:03, 422.45it/s]1332it [00:03, 413.27it/s]1374it [00:03, 379.97it/s]1413it [00:03, 358.75it/s]1450it [00:03, 350.37it/s]1494it [00:03, 373.34it/s]1535it [00:03, 383.08it/s]1580it [00:03, 400.44it/s]1621it [00:04, 391.30it/s]1663it [00:04, 398.33it/s]1704it [00:04, 400.79it/s]1745it [00:04, 395.51it/s]1785it [00:04, 388.59it/s]1824it [00:04, 360.06it/s]1861it [00:04, 348.72it/s]1903it [00:04, 366.99it/s]1944it [00:04, 378.51it/s]1984it [00:05, 384.05it/s]2023it [00:05, 319.47it/s]2067it [00:05, 348.73it/s]2107it [00:05, 361.72it/s]2152it [00:05, 384.79it/s]2194it [00:05, 394.52it/s]2236it [00:05, 399.28it/s]2277it [00:05, 402.01it/s]2318it [00:05, 402.94it/s]2359it [00:06, 389.79it/s]2399it [00:06, 367.02it/s]2439it [00:06, 374.50it/s]2480it [00:06, 382.49it/s]2519it [00:06, 364.25it/s]2556it [00:06, 347.23it/s]2598it [00:06, 366.78it/s]2636it [00:06, 368.55it/s]2677it [00:06, 378.51it/s]2716it [00:07, 371.41it/s]2754it [00:07, 361.48it/s]2797it [00:07, 371.68it/s]2838it [00:07, 382.00it/s]2881it [00:07, 393.30it/s]2923it [00:07, 399.71it/s]2964it [00:07, 367.44it/s]3002it [00:07, 351.09it/s]3038it [00:07, 349.99it/s]3083it [00:07, 374.82it/s]3125it [00:08, 385.56it/s]3164it [00:08, 380.97it/s]3203it [00:08, 373.52it/s]3247it [00:08, 390.53it/s]3290it [00:08, 401.84it/s]3333it [00:08, 409.13it/s]3375it [00:08, 406.04it/s]3416it [00:08, 393.82it/s]3457it [00:08, 397.21it/s]3499it [00:09, 401.86it/s]3541it [00:09, 405.14it/s]3583it [00:09, 408.00it/s]3626it [00:09, 412.41it/s]3668it [00:09, 401.39it/s]3709it [00:09, 395.01it/s]3749it [00:09, 207.85it/s]3780it [00:10, 208.33it/s]3808it [00:10, 212.55it/s]3835it [00:10, 216.39it/s]3861it [00:10, 219.98it/s]3886it [00:10, 222.41it/s]3911it [00:10, 221.33it/s]3935it [00:10, 223.97it/s]3959it [00:10, 219.64it/s]3982it [00:11, 217.96it/s]4005it [00:11, 214.85it/s]4028it [00:11, 217.62it/s]4050it [00:11, 210.93it/s]4074it [00:11, 218.83it/s]4097it [00:11, 220.75it/s]4123it [00:11, 229.51it/s]4148it [00:11, 233.12it/s]4173it [00:11, 236.90it/s]4199it [00:11, 242.29it/s]4224it [00:12, 241.20it/s]4250it [00:12, 246.17it/s]4281it [00:12, 262.77it/s]4315it [00:12, 283.73it/s]4357it [00:12, 322.12it/s]4400it [00:12, 353.94it/s]4436it [00:12, 353.10it/s]4476it [00:12, 365.53it/s]4518it [00:12, 380.55it/s]4563it [00:12, 398.57it/s]4609it [00:13, 415.30it/s]4648it [00:13, 346.57it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.7877
---> [text2motion] R_precision: (top 1): 0.5442 (top 2): 0.7496 (top 3): 0.8332 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.0965
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.5038
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.5902
!!! DONE !!!
================================================================================

模型: 8_h_043445_iters
评估时间: 2025年 07月 28日 星期一 13:16:23 CST
----------------------------------------
评估成功，用时: 189 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 312/4384 [00:00<00:01, 3112.29it/s] 14%|█▍        | 624/4384 [00:00<00:03, 1119.12it/s] 18%|█▊        | 798/4384 [00:00<00:02, 1241.33it/s] 22%|██▏       | 972/4384 [00:00<00:02, 1363.09it/s] 26%|██▌       | 1143/4384 [00:00<00:02, 1372.01it/s] 30%|██▉       | 1303/4384 [00:00<00:02, 1393.54it/s] 34%|███▎      | 1469/4384 [00:01<00:01, 1463.67it/s] 38%|███▊      | 1660/4384 [00:01<00:01, 1584.52it/s] 42%|████▏     | 1850/4384 [00:01<00:01, 1672.51it/s] 47%|████▋     | 2039/4384 [00:01<00:01, 1734.34it/s] 51%|█████     | 2219/4384 [00:01<00:01, 1743.33it/s] 56%|█████▌    | 2445/4384 [00:01<00:01, 1893.89it/s] 61%|██████    | 2674/4384 [00:01<00:00, 2007.66it/s] 66%|██████▌   | 2898/4384 [00:01<00:00, 2073.49it/s] 71%|███████▏  | 3125/4384 [00:01<00:00, 2129.96it/s] 76%|███████▋  | 3343/4384 [00:01<00:00, 2142.74it/s] 81%|████████▏ | 3567/4384 [00:02<00:00, 2169.33it/s] 86%|████████▋ | 3790/4384 [00:02<00:00, 2186.42it/s] 92%|█████████▏| 4020/4384 [00:02<00:00, 2219.55it/s] 97%|█████████▋| 4243/4384 [00:02<00:00, 2194.61it/s]100%|██████████| 4384/4384 [00:02<00:00, 1810.10it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  4%|▍         | 184/4384 [00:00<00:02, 1836.84it/s]  9%|▉         | 412/4384 [00:00<00:01, 2091.50it/s] 15%|█▍        | 642/4384 [00:00<00:01, 2180.19it/s] 20%|█▉        | 869/4384 [00:00<00:01, 2213.76it/s] 25%|██▍       | 1091/4384 [00:00<00:01, 2142.43it/s] 30%|██▉       | 1306/4384 [00:00<00:01, 2033.02it/s] 34%|███▍      | 1511/4384 [00:00<00:01, 1954.74it/s] 39%|███▉      | 1708/4384 [00:00<00:01, 1931.29it/s] 43%|████▎     | 1902/4384 [00:00<00:01, 1904.15it/s] 48%|████▊     | 2121/4384 [00:01<00:01, 1985.49it/s] 53%|█████▎    | 2321/4384 [00:01<00:01, 1937.75it/s] 57%|█████▋    | 2516/4384 [00:01<00:00, 1906.23it/s] 62%|██████▏   | 2708/4384 [00:01<00:00, 1872.61it/s] 66%|██████▌   | 2896/4384 [00:01<00:00, 1872.11it/s] 70%|███████   | 3084/4384 [00:01<00:00, 1852.82it/s] 75%|███████▍  | 3274/4384 [00:01<00:00, 1866.50it/s] 79%|███████▉  | 3461/4384 [00:01<00:00, 1835.40it/s] 83%|████████▎ | 3645/4384 [00:01<00:00, 1827.03it/s] 87%|████████▋ | 3830/4384 [00:01<00:00, 1831.02it/s] 92%|█████████▏| 4015/4384 [00:02<00:00, 1835.15it/s] 96%|█████████▌| 4199/4384 [00:02<00:00, 1831.30it/s]100%|█████████▉| 4383/4384 [00:02<00:00, 1814.43it/s]100%|██████████| 4384/4384 [00:02<00:00, 1912.18it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/8_h_043445_iters.tar with 43445 iterations
Time: 2025-07-28 13:16:54.566022

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]26it [00:00, 255.18it/s]52it [00:00, 254.92it/s]82it [00:00, 273.93it/s]115it [00:00, 293.74it/s]149it [00:00, 309.58it/s]180it [00:00, 308.18it/s]211it [00:00, 269.38it/s]244it [00:00, 286.14it/s]277it [00:00, 298.41it/s]311it [00:01, 309.08it/s]344it [00:01, 314.52it/s]377it [00:01, 317.75it/s]410it [00:01, 285.88it/s]440it [00:01, 248.75it/s]470it [00:01, 260.59it/s]502it [00:01, 273.81it/s]531it [00:01, 263.82it/s]559it [00:01, 259.66it/s]586it [00:02, 240.14it/s]614it [00:02, 247.96it/s]640it [00:02, 232.86it/s]664it [00:02, 221.49it/s]687it [00:02, 215.56it/s]709it [00:02, 211.56it/s]731it [00:02, 207.10it/s]752it [00:02, 203.01it/s]775it [00:03, 209.94it/s]798it [00:03, 207.69it/s]821it [00:03, 212.61it/s]843it [00:03, 211.80it/s]866it [00:03, 216.22it/s]889it [00:03, 219.19it/s]912it [00:03, 222.32it/s]935it [00:03, 223.63it/s]958it [00:03, 223.35it/s]982it [00:03, 223.57it/s]1006it [00:04, 225.95it/s]1029it [00:04, 220.77it/s]1052it [00:04, 219.37it/s]1074it [00:04, 214.84it/s]1096it [00:04, 211.08it/s]1118it [00:04, 207.92it/s]1139it [00:04, 205.42it/s]1160it [00:04, 204.51it/s]1181it [00:04, 204.10it/s]1202it [00:05, 203.53it/s]1223it [00:05, 202.96it/s]1244it [00:05, 203.09it/s]1265it [00:05, 203.03it/s]1286it [00:05, 202.98it/s]1307it [00:05, 202.28it/s]1328it [00:05, 200.37it/s]1349it [00:05, 199.48it/s]1370it [00:05, 200.50it/s]1391it [00:05, 201.65it/s]1412it [00:06, 201.41it/s]1433it [00:06, 199.51it/s]1454it [00:06, 200.41it/s]1475it [00:06, 200.38it/s]1496it [00:06, 200.03it/s]1517it [00:06, 199.72it/s]1538it [00:06, 202.27it/s]1559it [00:06, 203.69it/s]1580it [00:06, 202.14it/s]1601it [00:07, 203.30it/s]1622it [00:07, 195.94it/s]1643it [00:07, 197.60it/s]1663it [00:07, 198.08it/s]1683it [00:07, 191.96it/s]1703it [00:07, 194.23it/s]1724it [00:07, 196.82it/s]1745it [00:07, 198.21it/s]1765it [00:07, 194.07it/s]1786it [00:07, 196.96it/s]1806it [00:08, 195.12it/s]1827it [00:08, 198.19it/s]1848it [00:08, 200.69it/s]1869it [00:08, 199.19it/s]1889it [00:08, 199.12it/s]1910it [00:08, 199.81it/s]1931it [00:08, 200.23it/s]1952it [00:08, 200.23it/s]1973it [00:08, 200.64it/s]1994it [00:09, 200.60it/s]2015it [00:09, 200.89it/s]2036it [00:09, 196.28it/s]2057it [00:09, 198.67it/s]2078it [00:09, 200.73it/s]2099it [00:09, 202.68it/s]2120it [00:09, 203.01it/s]2141it [00:09, 202.22it/s]2162it [00:09, 202.13it/s]2183it [00:09, 196.52it/s]2205it [00:10, 202.51it/s]2228it [00:10, 208.27it/s]2250it [00:10, 208.90it/s]2272it [00:10, 211.67it/s]2294it [00:10, 212.38it/s]2316it [00:10, 213.05it/s]2338it [00:10, 211.06it/s]2360it [00:10, 209.26it/s]2383it [00:10, 213.75it/s]2405it [00:10, 214.09it/s]2427it [00:11, 202.98it/s]2457it [00:11, 227.72it/s]2480it [00:11, 223.80it/s]2503it [00:11, 213.19it/s]2525it [00:11, 209.05it/s]2547it [00:11, 206.72it/s]2568it [00:11, 205.69it/s]2589it [00:11, 205.42it/s]2610it [00:11, 205.42it/s]2631it [00:12, 205.26it/s]2652it [00:12, 205.86it/s]2673it [00:12, 207.01it/s]2694it [00:12, 205.36it/s]2715it [00:12, 201.96it/s]2736it [00:12, 201.24it/s]2757it [00:12, 201.39it/s]2778it [00:12, 201.32it/s]2799it [00:12, 201.79it/s]2820it [00:13, 201.38it/s]2841it [00:13, 202.56it/s]2862it [00:13, 196.96it/s]2883it [00:13, 199.73it/s]2904it [00:13, 194.30it/s]2925it [00:13, 197.55it/s]2946it [00:13, 200.41it/s]2967it [00:13, 201.78it/s]2988it [00:13, 201.83it/s]3009it [00:13, 201.82it/s]3030it [00:14, 201.67it/s]3051it [00:14, 201.37it/s]3072it [00:14, 201.40it/s]3093it [00:14, 201.07it/s]3114it [00:14, 200.93it/s]3135it [00:14, 200.74it/s]3156it [00:14, 198.84it/s]3177it [00:14, 199.34it/s]3198it [00:14, 200.13it/s]3219it [00:14, 200.28it/s]3240it [00:15, 198.02it/s]3260it [00:15, 191.55it/s]3281it [00:15, 194.28it/s]3301it [00:15, 192.70it/s]3322it [00:15, 195.54it/s]3342it [00:15, 187.83it/s]3363it [00:15, 192.30it/s]3383it [00:16, 119.18it/s]3412it [00:16, 152.44it/s]3435it [00:16, 167.92it/s]3456it [00:16, 177.23it/s]3477it [00:16, 182.46it/s]3498it [00:16, 188.98it/s]3519it [00:16, 193.91it/s]3540it [00:16, 194.94it/s]3562it [00:16, 200.04it/s]3583it [00:17, 202.57it/s]3604it [00:17, 202.11it/s]3625it [00:17, 199.68it/s]3646it [00:17, 200.84it/s]3667it [00:17, 202.01it/s]3688it [00:17, 202.14it/s]3709it [00:17, 202.04it/s]3730it [00:17, 200.15it/s]3751it [00:17, 196.93it/s]3772it [00:17, 198.63it/s]3792it [00:18, 198.04it/s]3813it [00:18, 199.58it/s]3834it [00:18, 200.31it/s]3855it [00:18, 201.57it/s]3876it [00:18, 201.28it/s]3897it [00:18, 199.78it/s]3918it [00:18, 201.08it/s]3939it [00:18, 201.80it/s]3960it [00:18, 192.62it/s]3980it [00:19, 194.65it/s]4001it [00:19, 197.09it/s]4021it [00:19, 192.90it/s]4042it [00:19, 195.55it/s]4062it [00:19, 196.29it/s]4082it [00:19, 197.04it/s]4103it [00:19, 198.22it/s]4123it [00:19, 198.51it/s]4144it [00:19, 199.35it/s]4165it [00:19, 199.93it/s]4185it [00:20, 199.29it/s]4206it [00:20, 200.63it/s]4227it [00:20, 197.39it/s]4248it [00:20, 198.58it/s]4269it [00:20, 199.16it/s]4289it [00:20, 192.80it/s]4310it [00:20, 195.67it/s]4331it [00:20, 198.32it/s]4352it [00:20, 200.79it/s]4373it [00:20, 202.00it/s]4394it [00:21, 202.49it/s]4415it [00:21, 203.54it/s]4436it [00:21, 200.31it/s]4457it [00:21, 195.42it/s]4477it [00:21, 192.94it/s]4498it [00:21, 195.31it/s]4519it [00:21, 197.32it/s]4540it [00:21, 198.52it/s]4560it [00:21, 198.77it/s]4581it [00:22, 200.03it/s]4602it [00:22, 196.13it/s]4623it [00:22, 198.21it/s]4644it [00:22, 199.07it/s]4648it [00:22, 205.81it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:30,  1.12it/s]  1%|          | 2/236 [00:01<02:29,  1.57it/s]  1%|▏         | 3/236 [00:01<02:10,  1.79it/s]  2%|▏         | 4/236 [00:02<02:00,  1.92it/s]  2%|▏         | 5/236 [00:02<01:55,  2.00it/s]  3%|▎         | 6/236 [00:03<01:51,  2.06it/s]  3%|▎         | 7/236 [00:03<01:49,  2.10it/s]  3%|▎         | 8/236 [00:04<01:49,  2.09it/s]  4%|▍         | 9/236 [00:04<01:47,  2.12it/s]  4%|▍         | 10/236 [00:05<01:45,  2.14it/s]  5%|▍         | 11/236 [00:05<01:44,  2.16it/s]  5%|▌         | 12/236 [00:05<01:43,  2.17it/s]  6%|▌         | 13/236 [00:06<01:41,  2.19it/s]  6%|▌         | 14/236 [00:06<01:38,  2.25it/s]  6%|▋         | 15/236 [00:07<01:38,  2.24it/s]  7%|▋         | 16/236 [00:07<01:38,  2.23it/s]  7%|▋         | 17/236 [00:08<01:38,  2.22it/s]  8%|▊         | 18/236 [00:08<01:38,  2.21it/s]  8%|▊         | 19/236 [00:09<01:38,  2.21it/s]  8%|▊         | 20/236 [00:09<01:37,  2.21it/s]  9%|▉         | 21/236 [00:10<01:37,  2.21it/s]  9%|▉         | 22/236 [00:10<01:37,  2.20it/s] 10%|▉         | 23/236 [00:10<01:36,  2.20it/s] 10%|█         | 24/236 [00:11<01:36,  2.20it/s] 11%|█         | 25/236 [00:11<01:35,  2.20it/s] 11%|█         | 26/236 [00:12<01:35,  2.20it/s] 11%|█▏        | 27/236 [00:12<01:34,  2.20it/s] 12%|█▏        | 28/236 [00:13<01:34,  2.20it/s] 12%|█▏        | 29/236 [00:13<01:33,  2.20it/s] 13%|█▎        | 30/236 [00:14<01:34,  2.18it/s] 13%|█▎        | 31/236 [00:14<01:34,  2.17it/s] 14%|█▎        | 32/236 [00:15<01:33,  2.17it/s] 14%|█▍        | 33/236 [00:15<01:33,  2.18it/s] 14%|█▍        | 34/236 [00:15<01:32,  2.19it/s] 15%|█▍        | 35/236 [00:16<01:31,  2.19it/s] 15%|█▌        | 36/236 [00:16<01:31,  2.20it/s] 16%|█▌        | 37/236 [00:17<01:30,  2.20it/s] 16%|█▌        | 38/236 [00:17<01:30,  2.20it/s] 17%|█▋        | 39/236 [00:18<01:29,  2.20it/s] 17%|█▋        | 40/236 [00:18<01:29,  2.20it/s] 17%|█▋        | 41/236 [00:19<01:28,  2.20it/s] 18%|█▊        | 42/236 [00:19<01:28,  2.20it/s] 18%|█▊        | 43/236 [00:20<01:27,  2.20it/s] 19%|█▊        | 44/236 [00:20<01:27,  2.20it/s] 19%|█▉        | 45/236 [00:20<01:26,  2.20it/s] 19%|█▉        | 46/236 [00:21<01:26,  2.20it/s] 20%|█▉        | 47/236 [00:21<01:26,  2.19it/s] 20%|██        | 48/236 [00:22<01:25,  2.19it/s] 21%|██        | 49/236 [00:22<01:25,  2.20it/s] 21%|██        | 50/236 [00:23<01:24,  2.20it/s] 22%|██▏       | 51/236 [00:23<01:24,  2.20it/s] 22%|██▏       | 52/236 [00:24<01:23,  2.20it/s] 22%|██▏       | 53/236 [00:24<01:23,  2.20it/s] 23%|██▎       | 54/236 [00:25<01:22,  2.20it/s] 23%|██▎       | 55/236 [00:25<01:22,  2.20it/s] 24%|██▎       | 56/236 [00:25<01:21,  2.20it/s] 24%|██▍       | 57/236 [00:26<01:21,  2.20it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.20it/s] 25%|██▌       | 59/236 [00:27<01:20,  2.20it/s] 25%|██▌       | 60/236 [00:27<01:20,  2.18it/s] 26%|██▌       | 61/236 [00:28<01:20,  2.17it/s] 26%|██▋       | 62/236 [00:28<01:19,  2.18it/s] 27%|██▋       | 63/236 [00:29<01:18,  2.19it/s] 27%|██▋       | 64/236 [00:29<01:18,  2.19it/s] 28%|██▊       | 65/236 [00:30<01:17,  2.19it/s] 28%|██▊       | 66/236 [00:30<01:17,  2.20it/s] 28%|██▊       | 67/236 [00:30<01:16,  2.20it/s] 29%|██▉       | 68/236 [00:31<01:16,  2.20it/s] 29%|██▉       | 69/236 [00:31<01:14,  2.25it/s] 30%|██▉       | 70/236 [00:32<01:14,  2.24it/s] 30%|███       | 71/236 [00:32<01:14,  2.22it/s] 31%|███       | 72/236 [00:33<01:13,  2.22it/s] 31%|███       | 73/236 [00:33<01:13,  2.21it/s] 31%|███▏      | 74/236 [00:34<01:13,  2.21it/s] 32%|███▏      | 75/236 [00:34<01:12,  2.21it/s] 32%|███▏      | 76/236 [00:35<01:12,  2.21it/s] 33%|███▎      | 77/236 [00:35<01:12,  2.21it/s] 33%|███▎      | 78/236 [00:35<01:11,  2.21it/s] 33%|███▎      | 79/236 [00:36<01:11,  2.21it/s] 34%|███▍      | 80/236 [00:36<01:10,  2.21it/s] 34%|███▍      | 81/236 [00:37<01:10,  2.20it/s] 35%|███▍      | 82/236 [00:37<01:09,  2.21it/s] 35%|███▌      | 83/236 [00:38<01:09,  2.21it/s] 36%|███▌      | 84/236 [00:38<01:08,  2.21it/s] 36%|███▌      | 85/236 [00:39<01:08,  2.21it/s] 36%|███▋      | 86/236 [00:39<01:07,  2.21it/s] 37%|███▋      | 87/236 [00:39<01:06,  2.26it/s] 37%|███▋      | 88/236 [00:40<01:06,  2.24it/s] 38%|███▊      | 89/236 [00:40<01:05,  2.23it/s] 38%|███▊      | 90/236 [00:41<01:05,  2.22it/s] 39%|███▊      | 91/236 [00:41<01:05,  2.22it/s] 39%|███▉      | 92/236 [00:42<01:04,  2.22it/s] 39%|███▉      | 93/236 [00:42<01:04,  2.21it/s] 40%|███▉      | 94/236 [00:43<01:04,  2.21it/s] 40%|████      | 95/236 [00:43<01:03,  2.21it/s] 41%|████      | 96/236 [00:44<01:03,  2.21it/s] 41%|████      | 97/236 [00:44<01:02,  2.21it/s] 42%|████▏     | 98/236 [00:44<01:02,  2.22it/s] 42%|████▏     | 99/236 [00:45<01:01,  2.23it/s] 42%|████▏     | 100/236 [00:45<01:01,  2.22it/s] 43%|████▎     | 101/236 [00:46<01:00,  2.23it/s] 43%|████▎     | 102/236 [00:46<01:00,  2.22it/s] 44%|████▎     | 103/236 [00:47<00:59,  2.22it/s] 44%|████▍     | 104/236 [00:47<00:59,  2.22it/s] 44%|████▍     | 105/236 [00:48<00:57,  2.28it/s] 45%|████▍     | 106/236 [00:48<00:56,  2.29it/s] 45%|████▌     | 107/236 [00:48<00:56,  2.27it/s] 46%|████▌     | 108/236 [00:49<00:56,  2.25it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.24it/s] 47%|████▋     | 110/236 [00:50<00:56,  2.23it/s] 47%|████▋     | 111/236 [00:50<00:56,  2.23it/s] 47%|████▋     | 112/236 [00:51<00:55,  2.23it/s] 48%|████▊     | 113/236 [00:51<00:55,  2.23it/s] 48%|████▊     | 114/236 [00:52<00:54,  2.23it/s] 49%|████▊     | 115/236 [00:52<00:54,  2.22it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.27it/s] 50%|████▉     | 117/236 [00:53<00:52,  2.25it/s] 50%|█████     | 118/236 [00:53<00:52,  2.24it/s] 50%|█████     | 119/236 [00:54<00:52,  2.24it/s] 51%|█████     | 120/236 [00:54<00:51,  2.23it/s] 51%|█████▏    | 121/236 [00:55<00:51,  2.23it/s] 52%|█████▏    | 122/236 [00:55<00:51,  2.22it/s] 52%|█████▏    | 123/236 [00:56<00:50,  2.22it/s] 53%|█████▎    | 124/236 [00:56<00:50,  2.22it/s] 53%|█████▎    | 125/236 [00:57<00:49,  2.22it/s] 53%|█████▎    | 126/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 127/236 [00:57<00:49,  2.21it/s] 54%|█████▍    | 128/236 [00:58<00:49,  2.20it/s] 55%|█████▍    | 129/236 [00:58<00:48,  2.21it/s] 55%|█████▌    | 130/236 [00:59<00:48,  2.19it/s] 56%|█████▌    | 131/236 [00:59<00:48,  2.19it/s] 56%|█████▌    | 132/236 [01:00<00:47,  2.19it/s] 56%|█████▋    | 133/236 [01:00<00:44,  2.31it/s] 57%|█████▋    | 134/236 [01:01<00:44,  2.28it/s] 57%|█████▋    | 135/236 [01:01<00:44,  2.25it/s] 58%|█████▊    | 136/236 [01:01<00:44,  2.24it/s] 58%|█████▊    | 137/236 [01:02<00:44,  2.22it/s] 58%|█████▊    | 138/236 [01:02<00:44,  2.22it/s] 59%|█████▉    | 139/236 [01:03<00:43,  2.21it/s] 59%|█████▉    | 140/236 [01:03<00:43,  2.21it/s] 60%|█████▉    | 141/236 [01:04<00:42,  2.21it/s] 60%|██████    | 142/236 [01:04<00:42,  2.21it/s] 61%|██████    | 143/236 [01:05<00:42,  2.21it/s] 61%|██████    | 144/236 [01:05<00:41,  2.21it/s] 61%|██████▏   | 145/236 [01:06<00:41,  2.21it/s] 62%|██████▏   | 146/236 [01:06<00:40,  2.21it/s] 62%|██████▏   | 147/236 [01:06<00:40,  2.21it/s] 63%|██████▎   | 148/236 [01:07<00:39,  2.21it/s] 63%|██████▎   | 149/236 [01:07<00:39,  2.21it/s] 64%|██████▎   | 150/236 [01:08<00:38,  2.21it/s] 64%|██████▍   | 151/236 [01:08<00:38,  2.21it/s] 64%|██████▍   | 152/236 [01:09<00:35,  2.36it/s] 65%|██████▍   | 153/236 [01:09<00:35,  2.31it/s] 65%|██████▌   | 154/236 [01:10<00:35,  2.28it/s] 66%|██████▌   | 155/236 [01:10<00:35,  2.26it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.25it/s] 67%|██████▋   | 157/236 [01:11<00:35,  2.24it/s] 67%|██████▋   | 158/236 [01:11<00:35,  2.21it/s] 67%|██████▋   | 159/236 [01:12<00:34,  2.20it/s] 68%|██████▊   | 160/236 [01:12<00:34,  2.19it/s] 68%|██████▊   | 161/236 [01:13<00:34,  2.15it/s] 69%|██████▊   | 162/236 [01:13<00:34,  2.15it/s] 69%|██████▉   | 163/236 [01:14<00:33,  2.16it/s] 69%|██████▉   | 164/236 [01:14<00:33,  2.17it/s] 70%|██████▉   | 165/236 [01:15<00:32,  2.18it/s] 70%|███████   | 166/236 [01:15<00:32,  2.18it/s] 71%|███████   | 167/236 [01:15<00:31,  2.18it/s] 71%|███████   | 168/236 [01:16<00:30,  2.20it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.20it/s] 72%|███████▏  | 170/236 [01:17<00:29,  2.20it/s] 72%|███████▏  | 171/236 [01:17<00:29,  2.21it/s] 73%|███████▎  | 172/236 [01:18<00:29,  2.20it/s] 73%|███████▎  | 173/236 [01:18<00:28,  2.20it/s] 74%|███████▎  | 174/236 [01:19<00:28,  2.20it/s] 74%|███████▍  | 175/236 [01:19<00:27,  2.20it/s] 75%|███████▍  | 176/236 [01:20<00:27,  2.21it/s] 75%|███████▌  | 177/236 [01:20<00:26,  2.22it/s] 75%|███████▌  | 178/236 [01:20<00:26,  2.22it/s] 76%|███████▌  | 179/236 [01:21<00:25,  2.22it/s] 76%|███████▋  | 180/236 [01:21<00:25,  2.23it/s] 77%|███████▋  | 181/236 [01:22<00:24,  2.22it/s] 77%|███████▋  | 182/236 [01:22<00:24,  2.21it/s] 78%|███████▊  | 183/236 [01:23<00:24,  2.20it/s] 78%|███████▊  | 184/236 [01:23<00:23,  2.21it/s] 78%|███████▊  | 185/236 [01:24<00:23,  2.21it/s] 79%|███████▉  | 186/236 [01:24<00:22,  2.22it/s] 79%|███████▉  | 187/236 [01:25<00:22,  2.22it/s] 80%|███████▉  | 188/236 [01:25<00:21,  2.22it/s] 80%|████████  | 189/236 [01:25<00:21,  2.21it/s] 81%|████████  | 190/236 [01:26<00:20,  2.22it/s] 81%|████████  | 191/236 [01:26<00:20,  2.22it/s] 81%|████████▏ | 192/236 [01:27<00:19,  2.22it/s] 82%|████████▏ | 193/236 [01:27<00:19,  2.22it/s] 82%|████████▏ | 194/236 [01:28<00:18,  2.22it/s] 83%|████████▎ | 195/236 [01:28<00:18,  2.22it/s] 83%|████████▎ | 196/236 [01:29<00:18,  2.22it/s] 83%|████████▎ | 197/236 [01:29<00:17,  2.22it/s] 84%|████████▍ | 198/236 [01:29<00:17,  2.23it/s] 84%|████████▍ | 199/236 [01:30<00:16,  2.22it/s] 85%|████████▍ | 200/236 [01:30<00:16,  2.21it/s] 85%|████████▌ | 201/236 [01:31<00:15,  2.26it/s] 86%|████████▌ | 202/236 [01:31<00:15,  2.24it/s] 86%|████████▌ | 203/236 [01:32<00:14,  2.23it/s] 86%|████████▋ | 204/236 [01:32<00:14,  2.21it/s] 87%|████████▋ | 205/236 [01:33<00:14,  2.20it/s] 87%|████████▋ | 206/236 [01:33<00:13,  2.20it/s] 88%|████████▊ | 207/236 [01:34<00:13,  2.20it/s] 88%|████████▊ | 208/236 [01:34<00:12,  2.19it/s] 89%|████████▊ | 209/236 [01:34<00:12,  2.18it/s] 89%|████████▉ | 210/236 [01:35<00:11,  2.35it/s] 89%|████████▉ | 211/236 [01:35<00:10,  2.30it/s] 90%|████████▉ | 212/236 [01:36<00:09,  2.44it/s] 90%|█████████ | 213/236 [01:36<00:09,  2.35it/s] 91%|█████████ | 214/236 [01:37<00:09,  2.30it/s] 91%|█████████ | 215/236 [01:37<00:09,  2.26it/s] 92%|█████████▏| 216/236 [01:37<00:08,  2.24it/s] 92%|█████████▏| 217/236 [01:38<00:08,  2.22it/s] 92%|█████████▏| 218/236 [01:38<00:08,  2.19it/s] 93%|█████████▎| 219/236 [01:39<00:07,  2.18it/s] 93%|█████████▎| 220/236 [01:39<00:07,  2.16it/s] 94%|█████████▎| 221/236 [01:40<00:06,  2.17it/s] 94%|█████████▍| 222/236 [01:40<00:06,  2.17it/s] 94%|█████████▍| 223/236 [01:41<00:05,  2.17it/s] 95%|█████████▍| 224/236 [01:41<00:05,  2.17it/s] 95%|█████████▌| 225/236 [01:42<00:05,  2.17it/s] 96%|█████████▌| 226/236 [01:42<00:04,  2.18it/s] 96%|█████████▌| 227/236 [01:43<00:04,  2.18it/s] 97%|█████████▋| 228/236 [01:43<00:03,  2.18it/s] 97%|█████████▋| 229/236 [01:43<00:03,  2.18it/s] 97%|█████████▋| 230/236 [01:44<00:02,  2.18it/s] 98%|█████████▊| 231/236 [01:44<00:02,  2.18it/s] 98%|█████████▊| 232/236 [01:45<00:01,  2.18it/s] 99%|█████████▊| 233/236 [01:45<00:01,  2.18it/s] 99%|█████████▉| 234/236 [01:46<00:00,  2.18it/s]100%|█████████▉| 235/236 [01:46<00:00,  2.17it/s]100%|██████████| 236/236 [01:47<00:00,  2.20it/s]100%|██████████| 236/236 [01:47<00:00,  2.20it/s]The average generation time of a batch motion (bs=32) is 0.447532 seconds

0it [00:00, ?it/s]29it [00:00, 283.51it/s]70it [00:00, 356.25it/s]113it [00:00, 387.35it/s]153it [00:00, 388.65it/s]196it [00:00, 401.39it/s]239it [00:00, 408.32it/s]282it [00:00, 415.00it/s]324it [00:00, 401.58it/s]365it [00:00, 399.18it/s]405it [00:01, 397.94it/s]448it [00:01, 405.54it/s]490it [00:01, 408.37it/s]531it [00:01, 406.41it/s]575it [00:01, 413.87it/s]618it [00:01, 418.31it/s]661it [00:01, 419.28it/s]704it [00:01, 422.43it/s]747it [00:01, 423.13it/s]790it [00:01, 418.09it/s]833it [00:02, 420.65it/s]876it [00:02, 414.61it/s]919it [00:02, 417.66it/s]961it [00:02, 414.56it/s]1003it [00:02, 414.24it/s]1045it [00:02, 395.72it/s]1085it [00:02, 386.76it/s]1129it [00:02, 399.50it/s]1171it [00:02, 403.74it/s]1212it [00:03, 389.90it/s]1254it [00:03, 396.88it/s]1297it [00:03, 405.61it/s]1339it [00:03, 402.58it/s]1380it [00:03, 404.50it/s]1421it [00:03, 391.00it/s]1461it [00:03, 392.47it/s]1504it [00:03, 401.99it/s]1545it [00:03, 403.54it/s]1586it [00:03, 394.87it/s]1626it [00:04, 374.13it/s]1664it [00:04, 366.91it/s]1701it [00:04, 363.81it/s]1738it [00:04, 359.69it/s]1775it [00:04, 356.15it/s]1811it [00:04, 345.32it/s]1848it [00:04, 350.18it/s]1884it [00:04, 352.53it/s]1921it [00:04, 355.05it/s]1957it [00:05, 335.61it/s]1993it [00:05, 340.64it/s]2028it [00:05, 242.94it/s]2057it [00:05, 242.75it/s]2085it [00:05, 240.54it/s]2111it [00:05, 237.55it/s]2137it [00:05, 237.59it/s]2162it [00:05, 232.13it/s]2199it [00:06, 267.79it/s]2236it [00:06, 293.62it/s]2272it [00:06, 311.72it/s]2307it [00:06, 322.07it/s]2344it [00:06, 333.86it/s]2379it [00:06, 336.60it/s]2416it [00:06, 346.29it/s]2460it [00:06, 371.88it/s]2498it [00:06, 373.00it/s]2536it [00:06, 365.33it/s]2573it [00:07, 365.48it/s]2611it [00:07, 367.32it/s]2648it [00:07, 358.52it/s]2693it [00:07, 382.26it/s]2733it [00:07, 386.35it/s]2777it [00:07, 398.88it/s]2820it [00:07, 406.49it/s]2863it [00:07, 411.92it/s]2908it [00:07, 421.10it/s]2951it [00:07, 419.83it/s]2994it [00:08, 419.86it/s]3037it [00:08, 418.98it/s]3082it [00:08, 427.22it/s]3125it [00:08, 424.35it/s]3168it [00:08, 414.61it/s]3210it [00:08, 410.90it/s]3254it [00:08, 418.15it/s]3297it [00:08, 421.59it/s]3341it [00:08, 425.49it/s]3384it [00:09, 425.99it/s]3427it [00:09, 423.74it/s]3470it [00:09, 404.01it/s]3515it [00:09, 415.55it/s]3559it [00:09, 421.25it/s]3602it [00:09, 419.94it/s]3645it [00:09, 420.00it/s]3688it [00:09, 404.64it/s]3729it [00:10, 217.79it/s]3761it [00:10, 218.37it/s]3790it [00:10, 219.80it/s]3817it [00:10, 223.98it/s]3857it [00:10, 263.16it/s]3900it [00:10, 303.25it/s]3943it [00:10, 335.63it/s]3987it [00:10, 362.49it/s]4029it [00:11, 378.23it/s]4073it [00:11, 393.56it/s]4114it [00:11, 392.62it/s]4157it [00:11, 401.65it/s]4200it [00:11, 409.79it/s]4242it [00:11, 409.10it/s]4284it [00:11, 409.31it/s]4330it [00:11, 423.32it/s]4376it [00:11, 433.46it/s]4422it [00:11, 439.42it/s]4467it [00:12, 434.59it/s]4511it [00:12, 434.08it/s]4557it [00:12, 441.13it/s]4603it [00:12, 444.73it/s]4648it [00:12, 446.26it/s]4648it [00:12, 365.26it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.8045
---> [text2motion] R_precision: (top 1): 0.5409 (top 2): 0.7466 (top 3): 0.8338 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.0786
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.4389
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.7204
!!! DONE !!!
================================================================================

模型: 9_h_049717_iters
评估时间: 2025年 07月 28日 星期一 13:19:33 CST
----------------------------------------
评估成功，用时: 187 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  7%|▋         | 309/4384 [00:00<00:01, 3086.85it/s] 14%|█▍        | 618/4384 [00:00<00:02, 1555.55it/s] 19%|█▊        | 818/4384 [00:00<00:02, 1685.14it/s] 23%|██▎       | 1019/4384 [00:00<00:01, 1778.84it/s] 28%|██▊       | 1218/4384 [00:00<00:01, 1817.50it/s] 32%|███▏      | 1414/4384 [00:00<00:01, 1842.31it/s] 37%|███▋      | 1608/4384 [00:00<00:01, 1870.28it/s] 41%|████      | 1807/4384 [00:00<00:01, 1904.59it/s] 46%|████▌     | 2003/4384 [00:01<00:01, 1915.84it/s] 50%|█████     | 2198/4384 [00:01<00:01, 1917.79it/s] 55%|█████▍    | 2398/4384 [00:01<00:01, 1939.19it/s] 59%|█████▉    | 2595/4384 [00:01<00:00, 1946.75it/s] 64%|██████▎   | 2791/4384 [00:01<00:00, 1949.59it/s] 68%|██████▊   | 2990/4384 [00:01<00:00, 1959.80it/s] 73%|███████▎  | 3192/4384 [00:01<00:00, 1975.53it/s] 77%|███████▋  | 3390/4384 [00:01<00:00, 1972.37it/s] 82%|████████▏ | 3588/4384 [00:01<00:00, 1947.21it/s] 86%|████████▋ | 3786/4384 [00:01<00:00, 1953.93it/s] 91%|█████████ | 3982/4384 [00:02<00:00, 1955.24it/s] 95%|█████████▌| 4178/4384 [00:02<00:00, 1907.92it/s]100%|█████████▉| 4370/4384 [00:02<00:00, 1874.36it/s]100%|██████████| 4384/4384 [00:02<00:00, 1897.71it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  4%|▍         | 193/4384 [00:00<00:02, 1922.86it/s]  9%|▉         | 386/4384 [00:00<00:02, 1882.75it/s] 13%|█▎        | 575/4384 [00:00<00:02, 1872.39it/s] 17%|█▋        | 766/4384 [00:00<00:01, 1885.70it/s] 22%|██▏       | 959/4384 [00:00<00:01, 1901.43it/s] 26%|██▌       | 1150/4384 [00:00<00:01, 1891.90it/s] 31%|███       | 1340/4384 [00:00<00:01, 1866.94it/s] 35%|███▍      | 1527/4384 [00:00<00:01, 1849.75it/s] 39%|███▉      | 1716/4384 [00:00<00:01, 1858.71it/s] 43%|████▎     | 1902/4384 [00:01<00:01, 1839.08it/s] 48%|████▊     | 2086/4384 [00:01<00:01, 1838.89it/s] 52%|█████▏    | 2270/4384 [00:01<00:01, 1835.56it/s] 56%|█████▌    | 2460/4384 [00:01<00:01, 1854.15it/s] 60%|██████    | 2646/4384 [00:01<00:00, 1851.73it/s] 65%|██████▍   | 2832/4384 [00:01<00:00, 1851.45it/s] 69%|██████▉   | 3018/4384 [00:01<00:00, 1834.68it/s] 73%|███████▎  | 3211/4384 [00:01<00:00, 1861.48it/s] 78%|███████▊  | 3398/4384 [00:01<00:00, 1853.55it/s] 82%|████████▏ | 3586/4384 [00:01<00:00, 1861.32it/s] 86%|████████▌ | 3774/4384 [00:02<00:00, 1863.82it/s] 90%|█████████ | 3965/4384 [00:02<00:00, 1876.01it/s] 95%|█████████▍| 4153/4384 [00:02<00:00, 1871.12it/s] 99%|█████████▉| 4341/4384 [00:02<00:00, 1857.47it/s]100%|██████████| 4384/4384 [00:02<00:00, 1860.69it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/9_h_049717_iters.tar with 49717 iterations
Time: 2025-07-28 13:20:04.162133

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]30it [00:00, 241.94it/s]72it [00:00, 332.84it/s]107it [00:00, 319.30it/s]152it [00:00, 364.36it/s]190it [00:00, 277.08it/s]229it [00:00, 305.93it/s]267it [00:00, 325.67it/s]302it [00:00, 313.78it/s]335it [00:01, 280.22it/s]365it [00:01, 261.50it/s]393it [00:01, 243.15it/s]419it [00:01, 231.72it/s]443it [00:01, 227.61it/s]467it [00:01, 226.24it/s]490it [00:01, 224.75it/s]513it [00:01, 220.47it/s]538it [00:02, 228.01it/s]561it [00:02, 225.56it/s]584it [00:02, 224.28it/s]607it [00:02, 220.52it/s]630it [00:02, 220.56it/s]653it [00:02, 220.65it/s]676it [00:02, 221.13it/s]699it [00:02, 217.42it/s]721it [00:02, 218.11it/s]744it [00:02, 221.02it/s]772it [00:03, 237.27it/s]796it [00:03, 231.60it/s]820it [00:03, 213.59it/s]842it [00:03, 206.73it/s]863it [00:03, 207.00it/s]885it [00:03, 209.87it/s]907it [00:03, 212.01it/s]929it [00:03, 212.77it/s]951it [00:03, 212.08it/s]973it [00:04, 212.77it/s]995it [00:04, 211.63it/s]1017it [00:04, 212.92it/s]1039it [00:04, 212.66it/s]1061it [00:04, 211.49it/s]1083it [00:04, 212.29it/s]1105it [00:04, 214.04it/s]1127it [00:04, 215.66it/s]1149it [00:04, 216.51it/s]1171it [00:04, 214.06it/s]1193it [00:05, 214.51it/s]1215it [00:05, 215.36it/s]1237it [00:05, 216.23it/s]1259it [00:05, 210.64it/s]1281it [00:05, 211.99it/s]1303it [00:05, 213.32it/s]1325it [00:05, 214.04it/s]1347it [00:05, 214.15it/s]1369it [00:05, 214.57it/s]1391it [00:06, 213.93it/s]1413it [00:06, 211.05it/s]1436it [00:06, 214.16it/s]1458it [00:06, 215.45it/s]1481it [00:06, 217.62it/s]1503it [00:06, 217.19it/s]1525it [00:06, 217.16it/s]1547it [00:06, 215.87it/s]1569it [00:06, 215.73it/s]1591it [00:06, 214.62it/s]1613it [00:07, 214.79it/s]1635it [00:07, 206.24it/s]1656it [00:07, 206.77it/s]1677it [00:07, 204.33it/s]1699it [00:07, 208.48it/s]1722it [00:07, 212.49it/s]1744it [00:07, 212.80it/s]1767it [00:07, 215.82it/s]1789it [00:07, 216.91it/s]1812it [00:07, 218.05it/s]1834it [00:08, 217.65it/s]1857it [00:08, 219.03it/s]1879it [00:08, 217.34it/s]1902it [00:08, 219.27it/s]1925it [00:08, 221.13it/s]1948it [00:08, 221.31it/s]1971it [00:08, 219.59it/s]1994it [00:08, 220.62it/s]2017it [00:08, 221.68it/s]2040it [00:09, 221.69it/s]2063it [00:09, 222.33it/s]2086it [00:09, 222.40it/s]2109it [00:09, 222.10it/s]2132it [00:09, 218.02it/s]2155it [00:09, 219.96it/s]2178it [00:09, 221.89it/s]2201it [00:09, 222.41it/s]2224it [00:09, 222.82it/s]2247it [00:09, 223.65it/s]2270it [00:10, 221.72it/s]2294it [00:10, 224.92it/s]2323it [00:10, 243.74it/s]2353it [00:10, 259.57it/s]2401it [00:10, 323.93it/s]2450it [00:10, 371.93it/s]2496it [00:10, 396.11it/s]2540it [00:10, 408.87it/s]2584it [00:10, 415.15it/s]2627it [00:10, 419.48it/s]2672it [00:11, 428.28it/s]2716it [00:11, 431.46it/s]2760it [00:11, 430.06it/s]2804it [00:11, 432.35it/s]2848it [00:11, 432.77it/s]2892it [00:11, 433.38it/s]2936it [00:11, 422.64it/s]2980it [00:11, 426.29it/s]3023it [00:11, 424.27it/s]3066it [00:11, 418.18it/s]3109it [00:12, 420.64it/s]3153it [00:12, 426.04it/s]3198it [00:12, 432.97it/s]3243it [00:12, 437.81it/s]3287it [00:12, 354.68it/s]3326it [00:12, 306.47it/s]3360it [00:12, 272.96it/s]3390it [00:13, 187.92it/s]3433it [00:13, 230.86it/s]3478it [00:13, 275.09it/s]3523it [00:13, 312.64it/s]3566it [00:13, 340.85it/s]3611it [00:13, 367.80it/s]3654it [00:13, 384.30it/s]3700it [00:13, 402.98it/s]3744it [00:14, 413.35it/s]3790it [00:14, 423.90it/s]3835it [00:14, 429.99it/s]3879it [00:14, 427.27it/s]3923it [00:14, 427.05it/s]3968it [00:14, 432.33it/s]4014it [00:14, 438.63it/s]4059it [00:14, 431.41it/s]4105it [00:14, 436.59it/s]4150it [00:14, 439.90it/s]4195it [00:15, 439.51it/s]4241it [00:15, 443.18it/s]4287it [00:15, 447.92it/s]4332it [00:15, 441.41it/s]4377it [00:15, 437.56it/s]4421it [00:15, 425.61it/s]4465it [00:15, 429.38it/s]4510it [00:15, 433.25it/s]4556it [00:15, 438.66it/s]4600it [00:15, 437.26it/s]4647it [00:16, 445.50it/s]4648it [00:16, 286.09it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:03,  1.28it/s]  1%|          | 2/236 [00:01<02:18,  1.69it/s]  1%|▏         | 3/236 [00:01<02:03,  1.88it/s]  2%|▏         | 4/236 [00:02<01:57,  1.97it/s]  2%|▏         | 5/236 [00:02<01:53,  2.04it/s]  3%|▎         | 6/236 [00:03<01:50,  2.08it/s]  3%|▎         | 7/236 [00:03<01:48,  2.11it/s]  3%|▎         | 8/236 [00:04<01:46,  2.13it/s]  4%|▍         | 9/236 [00:04<01:46,  2.14it/s]  4%|▍         | 10/236 [00:04<01:45,  2.14it/s]  5%|▍         | 11/236 [00:05<01:44,  2.16it/s]  5%|▌         | 12/236 [00:05<01:44,  2.15it/s]  6%|▌         | 13/236 [00:06<01:43,  2.16it/s]  6%|▌         | 14/236 [00:06<01:39,  2.22it/s]  6%|▋         | 15/236 [00:07<01:40,  2.20it/s]  7%|▋         | 16/236 [00:07<01:40,  2.19it/s]  7%|▋         | 17/236 [00:08<01:39,  2.20it/s]  8%|▊         | 18/236 [00:08<01:39,  2.20it/s]  8%|▊         | 19/236 [00:09<01:38,  2.20it/s]  8%|▊         | 20/236 [00:09<01:38,  2.20it/s]  9%|▉         | 21/236 [00:09<01:37,  2.20it/s]  9%|▉         | 22/236 [00:10<01:37,  2.20it/s] 10%|▉         | 23/236 [00:10<01:36,  2.20it/s] 10%|█         | 24/236 [00:11<01:36,  2.20it/s] 11%|█         | 25/236 [00:11<01:35,  2.20it/s] 11%|█         | 26/236 [00:12<01:35,  2.20it/s] 11%|█▏        | 27/236 [00:12<01:34,  2.20it/s] 12%|█▏        | 28/236 [00:13<01:34,  2.20it/s] 12%|█▏        | 29/236 [00:13<01:34,  2.19it/s] 13%|█▎        | 30/236 [00:14<01:33,  2.20it/s] 13%|█▎        | 31/236 [00:14<01:33,  2.20it/s] 14%|█▎        | 32/236 [00:14<01:32,  2.20it/s] 14%|█▍        | 33/236 [00:15<01:32,  2.20it/s] 14%|█▍        | 34/236 [00:15<01:31,  2.20it/s] 15%|█▍        | 35/236 [00:16<01:31,  2.20it/s] 15%|█▌        | 36/236 [00:16<01:30,  2.21it/s] 16%|█▌        | 37/236 [00:17<01:29,  2.21it/s] 16%|█▌        | 38/236 [00:17<01:29,  2.21it/s] 17%|█▋        | 39/236 [00:18<01:29,  2.21it/s] 17%|█▋        | 40/236 [00:18<01:28,  2.21it/s] 17%|█▋        | 41/236 [00:19<01:28,  2.21it/s] 18%|█▊        | 42/236 [00:19<01:28,  2.19it/s] 18%|█▊        | 43/236 [00:19<01:28,  2.18it/s] 19%|█▊        | 44/236 [00:20<01:27,  2.19it/s] 19%|█▉        | 45/236 [00:20<01:27,  2.19it/s] 19%|█▉        | 46/236 [00:21<01:26,  2.20it/s] 20%|█▉        | 47/236 [00:21<01:26,  2.20it/s] 20%|██        | 48/236 [00:22<01:25,  2.20it/s] 21%|██        | 49/236 [00:22<01:24,  2.22it/s] 21%|██        | 50/236 [00:23<01:23,  2.22it/s] 22%|██▏       | 51/236 [00:23<01:23,  2.22it/s] 22%|██▏       | 52/236 [00:23<01:22,  2.23it/s] 22%|██▏       | 53/236 [00:24<01:21,  2.23it/s] 23%|██▎       | 54/236 [00:24<01:21,  2.23it/s] 23%|██▎       | 55/236 [00:25<01:21,  2.23it/s] 24%|██▎       | 56/236 [00:25<01:20,  2.23it/s] 24%|██▍       | 57/236 [00:26<01:20,  2.23it/s] 25%|██▍       | 58/236 [00:26<01:19,  2.23it/s] 25%|██▌       | 59/236 [00:27<01:19,  2.23it/s] 25%|██▌       | 60/236 [00:27<01:18,  2.23it/s] 26%|██▌       | 61/236 [00:28<01:18,  2.24it/s] 26%|██▋       | 62/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 63/236 [00:28<01:17,  2.24it/s] 27%|██▋       | 64/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 65/236 [00:29<01:16,  2.24it/s] 28%|██▊       | 66/236 [00:30<01:15,  2.24it/s] 28%|██▊       | 67/236 [00:30<01:15,  2.24it/s] 29%|██▉       | 68/236 [00:31<01:15,  2.23it/s] 29%|██▉       | 69/236 [00:31<01:13,  2.28it/s] 30%|██▉       | 70/236 [00:32<01:13,  2.27it/s] 30%|███       | 71/236 [00:32<01:13,  2.26it/s] 31%|███       | 72/236 [00:32<01:12,  2.25it/s] 31%|███       | 73/236 [00:33<01:12,  2.25it/s] 31%|███▏      | 74/236 [00:33<01:12,  2.24it/s] 32%|███▏      | 75/236 [00:34<01:11,  2.24it/s] 32%|███▏      | 76/236 [00:34<01:11,  2.24it/s] 33%|███▎      | 77/236 [00:35<01:11,  2.24it/s] 33%|███▎      | 78/236 [00:35<01:10,  2.24it/s] 33%|███▎      | 79/236 [00:36<01:10,  2.22it/s] 34%|███▍      | 80/236 [00:36<01:10,  2.22it/s] 34%|███▍      | 81/236 [00:36<01:10,  2.21it/s] 35%|███▍      | 82/236 [00:37<01:09,  2.21it/s] 35%|███▌      | 83/236 [00:37<01:08,  2.22it/s] 36%|███▌      | 84/236 [00:38<01:08,  2.23it/s] 36%|███▌      | 85/236 [00:38<01:07,  2.23it/s] 36%|███▋      | 86/236 [00:39<01:07,  2.24it/s] 37%|███▋      | 87/236 [00:39<01:05,  2.29it/s] 37%|███▋      | 88/236 [00:40<01:05,  2.28it/s] 38%|███▊      | 89/236 [00:40<01:04,  2.27it/s] 38%|███▊      | 90/236 [00:40<01:04,  2.26it/s] 39%|███▊      | 91/236 [00:41<01:04,  2.26it/s] 39%|███▉      | 92/236 [00:41<01:03,  2.25it/s] 39%|███▉      | 93/236 [00:42<01:03,  2.25it/s] 40%|███▉      | 94/236 [00:42<01:03,  2.25it/s] 40%|████      | 95/236 [00:43<01:02,  2.24it/s] 41%|████      | 96/236 [00:43<01:02,  2.24it/s] 41%|████      | 97/236 [00:44<01:02,  2.24it/s] 42%|████▏     | 98/236 [00:44<01:01,  2.24it/s] 42%|████▏     | 99/236 [00:44<01:01,  2.24it/s] 42%|████▏     | 100/236 [00:45<01:00,  2.24it/s] 43%|████▎     | 101/236 [00:45<01:00,  2.24it/s] 43%|████▎     | 102/236 [00:46<00:59,  2.24it/s] 44%|████▎     | 103/236 [00:46<00:59,  2.24it/s] 44%|████▍     | 104/236 [00:47<00:58,  2.24it/s] 44%|████▍     | 105/236 [00:47<00:57,  2.29it/s] 45%|████▍     | 106/236 [00:48<00:56,  2.30it/s] 45%|████▌     | 107/236 [00:48<00:56,  2.28it/s] 46%|████▌     | 108/236 [00:48<00:56,  2.27it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.26it/s] 47%|████▋     | 110/236 [00:49<00:55,  2.26it/s] 47%|████▋     | 111/236 [00:50<00:55,  2.25it/s] 47%|████▋     | 112/236 [00:50<00:55,  2.25it/s] 48%|████▊     | 113/236 [00:51<00:54,  2.25it/s] 48%|████▊     | 114/236 [00:51<00:54,  2.24it/s] 49%|████▊     | 115/236 [00:52<00:53,  2.24it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.29it/s] 50%|████▉     | 117/236 [00:52<00:52,  2.27it/s] 50%|█████     | 118/236 [00:53<00:52,  2.26it/s] 50%|█████     | 119/236 [00:53<00:51,  2.25it/s] 51%|█████     | 120/236 [00:54<00:51,  2.25it/s] 51%|█████▏    | 121/236 [00:54<00:51,  2.25it/s] 52%|█████▏    | 122/236 [00:55<00:50,  2.25it/s] 52%|█████▏    | 123/236 [00:55<00:50,  2.25it/s] 53%|█████▎    | 124/236 [00:56<00:49,  2.25it/s] 53%|█████▎    | 125/236 [00:56<00:49,  2.25it/s] 53%|█████▎    | 126/236 [00:56<00:49,  2.24it/s] 54%|█████▍    | 127/236 [00:57<00:48,  2.24it/s] 54%|█████▍    | 128/236 [00:57<00:48,  2.24it/s] 55%|█████▍    | 129/236 [00:58<00:47,  2.24it/s] 55%|█████▌    | 130/236 [00:58<00:47,  2.24it/s] 56%|█████▌    | 131/236 [00:59<00:46,  2.24it/s] 56%|█████▌    | 132/236 [00:59<00:46,  2.24it/s] 56%|█████▋    | 133/236 [00:59<00:43,  2.38it/s] 57%|█████▋    | 134/236 [01:00<00:43,  2.34it/s] 57%|█████▋    | 135/236 [01:00<00:44,  2.29it/s] 58%|█████▊    | 136/236 [01:01<00:44,  2.27it/s] 58%|█████▊    | 137/236 [01:01<00:44,  2.24it/s] 58%|█████▊    | 138/236 [01:02<00:43,  2.24it/s] 59%|█████▉    | 139/236 [01:02<00:43,  2.24it/s] 59%|█████▉    | 140/236 [01:03<00:42,  2.24it/s] 60%|█████▉    | 141/236 [01:03<00:42,  2.24it/s] 60%|██████    | 142/236 [01:04<00:41,  2.24it/s] 61%|██████    | 143/236 [01:04<00:41,  2.24it/s] 61%|██████    | 144/236 [01:04<00:41,  2.24it/s] 61%|██████▏   | 145/236 [01:05<00:40,  2.24it/s] 62%|██████▏   | 146/236 [01:05<00:40,  2.24it/s] 62%|██████▏   | 147/236 [01:06<00:39,  2.23it/s] 63%|██████▎   | 148/236 [01:06<00:39,  2.24it/s] 63%|██████▎   | 149/236 [01:07<00:38,  2.24it/s] 64%|██████▎   | 150/236 [01:07<00:38,  2.24it/s] 64%|██████▍   | 151/236 [01:08<00:37,  2.24it/s] 64%|██████▍   | 152/236 [01:08<00:34,  2.40it/s] 65%|██████▍   | 153/236 [01:08<00:35,  2.34it/s] 65%|██████▌   | 154/236 [01:09<00:35,  2.31it/s] 66%|██████▌   | 155/236 [01:09<00:35,  2.29it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.27it/s] 67%|██████▋   | 157/236 [01:10<00:34,  2.27it/s] 67%|██████▋   | 158/236 [01:11<00:34,  2.25it/s] 67%|██████▋   | 159/236 [01:11<00:34,  2.25it/s] 68%|██████▊   | 160/236 [01:11<00:33,  2.24it/s] 68%|██████▊   | 161/236 [01:12<00:33,  2.24it/s] 69%|██████▊   | 162/236 [01:12<00:33,  2.24it/s] 69%|██████▉   | 163/236 [01:13<00:32,  2.23it/s] 69%|██████▉   | 164/236 [01:13<00:32,  2.23it/s] 70%|██████▉   | 165/236 [01:14<00:31,  2.22it/s] 70%|███████   | 166/236 [01:14<00:31,  2.22it/s] 71%|███████   | 167/236 [01:15<00:30,  2.23it/s] 71%|███████   | 168/236 [01:15<00:30,  2.23it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.23it/s] 72%|███████▏  | 170/236 [01:16<00:29,  2.23it/s] 72%|███████▏  | 171/236 [01:16<00:29,  2.24it/s] 73%|███████▎  | 172/236 [01:17<00:28,  2.24it/s] 73%|███████▎  | 173/236 [01:17<00:28,  2.23it/s] 74%|███████▎  | 174/236 [01:18<00:27,  2.23it/s] 74%|███████▍  | 175/236 [01:18<00:27,  2.23it/s] 75%|███████▍  | 176/236 [01:19<00:26,  2.24it/s] 75%|███████▌  | 177/236 [01:19<00:26,  2.24it/s] 75%|███████▌  | 178/236 [01:20<00:25,  2.23it/s] 76%|███████▌  | 179/236 [01:20<00:25,  2.23it/s] 76%|███████▋  | 180/236 [01:20<00:25,  2.23it/s] 77%|███████▋  | 181/236 [01:21<00:24,  2.23it/s] 77%|███████▋  | 182/236 [01:21<00:24,  2.23it/s] 78%|███████▊  | 183/236 [01:22<00:23,  2.23it/s] 78%|███████▊  | 184/236 [01:22<00:23,  2.23it/s] 78%|███████▊  | 185/236 [01:23<00:22,  2.24it/s] 79%|███████▉  | 186/236 [01:23<00:22,  2.24it/s] 79%|███████▉  | 187/236 [01:24<00:21,  2.24it/s] 80%|███████▉  | 188/236 [01:24<00:21,  2.24it/s] 80%|████████  | 189/236 [01:24<00:21,  2.24it/s] 81%|████████  | 190/236 [01:25<00:20,  2.24it/s] 81%|████████  | 191/236 [01:25<00:20,  2.24it/s] 81%|████████▏ | 192/236 [01:26<00:19,  2.24it/s] 82%|████████▏ | 193/236 [01:26<00:19,  2.24it/s] 82%|████████▏ | 194/236 [01:27<00:18,  2.24it/s] 83%|████████▎ | 195/236 [01:27<00:18,  2.24it/s] 83%|████████▎ | 196/236 [01:28<00:17,  2.24it/s] 83%|████████▎ | 197/236 [01:28<00:17,  2.24it/s] 84%|████████▍ | 198/236 [01:28<00:17,  2.23it/s] 84%|████████▍ | 199/236 [01:29<00:16,  2.23it/s] 85%|████████▍ | 200/236 [01:29<00:16,  2.24it/s] 85%|████████▌ | 201/236 [01:30<00:15,  2.29it/s] 86%|████████▌ | 202/236 [01:30<00:14,  2.28it/s] 86%|████████▌ | 203/236 [01:31<00:14,  2.26it/s] 86%|████████▋ | 204/236 [01:31<00:14,  2.25it/s] 87%|████████▋ | 205/236 [01:32<00:13,  2.25it/s] 87%|████████▋ | 206/236 [01:32<00:13,  2.24it/s] 88%|████████▊ | 207/236 [01:32<00:12,  2.24it/s] 88%|████████▊ | 208/236 [01:33<00:12,  2.24it/s] 89%|████████▊ | 209/236 [01:33<00:12,  2.24it/s] 89%|████████▉ | 210/236 [01:34<00:10,  2.41it/s] 89%|████████▉ | 211/236 [01:34<00:10,  2.36it/s] 90%|████████▉ | 212/236 [01:34<00:09,  2.52it/s] 90%|█████████ | 213/236 [01:35<00:09,  2.43it/s] 91%|█████████ | 214/236 [01:35<00:09,  2.37it/s] 91%|█████████ | 215/236 [01:36<00:09,  2.33it/s] 92%|█████████▏| 216/236 [01:36<00:08,  2.30it/s] 92%|█████████▏| 217/236 [01:37<00:08,  2.28it/s] 92%|█████████▏| 218/236 [01:37<00:07,  2.27it/s] 93%|█████████▎| 219/236 [01:38<00:07,  2.26it/s] 93%|█████████▎| 220/236 [01:38<00:07,  2.25it/s] 94%|█████████▎| 221/236 [01:38<00:06,  2.24it/s] 94%|█████████▍| 222/236 [01:39<00:06,  2.24it/s] 94%|█████████▍| 223/236 [01:39<00:05,  2.24it/s] 95%|█████████▍| 224/236 [01:40<00:05,  2.24it/s] 95%|█████████▌| 225/236 [01:40<00:04,  2.24it/s] 96%|█████████▌| 226/236 [01:41<00:04,  2.24it/s] 96%|█████████▌| 227/236 [01:41<00:04,  2.23it/s] 97%|█████████▋| 228/236 [01:42<00:03,  2.23it/s] 97%|█████████▋| 229/236 [01:42<00:03,  2.23it/s] 97%|█████████▋| 230/236 [01:43<00:02,  2.21it/s] 98%|█████████▊| 231/236 [01:43<00:02,  2.21it/s] 98%|█████████▊| 232/236 [01:43<00:01,  2.22it/s] 99%|█████████▊| 233/236 [01:44<00:01,  2.22it/s] 99%|█████████▉| 234/236 [01:44<00:00,  2.22it/s]100%|█████████▉| 235/236 [01:45<00:00,  2.21it/s]100%|██████████| 236/236 [01:45<00:00,  2.23it/s]100%|██████████| 236/236 [01:45<00:00,  2.23it/s]The average generation time of a batch motion (bs=32) is 0.441954 seconds

0it [00:00, ?it/s]23it [00:00, 228.90it/s]57it [00:00, 292.92it/s]93it [00:00, 322.33it/s]127it [00:00, 328.53it/s]160it [00:00, 317.34it/s]193it [00:00, 318.38it/s]225it [00:00, 318.49it/s]257it [00:00, 312.10it/s]289it [00:00, 309.71it/s]320it [00:01, 296.51it/s]350it [00:01, 282.06it/s]379it [00:01, 257.29it/s]406it [00:01, 241.41it/s]431it [00:01, 240.36it/s]462it [00:01, 257.15it/s]495it [00:01, 274.91it/s]526it [00:01, 282.71it/s]557it [00:01, 289.00it/s]592it [00:02, 304.71it/s]628it [00:02, 318.48it/s]663it [00:02, 325.17it/s]698it [00:02, 330.28it/s]733it [00:02, 333.55it/s]768it [00:02, 336.51it/s]802it [00:02, 330.03it/s]838it [00:02, 337.45it/s]872it [00:02, 331.95it/s]908it [00:02, 338.59it/s]942it [00:03, 338.20it/s]978it [00:03, 341.95it/s]1013it [00:03, 343.59it/s]1049it [00:03, 346.80it/s]1084it [00:03, 342.73it/s]1121it [00:03, 348.75it/s]1156it [00:03, 346.65it/s]1191it [00:03, 330.34it/s]1225it [00:03, 321.57it/s]1258it [00:04, 312.43it/s]1290it [00:04, 292.49it/s]1320it [00:04, 271.36it/s]1348it [00:04, 255.91it/s]1374it [00:04, 255.51it/s]1405it [00:04, 268.87it/s]1437it [00:04, 282.49it/s]1474it [00:04, 304.90it/s]1507it [00:04, 311.40it/s]1544it [00:05, 327.94it/s]1583it [00:05, 343.31it/s]1618it [00:05, 334.45it/s]1657it [00:05, 349.26it/s]1699it [00:05, 369.17it/s]1737it [00:05, 370.53it/s]1776it [00:05, 374.39it/s]1817it [00:05, 381.53it/s]1859it [00:05, 392.81it/s]1899it [00:05, 371.60it/s]1937it [00:06, 364.82it/s]1974it [00:06, 352.30it/s]2010it [00:06, 246.05it/s]2040it [00:06, 256.79it/s]2074it [00:06, 275.83it/s]2109it [00:06, 293.32it/s]2147it [00:06, 313.80it/s]2183it [00:06, 324.98it/s]2220it [00:07, 335.29it/s]2255it [00:07, 329.97it/s]2289it [00:07, 321.55it/s]2322it [00:07, 323.59it/s]2357it [00:07, 329.45it/s]2391it [00:07, 305.74it/s]2423it [00:07, 301.30it/s]2454it [00:07, 273.94it/s]2483it [00:07, 257.97it/s]2510it [00:08, 245.69it/s]2535it [00:08, 244.28it/s]2560it [00:08, 239.59it/s]2585it [00:08, 233.66it/s]2609it [00:08, 224.36it/s]2632it [00:08, 219.92it/s]2659it [00:08, 231.77it/s]2683it [00:08, 228.42it/s]2706it [00:09, 217.86it/s]2728it [00:09, 216.62it/s]2751it [00:09, 218.62it/s]2773it [00:09, 218.36it/s]2795it [00:09, 215.34it/s]2819it [00:09, 221.02it/s]2844it [00:09, 229.34it/s]2867it [00:09, 223.14it/s]2891it [00:09, 225.92it/s]2914it [00:09, 223.39it/s]2937it [00:10, 214.67it/s]2959it [00:10, 205.05it/s]2980it [00:10, 203.00it/s]3001it [00:10, 203.60it/s]3022it [00:10, 194.85it/s]3044it [00:10, 200.90it/s]3066it [00:10, 203.80it/s]3087it [00:10, 200.54it/s]3108it [00:10, 196.11it/s]3128it [00:11, 181.68it/s]3147it [00:11, 182.98it/s]3166it [00:11, 183.08it/s]3185it [00:11, 177.67it/s]3203it [00:11, 177.18it/s]3223it [00:11, 182.24it/s]3243it [00:11, 186.95it/s]3262it [00:11, 186.81it/s]3281it [00:11, 185.53it/s]3302it [00:11, 191.50it/s]3335it [00:12, 230.54it/s]3365it [00:12, 250.92it/s]3395it [00:12, 264.60it/s]3422it [00:12, 256.67it/s]3450it [00:12, 262.66it/s]3478it [00:12, 267.33it/s]3505it [00:12, 266.14it/s]3532it [00:12, 249.23it/s]3558it [00:12, 237.67it/s]3583it [00:13, 225.71it/s]3606it [00:13, 211.39it/s]3628it [00:13, 204.39it/s]3649it [00:13, 185.56it/s]3681it [00:13, 219.73it/s]3708it [00:14, 107.78it/s]3729it [00:14, 122.72it/s]3758it [00:14, 151.31it/s]3789it [00:14, 182.22it/s]3819it [00:14, 207.46it/s]3848it [00:14, 227.03it/s]3877it [00:14, 241.42it/s]3907it [00:14, 256.50it/s]3936it [00:14, 263.73it/s]3965it [00:15, 269.51it/s]3994it [00:15, 272.19it/s]4023it [00:15, 274.66it/s]4052it [00:15, 269.93it/s]4081it [00:15, 275.26it/s]4109it [00:15, 265.80it/s]4136it [00:15, 266.48it/s]4163it [00:15, 259.08it/s]4190it [00:15, 255.55it/s]4217it [00:15, 258.39it/s]4243it [00:16, 256.05it/s]4269it [00:16, 254.30it/s]4295it [00:16, 243.37it/s]4323it [00:16, 252.53it/s]4349it [00:16, 253.93it/s]4375it [00:16, 246.98it/s]4400it [00:16, 239.27it/s]4425it [00:16, 226.48it/s]4448it [00:16, 224.10it/s]4475it [00:17, 236.75it/s]4508it [00:17, 262.84it/s]4541it [00:17, 279.87it/s]4573it [00:17, 289.48it/s]4607it [00:17, 303.58it/s]4643it [00:17, 319.94it/s]4648it [00:17, 259.72it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.7999
---> [text2motion] R_precision: (top 1): 0.5476 (top 2): 0.7470 (top 3): 0.8375 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.0729
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.3327
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.6638
!!! DONE !!!
================================================================================

模型: latest
评估时间: 2025年 07月 28日 星期一 13:22:41 CST
----------------------------------------
评估成功，用时: 181 秒
评估详细结果:
/data/wenshuo/project/StableMoFusion/eval/evaluator_wrapper.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pjoin(opt.evaluator_dir, opt.dataset_name, 'text_mot_match', 'model', 'finest.tar'),
Reading /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/opt.txt
base_dim: 512
batch_size: 64
beta_schedule: linear
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
feat_bias: 5
is_continue: False
latent_dim: 512
log_every: 500
lr: 0.0002
model_ema: True
model_ema_decay: 0.9999
model_ema_steps: 32
name: t2m_condunet1d
no_adagn: False
no_eff: False
num_layers: 8
num_train_steps: 50000
prediction_type: sample
save_interval: 10000
seed: 0
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
weight_decay: 0.01

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  8%|▊         | 348/4384 [00:00<00:01, 3476.47it/s] 16%|█▌        | 696/4384 [00:00<00:02, 1807.27it/s] 21%|██        | 921/4384 [00:00<00:01, 1941.12it/s] 26%|██▋       | 1153/4384 [00:00<00:01, 2053.58it/s] 32%|███▏      | 1383/4384 [00:00<00:01, 2125.78it/s] 37%|███▋      | 1618/4384 [00:00<00:01, 2192.16it/s] 42%|████▏     | 1848/4384 [00:00<00:01, 2216.89it/s] 47%|████▋     | 2078/4384 [00:00<00:01, 2222.60it/s] 53%|█████▎    | 2306/4384 [00:01<00:00, 2234.42it/s] 58%|█████▊    | 2538/4384 [00:01<00:00, 2259.07it/s] 63%|██████▎   | 2771/4384 [00:01<00:00, 2277.47it/s] 69%|██████▊   | 3008/4384 [00:01<00:00, 2303.72it/s] 74%|███████▍  | 3245/4384 [00:01<00:00, 2322.05it/s] 79%|███████▉  | 3481/4384 [00:01<00:00, 2332.57it/s] 85%|████████▍ | 3716/4384 [00:01<00:00, 2336.44it/s] 90%|█████████ | 3954/4384 [00:01<00:00, 2346.67it/s] 96%|█████████▌| 4189/4384 [00:01<00:00, 2341.19it/s]100%|██████████| 4384/4384 [00:01<00:00, 2250.72it/s]
Completing loading t2m dataset

 Loading eval mode HumanML3D dataset ...
/data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/meta/std.npy
  0%|          | 0/4384 [00:00<?, ?it/s]  5%|▌         | 240/4384 [00:00<00:01, 2390.01it/s] 11%|█         | 480/4384 [00:00<00:01, 2350.71it/s] 16%|█▋        | 716/4384 [00:00<00:01, 2268.80it/s] 22%|██▏       | 961/4384 [00:00<00:01, 2337.08it/s] 27%|██▋       | 1196/4384 [00:00<00:01, 2318.50it/s] 33%|███▎      | 1431/4384 [00:00<00:01, 2327.52it/s] 38%|███▊      | 1676/4384 [00:00<00:01, 2366.18it/s] 44%|████▎     | 1915/4384 [00:00<00:01, 2372.55it/s] 49%|████▉     | 2156/4384 [00:00<00:00, 2382.59it/s] 55%|█████▍    | 2400/4384 [00:01<00:00, 2399.67it/s] 60%|██████    | 2647/4384 [00:01<00:00, 2419.19it/s] 66%|██████▌   | 2889/4384 [00:01<00:00, 2399.86it/s] 71%|███████▏  | 3132/4384 [00:01<00:00, 2407.94it/s] 77%|███████▋  | 3373/4384 [00:01<00:00, 2406.48it/s] 82%|████████▏ | 3614/4384 [00:01<00:00, 2387.37it/s] 88%|████████▊ | 3857/4384 [00:01<00:00, 2399.39it/s] 93%|█████████▎| 4097/4384 [00:01<00:00, 2385.60it/s] 99%|█████████▉| 4336/4384 [00:01<00:00, 2370.87it/s]100%|██████████| 4384/4384 [00:01<00:00, 2374.24it/s]Completing loading t2m dataset

Initializing model ...
The T2M Unet mask the text prompt by 0.1 prob. in training
成功加载新训练的checkpoint格式模型
  训练轮数: 19
  最佳R@3: 0.1584051724137931
  模型路径: /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
模型权重加载成功
成功初始化MoCLIP text encoder from /data/wenshuo/project/jhz/StableMoFusion/checkpoints/moclip_training/checkpoint_epoch_20.pt
Loaded 48 retrieval texts
Loaded retrieval motion embeddings: (48, 768)
dims:  [263, 1024, 1024, 1024, 1024] mults:  [2, 2, 2, 2]

Loading EMA model from /data/wenshuo/project/StableMoFusion/checkpoints/t2m/t2m_condunet1d/model/latest.tar with 50061 iterations
Time: 2025-07-28 13:23:07.923644

/data/wenshuo/miniconda3/envs/stablemofusion/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/data/wenshuo/project/StableMoFusion/MoCLIP.py:179: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location=OPT.device)
/data/wenshuo/project/StableMoFusion/utils/model_load.py:12: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(ckpt_path,map_location={'cuda:0': str(device)})
0it [00:00, ?it/s]22it [00:00, 217.62it/s]44it [00:00, 215.78it/s]69it [00:00, 228.37it/s]92it [00:00, 219.33it/s]114it [00:00, 212.49it/s]136it [00:00, 213.82it/s]159it [00:00, 216.47it/s]185it [00:00, 228.19it/s]208it [00:00, 219.04it/s]230it [00:01, 216.50it/s]252it [00:01, 210.88it/s]274it [00:01, 202.26it/s]295it [00:01, 203.57it/s]318it [00:01, 208.73it/s]339it [00:01, 205.05it/s]360it [00:01, 200.88it/s]382it [00:01, 203.17it/s]403it [00:01, 194.10it/s]423it [00:02, 191.78it/s]443it [00:02, 192.45it/s]464it [00:02, 197.02it/s]486it [00:02, 202.08it/s]507it [00:02, 197.64it/s]529it [00:02, 202.85it/s]550it [00:02, 200.26it/s]580it [00:02, 226.61it/s]611it [00:02, 250.36it/s]637it [00:02, 249.41it/s]663it [00:03, 238.98it/s]688it [00:03, 232.04it/s]712it [00:03, 223.08it/s]735it [00:03, 220.97it/s]758it [00:03, 220.67it/s]781it [00:03, 222.93it/s]804it [00:03, 209.29it/s]826it [00:03, 204.62it/s]847it [00:03, 196.60it/s]867it [00:04, 196.48it/s]887it [00:04, 193.92it/s]907it [00:04, 191.21it/s]927it [00:04, 190.55it/s]947it [00:04, 192.14it/s]970it [00:04, 201.93it/s]991it [00:04, 203.95it/s]1012it [00:04, 200.02it/s]1033it [00:04, 199.17it/s]1053it [00:05, 197.76it/s]1075it [00:05, 201.02it/s]1097it [00:05, 204.77it/s]1118it [00:05, 204.41it/s]1139it [00:05, 204.70it/s]1160it [00:05, 204.64it/s]1182it [00:05, 206.58it/s]1203it [00:05, 207.52it/s]1224it [00:05, 205.45it/s]1245it [00:05, 204.84it/s]1266it [00:06, 198.30it/s]1287it [00:06, 200.51it/s]1308it [00:06, 201.37it/s]1329it [00:06, 194.90it/s]1350it [00:06, 197.32it/s]1370it [00:06, 196.62it/s]1392it [00:06, 202.50it/s]1413it [00:06, 200.31it/s]1434it [00:06, 196.52it/s]1454it [00:07, 193.38it/s]1474it [00:07, 193.49it/s]1494it [00:07, 192.56it/s]1514it [00:07, 191.21it/s]1534it [00:07, 185.12it/s]1553it [00:07, 182.31it/s]1573it [00:07, 186.33it/s]1593it [00:07, 189.98it/s]1617it [00:07, 194.33it/s]1659it [00:08, 257.74it/s]1694it [00:08, 282.43it/s]1731it [00:08, 305.62it/s]1763it [00:08, 306.91it/s]1796it [00:08, 312.62it/s]1828it [00:08, 309.17it/s]1860it [00:08, 295.34it/s]1890it [00:08, 291.93it/s]1920it [00:08, 278.14it/s]1949it [00:08, 266.20it/s]1976it [00:09, 240.48it/s]2001it [00:09, 233.34it/s]2025it [00:09, 223.71it/s]2048it [00:09, 219.11it/s]2071it [00:09, 215.15it/s]2094it [00:09, 218.74it/s]2117it [00:09, 221.15it/s]2140it [00:09, 213.32it/s]2164it [00:10, 220.43it/s]2190it [00:10, 229.80it/s]2218it [00:10, 244.19it/s]2250it [00:10, 264.87it/s]2284it [00:10, 284.95it/s]2313it [00:10, 284.87it/s]2343it [00:10, 286.22it/s]2373it [00:10, 288.97it/s]2402it [00:10, 285.96it/s]2432it [00:10, 288.27it/s]2461it [00:11, 282.65it/s]2490it [00:11, 249.02it/s]2516it [00:11, 238.88it/s]2541it [00:11, 223.32it/s]2564it [00:11, 218.66it/s]2587it [00:11, 213.00it/s]2609it [00:11, 210.63it/s]2631it [00:11, 208.14it/s]2653it [00:11, 209.56it/s]2675it [00:12, 206.84it/s]2696it [00:12, 203.33it/s]2720it [00:12, 211.75it/s]2743it [00:12, 213.81it/s]2765it [00:12, 210.60it/s]2787it [00:12, 209.76it/s]2808it [00:12, 209.52it/s]2830it [00:12, 211.77it/s]2852it [00:12, 201.14it/s]2873it [00:13, 203.38it/s]2894it [00:13, 204.51it/s]2917it [00:13, 209.20it/s]2942it [00:13, 220.25it/s]2970it [00:13, 235.48it/s]2996it [00:13, 242.02it/s]3021it [00:13, 243.06it/s]3047it [00:13, 248.01it/s]3072it [00:13, 232.21it/s]3096it [00:13, 226.84it/s]3119it [00:14, 217.81it/s]3141it [00:14, 213.68it/s]3163it [00:14, 206.80it/s]3184it [00:14, 200.11it/s]3205it [00:14, 197.39it/s]3229it [00:14, 208.91it/s]3258it [00:14, 231.84it/s]3296it [00:14, 273.93it/s]3330it [00:14, 289.87it/s]3364it [00:15, 179.39it/s]3402it [00:15, 218.10it/s]3441it [00:15, 254.51it/s]3477it [00:15, 278.00it/s]3510it [00:15, 288.83it/s]3543it [00:15, 293.94it/s]3575it [00:15, 300.29it/s]3607it [00:16, 281.14it/s]3637it [00:16, 248.84it/s]3664it [00:16, 251.96it/s]3701it [00:16, 281.13it/s]3738it [00:16, 305.03it/s]3776it [00:16, 323.46it/s]3810it [00:16, 312.27it/s]3842it [00:16, 300.68it/s]3873it [00:16, 268.88it/s]3901it [00:17, 255.75it/s]3928it [00:17, 253.09it/s]3954it [00:17, 251.71it/s]3980it [00:17, 242.93it/s]4007it [00:17, 247.81it/s]4032it [00:17, 235.70it/s]4056it [00:17, 232.18it/s]4082it [00:17, 238.43it/s]4107it [00:17, 239.50it/s]4132it [00:18, 230.93it/s]4156it [00:18, 227.12it/s]4179it [00:18, 222.26it/s]4202it [00:18, 215.73it/s]4224it [00:18, 211.67it/s]4246it [00:18, 209.01it/s]4267it [00:18, 204.82it/s]4288it [00:18, 199.70it/s]4308it [00:18, 195.57it/s]4328it [00:19, 192.63it/s]4348it [00:19, 188.13it/s]4367it [00:19, 185.53it/s]4386it [00:19, 184.56it/s]4405it [00:19, 184.63it/s]4425it [00:19, 189.03it/s]4444it [00:19, 186.00it/s]4464it [00:19, 189.73it/s]4483it [00:19, 184.81it/s]4504it [00:20, 179.31it/s]4523it [00:20, 181.43it/s]4542it [00:20, 175.53it/s]4561it [00:20, 178.94it/s]4581it [00:20, 183.49it/s]4602it [00:20, 188.53it/s]4623it [00:20, 194.19it/s]4644it [00:20, 197.29it/s]4648it [00:21, 221.26it/s]

Using dpmsolver diffusion scheduler to classifier-free-guidance generate 7548 motions, sampling 10 steps.
  0%|          | 0/236 [00:00<?, ?it/s]  0%|          | 1/236 [00:00<03:11,  1.22it/s]  1%|          | 2/236 [00:01<02:21,  1.66it/s]  1%|▏         | 3/236 [00:01<02:06,  1.85it/s]  2%|▏         | 4/236 [00:02<01:58,  1.96it/s]  2%|▏         | 5/236 [00:02<01:53,  2.03it/s]  3%|▎         | 6/236 [00:03<01:50,  2.08it/s]  3%|▎         | 7/236 [00:03<01:48,  2.11it/s]  3%|▎         | 8/236 [00:04<01:46,  2.13it/s]  4%|▍         | 9/236 [00:04<01:45,  2.15it/s]  4%|▍         | 10/236 [00:04<01:44,  2.16it/s]  5%|▍         | 11/236 [00:05<01:43,  2.17it/s]  5%|▌         | 12/236 [00:05<01:43,  2.17it/s]  6%|▌         | 13/236 [00:06<01:41,  2.20it/s]  6%|▌         | 14/236 [00:06<01:38,  2.25it/s]  6%|▋         | 15/236 [00:07<01:38,  2.24it/s]  7%|▋         | 16/236 [00:07<01:38,  2.23it/s]  7%|▋         | 17/236 [00:08<01:38,  2.22it/s]  8%|▊         | 18/236 [00:08<01:38,  2.21it/s]  8%|▊         | 19/236 [00:08<01:38,  2.21it/s]  8%|▊         | 20/236 [00:09<01:37,  2.22it/s]  9%|▉         | 21/236 [00:09<01:36,  2.22it/s]  9%|▉         | 22/236 [00:10<01:37,  2.19it/s] 10%|▉         | 23/236 [00:10<01:37,  2.18it/s] 10%|█         | 24/236 [00:11<01:37,  2.16it/s] 11%|█         | 25/236 [00:11<01:37,  2.17it/s] 11%|█         | 26/236 [00:12<01:36,  2.17it/s] 11%|█▏        | 27/236 [00:12<01:36,  2.18it/s] 12%|█▏        | 28/236 [00:13<01:35,  2.17it/s] 12%|█▏        | 29/236 [00:13<01:36,  2.15it/s] 13%|█▎        | 30/236 [00:14<01:35,  2.16it/s] 13%|█▎        | 31/236 [00:14<01:34,  2.16it/s] 14%|█▎        | 32/236 [00:14<01:34,  2.17it/s] 14%|█▍        | 33/236 [00:15<01:33,  2.18it/s] 14%|█▍        | 34/236 [00:15<01:32,  2.18it/s] 15%|█▍        | 35/236 [00:16<01:31,  2.19it/s] 15%|█▌        | 36/236 [00:16<01:31,  2.19it/s] 16%|█▌        | 37/236 [00:17<01:30,  2.19it/s] 16%|█▌        | 38/236 [00:17<01:30,  2.18it/s] 17%|█▋        | 39/236 [00:18<01:30,  2.18it/s] 17%|█▋        | 40/236 [00:18<01:29,  2.19it/s] 17%|█▋        | 41/236 [00:19<01:28,  2.20it/s] 18%|█▊        | 42/236 [00:19<01:27,  2.21it/s] 18%|█▊        | 43/236 [00:19<01:27,  2.21it/s] 19%|█▊        | 44/236 [00:20<01:26,  2.21it/s] 19%|█▉        | 45/236 [00:20<01:26,  2.22it/s] 19%|█▉        | 46/236 [00:21<01:26,  2.19it/s] 20%|█▉        | 47/236 [00:21<01:26,  2.19it/s] 20%|██        | 48/236 [00:22<01:25,  2.20it/s] 21%|██        | 49/236 [00:22<01:24,  2.20it/s] 21%|██        | 50/236 [00:23<01:24,  2.20it/s] 22%|██▏       | 51/236 [00:23<01:23,  2.21it/s] 22%|██▏       | 52/236 [00:24<01:23,  2.21it/s] 22%|██▏       | 53/236 [00:24<01:22,  2.22it/s] 23%|██▎       | 54/236 [00:24<01:21,  2.22it/s] 23%|██▎       | 55/236 [00:25<01:21,  2.22it/s] 24%|██▎       | 56/236 [00:25<01:21,  2.22it/s] 24%|██▍       | 57/236 [00:26<01:20,  2.22it/s] 25%|██▍       | 58/236 [00:26<01:20,  2.22it/s] 25%|██▌       | 59/236 [00:27<01:19,  2.22it/s] 25%|██▌       | 60/236 [00:27<01:18,  2.23it/s] 26%|██▌       | 61/236 [00:28<01:18,  2.23it/s] 26%|██▋       | 62/236 [00:28<01:18,  2.23it/s] 27%|██▋       | 63/236 [00:29<01:18,  2.21it/s] 27%|██▋       | 64/236 [00:29<01:17,  2.21it/s] 28%|██▊       | 65/236 [00:29<01:17,  2.22it/s] 28%|██▊       | 66/236 [00:30<01:16,  2.22it/s] 28%|██▊       | 67/236 [00:30<01:15,  2.22it/s] 29%|██▉       | 68/236 [00:31<01:15,  2.21it/s] 29%|██▉       | 69/236 [00:31<01:13,  2.27it/s] 30%|██▉       | 70/236 [00:32<01:13,  2.26it/s] 30%|███       | 71/236 [00:32<01:13,  2.24it/s] 31%|███       | 72/236 [00:33<01:13,  2.24it/s] 31%|███       | 73/236 [00:33<01:12,  2.23it/s] 31%|███▏      | 74/236 [00:33<01:12,  2.23it/s] 32%|███▏      | 75/236 [00:34<01:12,  2.23it/s] 32%|███▏      | 76/236 [00:34<01:11,  2.23it/s] 33%|███▎      | 77/236 [00:35<01:11,  2.23it/s] 33%|███▎      | 78/236 [00:35<01:10,  2.23it/s] 33%|███▎      | 79/236 [00:36<01:10,  2.23it/s] 34%|███▍      | 80/236 [00:36<01:09,  2.24it/s] 34%|███▍      | 81/236 [00:37<01:09,  2.23it/s] 35%|███▍      | 82/236 [00:37<01:09,  2.23it/s] 35%|███▌      | 83/236 [00:37<01:08,  2.24it/s] 36%|███▌      | 84/236 [00:38<01:08,  2.23it/s] 36%|███▌      | 85/236 [00:38<01:07,  2.23it/s] 36%|███▋      | 86/236 [00:39<01:07,  2.23it/s] 37%|███▋      | 87/236 [00:39<01:05,  2.28it/s] 37%|███▋      | 88/236 [00:40<01:05,  2.26it/s] 38%|███▊      | 89/236 [00:40<01:05,  2.25it/s] 38%|███▊      | 90/236 [00:41<01:04,  2.25it/s] 39%|███▊      | 91/236 [00:41<01:04,  2.25it/s] 39%|███▉      | 92/236 [00:41<01:03,  2.25it/s] 39%|███▉      | 93/236 [00:42<01:03,  2.25it/s] 40%|███▉      | 94/236 [00:42<01:03,  2.23it/s] 40%|████      | 95/236 [00:43<01:03,  2.23it/s] 41%|████      | 96/236 [00:43<01:03,  2.22it/s] 41%|████      | 97/236 [00:44<01:02,  2.23it/s] 42%|████▏     | 98/236 [00:44<01:01,  2.24it/s] 42%|████▏     | 99/236 [00:45<01:01,  2.24it/s] 42%|████▏     | 100/236 [00:45<01:00,  2.24it/s] 43%|████▎     | 101/236 [00:45<01:00,  2.24it/s] 43%|████▎     | 102/236 [00:46<00:59,  2.25it/s] 44%|████▎     | 103/236 [00:46<00:59,  2.25it/s] 44%|████▍     | 104/236 [00:47<00:58,  2.25it/s] 44%|████▍     | 105/236 [00:47<00:56,  2.30it/s] 45%|████▍     | 106/236 [00:48<00:56,  2.31it/s] 45%|████▌     | 107/236 [00:48<00:56,  2.29it/s] 46%|████▌     | 108/236 [00:49<00:56,  2.27it/s] 46%|████▌     | 109/236 [00:49<00:56,  2.26it/s] 47%|████▋     | 110/236 [00:49<00:55,  2.26it/s] 47%|████▋     | 111/236 [00:50<00:55,  2.25it/s] 47%|████▋     | 112/236 [00:50<00:55,  2.25it/s] 48%|████▊     | 113/236 [00:51<00:54,  2.25it/s] 48%|████▊     | 114/236 [00:51<00:54,  2.25it/s] 49%|████▊     | 115/236 [00:52<00:53,  2.24it/s] 49%|████▉     | 116/236 [00:52<00:52,  2.29it/s] 50%|████▉     | 117/236 [00:53<00:52,  2.27it/s] 50%|█████     | 118/236 [00:53<00:52,  2.26it/s] 50%|█████     | 119/236 [00:53<00:52,  2.25it/s] 51%|█████     | 120/236 [00:54<00:51,  2.24it/s] 51%|█████▏    | 121/236 [00:54<00:51,  2.24it/s] 52%|█████▏    | 122/236 [00:55<00:50,  2.24it/s] 52%|█████▏    | 123/236 [00:55<00:50,  2.24it/s] 53%|█████▎    | 124/236 [00:56<00:49,  2.24it/s] 53%|█████▎    | 125/236 [00:56<00:49,  2.24it/s] 53%|█████▎    | 126/236 [00:57<00:49,  2.24it/s] 54%|█████▍    | 127/236 [00:57<00:48,  2.24it/s] 54%|█████▍    | 128/236 [00:57<00:48,  2.24it/s] 55%|█████▍    | 129/236 [00:58<00:47,  2.24it/s] 55%|█████▌    | 130/236 [00:58<00:47,  2.24it/s] 56%|█████▌    | 131/236 [00:59<00:46,  2.24it/s] 56%|█████▌    | 132/236 [00:59<00:46,  2.24it/s] 56%|█████▋    | 133/236 [01:00<00:43,  2.39it/s] 57%|█████▋    | 134/236 [01:00<00:43,  2.34it/s] 57%|█████▋    | 135/236 [01:00<00:43,  2.31it/s] 58%|█████▊    | 136/236 [01:01<00:43,  2.29it/s] 58%|█████▊    | 137/236 [01:01<00:43,  2.27it/s] 58%|█████▊    | 138/236 [01:02<00:43,  2.26it/s] 59%|█████▉    | 139/236 [01:02<00:42,  2.26it/s] 59%|█████▉    | 140/236 [01:03<00:42,  2.25it/s] 60%|█████▉    | 141/236 [01:03<00:42,  2.25it/s] 60%|██████    | 142/236 [01:04<00:41,  2.25it/s] 61%|██████    | 143/236 [01:04<00:41,  2.24it/s] 61%|██████    | 144/236 [01:05<00:41,  2.24it/s] 61%|██████▏   | 145/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 146/236 [01:05<00:40,  2.23it/s] 62%|██████▏   | 147/236 [01:06<00:39,  2.23it/s] 63%|██████▎   | 148/236 [01:06<00:39,  2.23it/s] 63%|██████▎   | 149/236 [01:07<00:39,  2.21it/s] 64%|██████▎   | 150/236 [01:07<00:38,  2.21it/s] 64%|██████▍   | 151/236 [01:08<00:38,  2.22it/s] 64%|██████▍   | 152/236 [01:08<00:35,  2.35it/s] 65%|██████▍   | 153/236 [01:08<00:35,  2.31it/s] 65%|██████▌   | 154/236 [01:09<00:35,  2.28it/s] 66%|██████▌   | 155/236 [01:09<00:35,  2.26it/s] 66%|██████▌   | 156/236 [01:10<00:35,  2.25it/s] 67%|██████▋   | 157/236 [01:10<00:35,  2.24it/s] 67%|██████▋   | 158/236 [01:11<00:34,  2.23it/s] 67%|██████▋   | 159/236 [01:11<00:34,  2.23it/s] 68%|██████▊   | 160/236 [01:12<00:34,  2.23it/s] 68%|██████▊   | 161/236 [01:12<00:33,  2.22it/s] 69%|██████▊   | 162/236 [01:13<00:33,  2.22it/s] 69%|██████▉   | 163/236 [01:13<00:32,  2.22it/s] 69%|██████▉   | 164/236 [01:13<00:32,  2.22it/s] 70%|██████▉   | 165/236 [01:14<00:32,  2.22it/s] 70%|███████   | 166/236 [01:14<00:31,  2.21it/s] 71%|███████   | 167/236 [01:15<00:31,  2.22it/s] 71%|███████   | 168/236 [01:15<00:30,  2.22it/s] 72%|███████▏  | 169/236 [01:16<00:30,  2.22it/s] 72%|███████▏  | 170/236 [01:16<00:29,  2.22it/s] 72%|███████▏  | 171/236 [01:17<00:29,  2.22it/s] 73%|███████▎  | 172/236 [01:17<00:28,  2.22it/s] 73%|███████▎  | 173/236 [01:18<00:28,  2.22it/s] 74%|███████▎  | 174/236 [01:18<00:27,  2.22it/s] 74%|███████▍  | 175/236 [01:18<00:27,  2.22it/s] 75%|███████▍  | 176/236 [01:19<00:26,  2.22it/s] 75%|███████▌  | 177/236 [01:19<00:26,  2.22it/s] 75%|███████▌  | 178/236 [01:20<00:26,  2.22it/s] 76%|███████▌  | 179/236 [01:20<00:25,  2.22it/s] 76%|███████▋  | 180/236 [01:21<00:25,  2.22it/s] 77%|███████▋  | 181/236 [01:21<00:24,  2.22it/s] 77%|███████▋  | 182/236 [01:22<00:24,  2.22it/s] 78%|███████▊  | 183/236 [01:22<00:23,  2.22it/s] 78%|███████▊  | 184/236 [01:22<00:23,  2.22it/s] 78%|███████▊  | 185/236 [01:23<00:22,  2.22it/s] 79%|███████▉  | 186/236 [01:23<00:22,  2.22it/s] 79%|███████▉  | 187/236 [01:24<00:22,  2.22it/s] 80%|███████▉  | 188/236 [01:24<00:21,  2.23it/s] 80%|████████  | 189/236 [01:25<00:21,  2.22it/s] 81%|████████  | 190/236 [01:25<00:20,  2.23it/s] 81%|████████  | 191/236 [01:26<00:20,  2.23it/s] 81%|████████▏ | 192/236 [01:26<00:19,  2.23it/s] 82%|████████▏ | 193/236 [01:27<00:19,  2.23it/s] 82%|████████▏ | 194/236 [01:27<00:18,  2.23it/s] 83%|████████▎ | 195/236 [01:27<00:18,  2.23it/s] 83%|████████▎ | 196/236 [01:28<00:17,  2.23it/s] 83%|████████▎ | 197/236 [01:28<00:17,  2.23it/s] 84%|████████▍ | 198/236 [01:29<00:17,  2.22it/s] 84%|████████▍ | 199/236 [01:29<00:16,  2.22it/s] 85%|████████▍ | 200/236 [01:30<00:16,  2.22it/s] 85%|████████▌ | 201/236 [01:30<00:15,  2.28it/s] 86%|████████▌ | 202/236 [01:31<00:15,  2.27it/s] 86%|████████▌ | 203/236 [01:31<00:14,  2.25it/s] 86%|████████▋ | 204/236 [01:31<00:14,  2.24it/s] 87%|████████▋ | 205/236 [01:32<00:13,  2.23it/s] 87%|████████▋ | 206/236 [01:32<00:13,  2.23it/s] 88%|████████▊ | 207/236 [01:33<00:13,  2.22it/s] 88%|████████▊ | 208/236 [01:33<00:12,  2.22it/s] 89%|████████▊ | 209/236 [01:34<00:12,  2.22it/s] 89%|████████▉ | 210/236 [01:34<00:10,  2.40it/s] 89%|████████▉ | 211/236 [01:34<00:10,  2.35it/s] 90%|████████▉ | 212/236 [01:35<00:09,  2.51it/s] 90%|█████████ | 213/236 [01:35<00:09,  2.42it/s] 91%|█████████ | 214/236 [01:36<00:09,  2.36it/s] 91%|█████████ | 215/236 [01:36<00:09,  2.32it/s] 92%|█████████▏| 216/236 [01:37<00:08,  2.29it/s] 92%|█████████▏| 217/236 [01:37<00:08,  2.28it/s] 92%|█████████▏| 218/236 [01:37<00:07,  2.26it/s] 93%|█████████▎| 219/236 [01:38<00:07,  2.26it/s] 93%|█████████▎| 220/236 [01:38<00:07,  2.25it/s] 94%|█████████▎| 221/236 [01:39<00:06,  2.24it/s] 94%|█████████▍| 222/236 [01:39<00:06,  2.24it/s] 94%|█████████▍| 223/236 [01:40<00:05,  2.24it/s] 95%|█████████▍| 224/236 [01:40<00:05,  2.24it/s] 95%|█████████▌| 225/236 [01:41<00:04,  2.24it/s] 96%|█████████▌| 226/236 [01:41<00:04,  2.24it/s] 96%|█████████▌| 227/236 [01:41<00:04,  2.24it/s] 97%|█████████▋| 228/236 [01:42<00:03,  2.24it/s] 97%|█████████▋| 229/236 [01:42<00:03,  2.24it/s] 97%|█████████▋| 230/236 [01:43<00:02,  2.24it/s] 98%|█████████▊| 231/236 [01:43<00:02,  2.24it/s] 98%|█████████▊| 232/236 [01:44<00:01,  2.24it/s] 99%|█████████▊| 233/236 [01:44<00:01,  2.24it/s] 99%|█████████▉| 234/236 [01:45<00:00,  2.23it/s]100%|█████████▉| 235/236 [01:45<00:00,  2.23it/s]100%|██████████| 236/236 [01:46<00:00,  2.25it/s]100%|██████████| 236/236 [01:46<00:00,  2.23it/s]The average generation time of a batch motion (bs=32) is 0.442943 seconds

0it [00:00, ?it/s]26it [00:00, 257.94it/s]67it [00:00, 343.83it/s]110it [00:00, 380.77it/s]149it [00:00, 381.82it/s]188it [00:00, 368.90it/s]229it [00:00, 381.24it/s]271it [00:00, 392.52it/s]311it [00:00, 390.75it/s]353it [00:00, 397.18it/s]395it [00:01, 403.11it/s]437it [00:01, 406.81it/s]481it [00:01, 413.91it/s]523it [00:01, 396.99it/s]565it [00:01, 400.84it/s]609it [00:01, 409.46it/s]652it [00:01, 415.44it/s]697it [00:01, 424.53it/s]740it [00:01, 423.59it/s]783it [00:01, 392.95it/s]825it [00:02, 397.89it/s]866it [00:02, 393.08it/s]911it [00:02, 409.29it/s]955it [00:02, 416.95it/s]1002it [00:02, 428.31it/s]1048it [00:02, 435.43it/s]1092it [00:02, 436.26it/s]1137it [00:02, 437.58it/s]1181it [00:02, 425.89it/s]1228it [00:03, 437.32it/s]1274it [00:03, 441.56it/s]1319it [00:03, 443.31it/s]1364it [00:03, 443.13it/s]1409it [00:03, 444.62it/s]1454it [00:03, 436.50it/s]1498it [00:03, 432.11it/s]1542it [00:03, 419.68it/s]1585it [00:03, 419.06it/s]1627it [00:03, 406.37it/s]1674it [00:04, 422.51it/s]1720it [00:04, 433.26it/s]1764it [00:04, 430.43it/s]1808it [00:04, 427.34it/s]1851it [00:04, 427.30it/s]1897it [00:04, 436.27it/s]1941it [00:04, 437.09it/s]1985it [00:04, 435.44it/s]2029it [00:04, 350.48it/s]2072it [00:05, 370.52it/s]2114it [00:05, 383.56it/s]2158it [00:05, 398.50it/s]2202it [00:05, 409.62it/s]2246it [00:05, 417.64it/s]2290it [00:05, 424.06it/s]2333it [00:05, 424.29it/s]2376it [00:05, 419.22it/s]2419it [00:05, 411.45it/s]2464it [00:05, 421.01it/s]2508it [00:06, 424.71it/s]2553it [00:06, 432.01it/s]2597it [00:06, 414.47it/s]2639it [00:06, 402.96it/s]2682it [00:06, 409.20it/s]2724it [00:06, 395.23it/s]2768it [00:06, 405.66it/s]2810it [00:06, 409.53it/s]2852it [00:06, 412.16it/s]2896it [00:07, 417.67it/s]2938it [00:07, 412.48it/s]2981it [00:07, 415.12it/s]3024it [00:07, 419.08it/s]3070it [00:07, 428.84it/s]3115it [00:07, 432.51it/s]3159it [00:07, 428.81it/s]3204it [00:07, 433.96it/s]3252it [00:07, 446.35it/s]3299it [00:07, 451.77it/s]3345it [00:08, 453.61it/s]3393it [00:08, 461.13it/s]3440it [00:08, 458.37it/s]3487it [00:08, 461.37it/s]3534it [00:08, 457.80it/s]3580it [00:08, 452.65it/s]3626it [00:08, 452.28it/s]3672it [00:08, 446.08it/s]3717it [00:09, 274.69it/s]3760it [00:09, 305.84it/s]3806it [00:09, 339.01it/s]3851it [00:09, 365.17it/s]3895it [00:09, 382.62it/s]3938it [00:09, 391.51it/s]3981it [00:09, 399.72it/s]4024it [00:09, 406.68it/s]4067it [00:09, 411.69it/s]4110it [00:09, 412.01it/s]4152it [00:10, 413.54it/s]4195it [00:10, 416.04it/s]4237it [00:10, 398.25it/s]4279it [00:10, 402.33it/s]4323it [00:10, 411.64it/s]4369it [00:10, 423.17it/s]4415it [00:10, 431.82it/s]4459it [00:10, 433.68it/s]4504it [00:10, 436.84it/s]4548it [00:11, 424.33it/s]4594it [00:11, 434.28it/s]4640it [00:11, 441.79it/s]4648it [00:11, 404.67it/s]========== Evaluating Matching Score ==========

---> [ground truth] Matching Score: 2.9566
---> [ground truth] R_precision: (top 1): 0.5162 (top 2): 0.7032 (top 3): 0.8002 
---> [text2motion] Matching Score: 2.7958
---> [text2motion] R_precision: (top 1): 0.5450 (top 2): 0.7491 (top 3): 0.8349 
========== Evaluating FID ==========
---> [ground truth] FID: 0.0017
---> [text2motion] FID: 0.0735
========== Evaluating Diversity ==========
---> [ground truth] Diversity: 9.1970
---> [text2motion] Diversity: 9.3364
========== Evaluating MultiModality ==========
---> [text2motion] Multimodality: 1.6702
!!! DONE !!!
================================================================================

================================================================================
所有模型评估完成
完成时间: 2025年 07月 28日 星期一 13:25:43 CST
================================================================================
